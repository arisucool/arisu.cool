"use strict";(self.webpackChunkarisucool=self.webpackChunkarisucool||[]).push([[221],{4221:(N,f,u)=>{u.r(f),u.d(f,{GoodsListModule:()=>k});var m=u(6895),l=u(8996),d=u(5861),t=u(4650),h=u(6707),M=u(2340),O=u(1761);let P=(()=>{class n{constructor(e){this.appCacheService=e,this.GOODS_LIST_STORAGE_VERSION=1}init(){var e=this;return(0,d.Z)(function*(){e.storage||(e.storage=yield(0,h.H)({name:"arisucoolGoodsListItemStatus",version:e.GOODS_LIST_STORAGE_VERSION}))})()}getGoodsList(){var e=this;return(0,d.Z)(function*(){yield e.init();const o=yield e.appCacheService.getCachedJson("arisuGoodsList",n.GOODS_LIST_JSON_CACHE_EXPIRES);if(o)return yield e.injectStatuses(o);const i=yield fetch(M.N.SHOPPING_LIST_JSON_API_URL);if(!i.ok)throw new Error("Failed to fetch goods list");const r=yield i.json();let c=[];for(const s of r){const p=n.getValueByMatchedKey(s,"id");!p||isNaN(p)||c.push({id:parseInt(p,10),category:n.getValueByMatchedKey(s,"\u30ab\u30c6\u30b4\u30ea"),maker:n.getValueByMatchedKey(s,"\u30e1\u30fc\u30ab\u30fc"),reservationStartDate:n.getValueByMatchedKey(s,"\u4e88\u7d04\u958b\u59cb\u65e5"),name:n.getValueByMatchedKey(s,"\u5546\u54c1\u540d"),isArisuAlone:n.getValueByMatchedKey(s,"\u3042\u308a\u3059\u5358\u72ec\u304b"),releaseDate:n.getValueByMatchedKey(s,"\u767a\u58f2\u65e5"),priceWithTax:n.getValueByMatchedKey(s,"\u7a0e\u8fbc\u4fa1\u683c"),place:n.getValueByMatchedKey(s,"\u5834\u6240"),url:n.getValueByMatchedKey(s,"URL"),note:n.getValueByMatchedKey(s,"\u88dc\u8db3\u60c5\u5831"),isDone:!1})}return e.appCacheService.setCachedJson("arisuGoodsList",c),c=yield e.injectStatuses(c),c})()}setItemStatus(e,o){var i=this;return(0,d.Z)(function*(){if(yield i.init(),!i.storage)throw new Error("Failed to init storage");i.storage.set(e.toString(),{note:void 0,isDone:o})})()}injectStatuses(e){var o=this;return(0,d.Z)(function*(){for(const i of e){const r=yield o.storage?.get(i.id.toString());i.isDone=!!r&&r.isDone}return e.sort((i,r)=>void 0===i.reservationStartDate?1:void 0===r.reservationStartDate?-1:i.reservationStartDate.localeCompare(r.reservationStartDate)),e})()}static getValueByMatchedKey(e,o){const i=o.toLowerCase(),r=Object.keys(e);for(const c of r)if(0===c.toLowerCase().indexOf(i)){let s=e[c];return void 0===s||""===s.trim()||"-"===s?void 0:e[c]}}}return n.GOODS_LIST_JSON_CACHE_EXPIRES=18e5,n.\u0275fac=function(e){return new(e||n)(t.LFG(O.g))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var y=u(7009),C=u(3336),g=u(6338),v=u(6709),B=u(266),_=u(4006);function A(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"a",7)(2,"mat-icon"),t._uU(3,"link"),t.qZA()(),t._uU(4," \xa0 / "),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("href",e.item.url,t.LSH)}}function x(n,a){if(1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"date"),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" \u4e88\u7d04\u958b\u59cb: ",t.xi3(2,1,e.item.reservationStartDate,"yyyy/MM/dd")," ")}}function D(n,a){1&n&&(t.ynx(0),t._uU(1," / "),t.BQk())}function L(n,a){if(1&n&&(t.TgZ(0,"span",9),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.Q6J("matTooltip","\u88dc\u8db3: "+e.item.note),t.xp6(1),t.hij(" ",e.item.note," ")}}function F(n,a){if(1&n&&(t.TgZ(0,"span",4),t.YNc(1,x,3,4,"ng-container",5),t.YNc(2,D,2,0,"ng-container",5),t.YNc(3,L,2,2,"span",8),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",void 0!==e.item.reservationStartDate&&!e.isPastDate(e.item.reservationStartDate)),t.xp6(1),t.Q6J("ngIf",void 0!==e.item.reservationStartDate&&!e.isPastDate(e.item.reservationStartDate)&&void 0!==e.item.note),t.xp6(1),t.Q6J("ngIf",void 0!==e.item.note)}}const I=function(n){return{"before-booking":n}};let T=(()=>{class n{constructor(){this.itemChange=new t.vpe}isPastDate(e){return new Date(e).getTime()<Date.now()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-goods-list-item"]],inputs:{item:"item"},outputs:{itemChange:"itemChange"},decls:10,vars:9,consts:[[3,"ngClass"],["matListItemIcon",""],[2,"float","left",3,"ngModel","ngModelChange"],["matListItemTitle",""],["matListItemLine",""],[4,"ngIf"],["matListItemLine","",4,"ngIf"],["target","_blank","rel","noopener",3,"href"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-list-item",0)(1,"span",1)(2,"mat-checkbox",2),t.NdJ("ngModelChange",function(r){return o.item.isDone=r})("ngModelChange",function(){return o.itemChange.emit(o.item)}),t.qZA()(),t.TgZ(3,"span",3),t._uU(4),t.qZA(),t.TgZ(5,"span",4),t._uU(6),t.YNc(7,A,5,1,"ng-container",5),t._uU(8),t.qZA(),t.YNc(9,F,4,3,"span",6),t.qZA()),2&e&&(t.Q6J("ngClass",t.VKq(7,I,o.item.reservationStartDate&&!o.isPastDate(o.item.reservationStartDate))),t.xp6(2),t.Q6J("ngModel",o.item.isDone),t.xp6(2),t.hij(" ",o.item.name," "),t.xp6(2),t.hij(" [",o.item.category,"] \xa0 "),t.xp6(1),t.Q6J("ngIf",o.item.url),t.xp6(1),t.hij(" ",o.item.maker||"-"," "),t.xp6(1),t.Q6J("ngIf",void 0!==o.item.reservationStartDate&&!o.isPastDate(o.item.reservationStartDate)||void 0!==o.item.note))},dependencies:[m.mk,m.O5,v.oG,C.Hw,g.Tg,g.Yt,g.WW,g.sL,B.gM,_.JJ,_.On,m.uU],styles:["a[_ngcontent-%COMP%]{color:#4876a9}a[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.5rem;vertical-align:middle}.before-booking[_ngcontent-%COMP%]   .mat-mdc-list-item-title[_ngcontent-%COMP%], .before-booking[_ngcontent-%COMP%]   .mat-mdc-list-item-icon[_ngcontent-%COMP%]{opacity:.6}"]}),n})();function Z(n,a){1&n&&(t.TgZ(0,"div",3)(1,"p"),t._uU(2,"\u8aad\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059...\u3057\u3070\u3089\u304f\u304a\u5f85\u3061\u304f\u3060\u3055\u3044..."),t.qZA()())}function S(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-goods-list-item",12),t.NdJ("itemChange",function(){const r=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.onItemStatusChange(r))}),t.qZA(),t.BQk()}if(2&n){const e=a.$implicit;t.xp6(1),t.Q6J("item",e)}}function E(n,a){if(1&n&&(t.TgZ(0,"div",8)(1,"mat-list",null,9)(3,"div",10),t._uU(4,"\u672a\u4ed5\u5206\u3051\u30fb\u672a\u6ce8\u6587"),t.qZA(),t.YNc(5,S,2,1,"ng-container",11),t.qZA()()),2&n){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.items.undone)}}function G(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-goods-list-item",12),t.NdJ("itemChange",function(){const r=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.onItemStatusChange(r))}),t.qZA(),t.BQk()}if(2&n){const e=a.$implicit;t.xp6(1),t.Q6J("item",e)}}function b(n,a){if(1&n&&(t.TgZ(0,"div",8)(1,"mat-list",null,9)(3,"div",10),t._uU(4,"\u6ce8\u6587\u6e08\u30fb\u898b\u9001\u308a\u6e08"),t.qZA(),t.YNc(5,G,2,1,"ng-container",11),t.qZA()()),2&n){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.items.done)}}const w=[{path:"",component:(()=>{class n{constructor(e,o){this.goodsListService=e,this.snackBar=o,this.items=void 0}ngOnInit(){var e=this;return(0,d.Z)(function*(){e.load()})()}load(){var e=this;return(0,d.Z)(function*(){try{const o=yield e.goodsListService.getGoodsList();e.items={undone:o.filter(i=>!i.isDone),done:o.filter(i=>i.isDone)}}catch(o){e.snackBar.open(`\u30a8\u30e9\u30fc: ${o.message}`,"OK")}})()}onItemStatusChange(e){var o=this;return(0,d.Z)(function*(){yield o.goodsListService.setItemStatus(e.id,e.isDone),o.load()})()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(P),t.Y36(y.ux))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-goods-list-page"]],decls:31,vars:3,consts:[[1,"app-page-summary"],["class","app-card bordered",4,"ngIf"],["class","app-card bordered goods-list",4,"ngIf"],[1,"app-card","bordered"],["href","https://twitter.com/arisu_newsfeed","target","_blank","rel","noopener"],["routerLink","/arisu-calendar"],[1,"app-bottom-navigation"],["routerLink","/"],[1,"app-card","bordered","goods-list"],["goodsList",""],["mat-subheader",""],[4,"ngFor","ngForOf"],[3,"item","itemChange"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"\u3042\u308a\u3059\u30b0\u30c3\u30ba\u30ea\u30b9\u30c8 (\u03b1 ver.)"),t.qZA()(),t.YNc(3,Z,3,0,"div",1),t.YNc(4,E,6,1,"div",2),t.YNc(5,b,6,1,"div",2),t.TgZ(6,"div",3)(7,"p")(8,"small"),t._uU(9," \u203b \u901f\u5831\u6027\u30fb\u6b63\u78ba\u6027\u30fb\u7db2\u7f85\u6027\u306a\u3069\u306f\u4fdd\u8a3c\u3067\u304d\u307e\u305b\u3093\u3002"),t._UZ(10,"br"),t._uU(11," \u307e\u305f\u3001\u4e88\u544a\u306a\u304f\u3001\u66f4\u65b0\u3092\u4f11\u6b62\u30fb\u7d42\u4e86\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u81ea\u5df1\u8cac\u4efb\u3067\u3054\u5229\u7528\u4e0b\u3055\u3044\u3002"),t._UZ(12,"br")(13,"br"),t._uU(14," \u203b \u5909\u66f4\u3057\u305f\u5185\u5bb9\u306f\u3001\u7aef\u672b\u5185\u306e\u307f\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002"),t._UZ(15,"br"),t._uU(16,"\u30d6\u30e9\u30a6\u30b6\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u6d88\u53bb\u306a\u3069\u3067\u6d88\u3048\u308b\u3053\u3068\u3082\u3042\u308b\u70ba\u3001\u304a\u307e\u3051\u7a0b\u5ea6\u306b\u3054\u6d3b\u7528\u304f\u3060\u3055\u3044\u3002"),t._UZ(17,"br")(18,"br"),t._uU(19," \u203b \u65b0\u7740\u60c5\u5831\u306e\u30c1\u30a7\u30c3\u30af\u306b\u306f\u3001"),t.TgZ(20,"a",4),t._uU(21,"@arisu_newsfeed"),t.qZA(),t._uU(22," \u3084\u3001"),t.TgZ(23,"a",5),t._uU(24,"\u3042\u308a\u3059\u30ab\u30ec\u30f3\u30c0\u30fc"),t.qZA(),t._uU(25," \u3082\u3054\u6d3b\u7528\u304f\u3060\u3055\u3044\u3002 "),t.qZA()()(),t.TgZ(26,"div",6)(27,"a",7)(28,"mat-icon"),t._uU(29,"navigate_before"),t.qZA(),t._uU(30," \xa0 \u30db\u30fc\u30e0\u3078"),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngIf",void 0===o.items),t.xp6(1),t.Q6J("ngIf",void 0!==o.items),t.xp6(1),t.Q6J("ngIf",void 0!==o.items))},dependencies:[m.sg,m.O5,l.rH,C.Hw,g.i$,g.gs,T],styles:[".wbr[_ngcontent-%COMP%]{word-break:keep-all;overflow-wrap:anywhere}h3[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:.75rem}h4[_ngcontent-%COMP%]{font-size:.9rem;margin:0}a[_ngcontent-%COMP%]:not([mat-stroked-button], [mat-raised-button])[_ngcontent-%COMP%]{word-wrap:break-word;color:#4d75c2;transition:all .2s ease-in-out}a[_ngcontent-%COMP%]:not([mat-stroked-button], [mat-raised-button])[_ngcontent-%COMP%]:hover{opacity:.7}a[_ngcontent-%COMP%]:not([mat-stroked-button], [mat-raised-button])[_ngcontent-%COMP%]   .app-card[_ngcontent-%COMP%]{color:#333}.app-card[_ngcontent-%COMP%]{box-sizing:border-box;width:90vw;max-width:800px;padding:1.2rem 0;position:relative;background-color:#fff;border-radius:10px}.app-card.bordered[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;box-shadow:0 2px 4px #0003}.app-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{font-size:.85rem;padding-left:2rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin:.5rem 0 .8rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:inline-block;margin-top:.2rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:square}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:.25rem 0 .5rem}.app-page-summary[_ngcontent-%COMP%]{width:80vw;text-align:center}.app-page-summary[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#555;font-size:1.5rem;font-weight:lighter;margin:0}.app-bottom-navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#666;font-size:.8rem;text-decoration:none;margin-left:-1.5rem}.app-bottom-navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#bddbfd;margin-bottom:0;vertical-align:middle}","[_nghost-%COMP%]{padding:1.5rem 1rem;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1.5rem}.app-card[_ngcontent-%COMP%]{padding:1rem 1rem .75rem}small[_ngcontent-%COMP%]{font-size:.8rem}@media screen and (max-width: 768px){.goods-list[_ngcontent-%COMP%]{padding-left:0;padding-right:0}}"]}),n})(),title:"\u3042\u308a\u3059\u30b0\u30c3\u30ba\u30ea\u30b9\u30c8"}];let U=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[l.Bz.forChild(w),l.Bz]}),n})();var J=u(1179);let k=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.ez,U,J.m]}),n})()}}]);