(self.webpackChunkarisucool=self.webpackChunkarisucool||[]).push([[512],{2512:(St,kt,M)=>{"use strict";M.r(kt),M.d(kt,{GoodsListModule:()=>Be});var K=M(6814),Et=M(8109),$=M(5861),t=M(5879),q=M(9347),ut=M(2296),At=M(5986),ot=M(6223),C=M(6825),yt=M(7044),st=M(553),O=function(e){return e[e.BEFORE_RESERVATION=0]="BEFORE_RESERVATION",e[e.RESERVATION=1]="RESERVATION",e[e.END_OF_RESERVATION=2]="END_OF_RESERVATION",e[e.BEFORE_SALE=3]="BEFORE_SALE",e[e.ON_SALE=4]="ON_SALE",e[e.END_OF_SALE=5]="END_OF_SALE",e[e.BEFORE_RESALE=6]="BEFORE_RESALE",e[e.ON_RESALE=7]="ON_RESALE",e[e.END_OF_RESALE=8]="END_OF_RESALE",e[e.UNKNOWN=9]="UNKNOWN",e}(O||{}),ct=function(e){return e[e.A=0]="A",e[e.B=1]="B",e[e.A_B=2]="A_B",e[e.C=3]="C",e}(ct||{}),Tt=M(4316),Pt=M(2779);let Mt=(()=>{var e;class u{constructor(o){this.appCacheService=o,this.GOODS_LIST_STORAGE_VERSION=1}init(){var o=this;return(0,$.Z)(function*(){o.storage||(o.storage=yield(0,yt.H)({name:"arisucoolGoodsListItemStatus",version:o.GOODS_LIST_STORAGE_VERSION}))})()}getGoodsList(o=!0){var i=this;return(0,$.Z)(function*(){yield i.init();const s=yield i.appCacheService.getCachedJson("arisuGoodsList",u.GOODS_LIST_JSON_CACHE_EXPIRES);if(s){let E=yield i.injectStatuses(s);return o&&(E=i.sortItems(E)),E}const l=yield fetch(st.N.SHOPPING_LIST_JSON_API_URL);if(!l.ok)throw new Error("Failed to fetch goods list");const d=yield l.json();i.appCacheService.setCachedJson("arisuGoodsList",d);let h=yield i.injectStatuses(d);return o&&(h=i.sortItems(h)),h})()}getGoodsListAsCsv(){var o=this;return(0,$.Z)(function*(){const i=yield o.getGoodsList(!1);i.sort((d,h)=>d.id<h.id?-1:d.id===h.id?0:1);const s=i.map(d=>({...d,salesStatus:O[d.salesStatus],paymentYearMonth:d.selectedPaymentYearMonth&&""!==d.selectedPaymentYearMonth?d.selectedPaymentYearMonth:d.estimatedPaymentYearMonth,parentId:void 0}));for(const d of s)if(d.children){for(const h of d.children){const E={...h,salesStatus:O[h.salesStatus],paymentYearMonth:d.paymentYearMonth,parentId:d.id},P=s.findIndex(R=>R.id===d.id);s.splice(P+1,0,E)}delete d.children}return Tt.unparse({fields:["id","category","maker","name","priceWithTax","boxPriceWithTax","customPriceWithTax","customQuantity","paymentYearMonth","salesStatus","isChecked","isArchived","parentId"],data:s},{header:!0,delimiter:","})})()}getTotalPriceByGoodsList(o,i=!1){let s=0,l=0;for(const d of o)if(i||!d.isArchived)if(d.children){let h=this.getTotalPriceByGoodsList(d.children,i);s+=h.minPrice,l+=h.maxPrice}else{if(!d.isChecked)continue;void 0!==d.customPriceWithTax?(s+=d.customPriceWithTax*(d.customQuantity??1),l+=d.customPriceWithTax*(d.customQuantity??1)):(s+=d.priceWithTax??0,l+=d.boxPriceWithTax??d.priceWithTax??0)}return{minPrice:s,maxPrice:l}}getEndSaleReason(o,i=new Date){const s=o.endOfResaleDate?new Date(o.endOfResaleDate):void 0,l=o.confirmedEndOfResaleDate?new Date(o.confirmedEndOfResaleDate):void 0;if(s||l)return s&&s<i||l&&l<i?"END_OF_RESALE":void 0;const d=o.endOfSaleDate?new Date(o.endOfSaleDate):void 0,h=o.confirmedEndOfSaleDate?new Date(o.confirmedEndOfSaleDate):void 0;return(o.endOfSaleDate||o.confirmedEndOfSaleDate)&&(d&&d<i||h&&h<i)?"END_OF_SALE":void 0}setItemStatus(o,i,s,l,d=1,h,E){var P=this;return(0,$.Z)(function*(){if(yield P.init(),!P.storage)throw new Error("Failed to init storage");const R=yield P.storage.get(o.toString()),V=R?R.firstCheckedAt:(new Date).toISOString(),Ft={isChecked:i,isArchived:s,paymentYearMonth:l,savedAt:(new Date).toISOString(),firstCheckedAt:V,customPriceWithTax:h,customQuantity:d,customMemo:E};P.storage.set(o.toString(),Ft)})()}injectStatuses(o,i){var s=this;return(0,$.Z)(function*(){let l=[];for(const d of o){if(!d||isNaN(d.id))continue;let h=s.getItemSalesStatus(d);h===O.UNKNOWN&&i&&(h=i.salesStatus);let E=ct.C;switch(d.salesType){case"A":E=ct.A;break;case"A/B":E=ct.A_B;break;case"B":E=ct.B;break;case"C":E=ct.C}let P=s.getEstimatedPaymentYearMonth(d,h);const R={...d,salesStatus:h,salesType:E,estimatedPaymentYearMonth:P,isChecked:!1,isArchived:!1};R.children&&(R.children=yield s.injectStatuses(R.children,R)),l.push(R)}for(const d of l){const h=yield s.storage?.get(d.id.toString());d.customPriceWithTax=h?h.customPriceWithTax:void 0,d.customQuantity=h?h.customQuantity:void 0,d.customMemo=h?h.customMemo:d.note,d.isChecked=!!h&&h.isChecked,d.isArchived=!!h&&h.isArchived,d.selectedPaymentYearMonth=h?h.paymentYearMonth:""}return l})()}sortItems(o){return o}getItemSalesStatus(o,i=new Date){const s=this.getEndSaleReason(o,i);if("END_OF_SALE"===s)return O.END_OF_SALE;if("END_OF_RESALE"===s)return O.END_OF_RESALE;let l=O.UNKNOWN;const d=o.reservationStartDate;if(d){if(new Date(d)>i)return l=O.BEFORE_RESERVATION,l;l=O.RESERVATION}const h=o.reservationEndDate;if(h){const V=new Date(h);if(l===O.RESERVATION&&V>i)return l;V<i&&(l=O.END_OF_RESERVATION)}const E=o.saleDate;if(E)if(new Date(E)>i){if(l===O.RESERVATION)return l;l=O.BEFORE_SALE}else l=O.ON_SALE;const P=o.endOfSaleDate;P&&new Date(P)<i&&(l=O.END_OF_SALE);const R=o.resaleDate;return R&&(l=new Date(R)>i?O.BEFORE_RESALE:O.ON_RESALE),l}getEstimatedPaymentYearMonth(o,i){let s=o.estimatedPaymentYearMonth;return s||(void 0===i&&console.warn("[GoodsListService] getEstimatedPaymentYearMonth - salesStatus is undefined",o),i===O.BEFORE_RESERVATION&&o.reservationEndDate?s=this.dateToYearMonth(o.reservationEndDate):i===O.BEFORE_RESERVATION&&o.saleDate?s=this.dateToYearMonth(o.saleDate):i===O.BEFORE_RESERVATION&&o.reservationStartDate?s=this.dateToYearMonth(o.reservationStartDate):i===O.RESERVATION&&o.reservationEndDate?s=this.dateToYearMonth(o.reservationEndDate):i===O.RESERVATION&&o.saleDate?s=this.dateToYearMonth(o.saleDate):i===O.END_OF_RESERVATION&&o.reservationEndDate?s=this.dateToYearMonth(o.reservationEndDate):i===O.END_OF_RESERVATION&&o.saleDate||i===O.BEFORE_SALE&&o.saleDate?s=this.dateToYearMonth(o.saleDate):i===O.END_OF_SALE&&o.endOfSaleDate?s=this.dateToYearMonth(o.endOfSaleDate):i===O.END_OF_SALE&&o.confirmedEndOfSaleDate&&(s=this.dateToYearMonth(o.confirmedEndOfSaleDate))),s||(s=this.dateToYearMonth(new Date)),s}dateToYearMonth(o){let i;if(o instanceof Date){if(isNaN(o.getTime()))return;i=o}else if(i=new Date(o),isNaN(i.getTime()))return;const s=i.getMonth()+1;return`${i.getFullYear()}/${s.toString().padStart(2,"0")}`}}return(e=u).GOODS_LIST_JSON_CACHE_EXPIRES=18e5,e.\u0275fac=function(o){return new(o||e)(t.LFG(Pt.g))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),u})();var ft=M(1175),X=M(5313),Ot=M(2596);function Bt(e,u){1&e&&(t.TgZ(0,"th",12),t._uU(1,"\u5e74\u6708"),t.qZA())}function wt(e,u){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.qZA()),2&e){const n=u.$implicit;t.xp6(1),t.Oqu(n.yearMonth)}}function bt(e,u){1&e&&(t.TgZ(0,"th",12),t._uU(1,"\u5408\u8a08\u91d1\u984d"),t.qZA())}function mt(e,u){if(1&e&&(t.TgZ(0,"span",15),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,n.maxPrice,"JPY","symbol")," ")}}function b(e,u){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.ALo(2,"currency"),t.YNc(3,mt,3,5,"span",14),t.qZA()),2&e){const n=u.$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,2,n.minPrice,"JPY","symbol")," "),t.xp6(2),t.Q6J("ngIf",n.maxPrice&&n.maxPrice!=n.minPrice)}}function r(e,u){1&e&&(t.TgZ(0,"th",12),t._uU(1,"\u8cfc\u5165\u6570"),t.qZA())}function a(e,u){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.qZA()),2&e){const n=u.$implicit;t.xp6(1),t.Oqu(n.numOfGoods)}}function c(e,u){1&e&&(t.TgZ(0,"th",16),t._uU(1,"\xa0"),t.qZA())}function m(e,u){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"keyboard_arrow_down"),t.qZA())}function p(e,u){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"keyboard_arrow_up"),t.qZA())}function A(e,u){if(1&e){const n=t.EpF();t.TgZ(0,"td",13)(1,"button",17),t.NdJ("click",function(i){const l=t.CHM(n).$implicit,d=t.oxw();return d.expandedElement=d.expandedElement===l?null:l,t.KtG(i.stopPropagation())}),t.YNc(2,m,2,0,"mat-icon",18),t.YNc(3,p,2,0,"mat-icon",18),t.qZA()()}if(2&e){const n=u.$implicit,o=t.oxw();t.xp6(2),t.Q6J("ngIf",o.expandedElement!==n),t.xp6(1),t.Q6J("ngIf",o.expandedElement===n)}}function y(e,u){if(1&e&&(t.TgZ(0,"span",23),t._uU(1),t.qZA()),2&e){const n=t.oxw(3).$implicit;t.xp6(1),t.hij(" x ",n.customQuantity," ")}}function U(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",21),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.YNc(4,y,2,1,"span",22),t.BQk()),2&e){const n=t.oxw(2).$implicit;t.xp6(2),t.hij(" ",t.Dn7(3,2,n.customPriceWithTax,"JPY","symbol")," "),t.xp6(2),t.Q6J("ngIf",n.customQuantity&&1!==n.customQuantity)}}function Z(e,u){if(1&e&&(t.TgZ(0,"span",21),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw(3).$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,1,n.priceWithTax,"JPY","symbol")," ")}}function g(e,u){if(1&e&&(t.TgZ(0,"span",26),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw(3).$implicit;t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,n.boxPriceWithTax,"JPY","symbol")," ")}}function L(e,u){if(1&e&&(t.ynx(0),t.YNc(1,Z,3,5,"span",24),t.YNc(2,g,3,5,"span",25),t.BQk()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",n.priceWithTax),t.xp6(1),t.Q6J("ngIf",n.boxPriceWithTax)}}function x(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"li"),t._uU(2),t._uU(3," \xa0\xa0 "),t.YNc(4,U,5,6,"ng-container",18),t.YNc(5,L,3,2,"ng-container",18),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",n.name," "),t.xp6(2),t.Q6J("ngIf",n.customPriceWithTax),t.xp6(1),t.Q6J("ngIf",!n.customPriceWithTax)}}function at(e,u){if(1&e&&(t.TgZ(0,"span",23),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.hij(" x ",n.customQuantity," ")}}function W(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",21),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.YNc(4,at,2,1,"span",22),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.Dn7(3,2,n.customPriceWithTax,"JPY","symbol")," "),t.xp6(2),t.Q6J("ngIf",n.customQuantity&&1!==n.customQuantity)}}function _(e,u){if(1&e&&(t.TgZ(0,"span",21),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,1,n.priceWithTax,"JPY","symbol")," ")}}function k(e,u){if(1&e&&(t.TgZ(0,"span",26),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,n.boxPriceWithTax,"JPY","symbol")," ")}}function j(e,u){if(1&e&&(t.ynx(0),t.YNc(1,_,3,5,"span",24),t.YNc(2,k,3,5,"span",25),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",n.priceWithTax),t.xp6(1),t.Q6J("ngIf",n.boxPriceWithTax)}}function S(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"li"),t._uU(2),t._uU(3," \xa0\xa0 "),t.YNc(4,W,5,6,"ng-container",18),t.YNc(5,j,3,2,"ng-container",18),t.qZA(),t.BQk()),2&e){const n=u.$implicit;t.xp6(2),t.hij(" ",n.name," "),t.xp6(2),t.Q6J("ngIf",n.customPriceWithTax),t.xp6(1),t.Q6J("ngIf",!n.customPriceWithTax)}}function J(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"li"),t._uU(2),t.TgZ(3,"ul"),t.YNc(4,S,6,3,"ng-container",20),t.qZA()(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",n.name," "),t.xp6(2),t.Q6J("ngForOf",n.children)}}function Q(e,u){if(1&e&&(t.ynx(0),t.YNc(1,x,6,3,"ng-container",18),t.YNc(2,J,5,2,"ng-container",18),t.BQk()),2&e){const n=u.$implicit;t.xp6(1),t.Q6J("ngIf",!n.children),t.xp6(1),t.Q6J("ngIf",n.children)}}function G(e,u){if(1&e&&(t.TgZ(0,"td",13)(1,"div",19)(2,"ul"),t.YNc(3,Q,3,2,"ng-container",20),t.qZA()()()),2&e){const n=u.$implicit,o=t.oxw();t.uIk("colspan",o.displayedColumnsExpand.length),t.xp6(1),t.Q6J("@detailExpand",n==o.expandedElement?"expanded":"collapsed"),t.xp6(2),t.Q6J("ngForOf",n.goods)}}function f(e,u){1&e&&t._UZ(0,"tr",27)}function v(e,u){if(1&e){const n=t.EpF();t.TgZ(0,"tr",28),t.NdJ("click",function(){const s=t.CHM(n).$implicit,l=t.oxw();return t.KtG(l.expandedElement=l.expandedElement===s?null:s)}),t.qZA()}if(2&e){const n=u.$implicit,o=t.oxw();t.ekj("table-expanded-row",o.expandedElement===n)}}function B(e,u){1&e&&t._UZ(0,"tr",29)}const Y=function(){return["expandedDetail"]};let D=(()=>{var e;class u{constructor(o){this.goodsListService=o,this.paymentReports=[],this.isIncludeArchiveItems=!1,this.displayedColumns=["yearMonth","price","numOfGoods"],this.displayedColumnsExpand=[...this.displayedColumns,"expand"],this.expandedElement=null}ngOnInit(){var o=this;return(0,$.Z)(function*(){yield o.load()})()}load(){var o=this;return(0,$.Z)(function*(){let l=(yield o.goodsListService.getGoodsList()).map(E=>{if(E.isChecked)return E;if(E.children){const P=E.children.filter(R=>R.isChecked);if(P.length>0)return E.children=P,E}}).filter(E=>void 0!==E);o.isIncludeArchiveItems||(l=l.filter(E=>!E.isArchived));const d={};for(const E of l){const P=E.selectedPaymentYearMonth?E.selectedPaymentYearMonth:E.estimatedPaymentYearMonth;d[P]||(d[P]=[]),d[P].push(E)}let h=Object.keys(d).sort().reverse();o.paymentReports=[];for(const E of h){const P=d[E],R=o.goodsListService.getTotalPriceByGoodsList(P,o.isIncludeArchiveItems);let V=0;for(const Ft of P)V+=Ft.customQuantity??1;o.paymentReports.push({yearMonth:E,minPrice:R.minPrice,maxPrice:R.maxPrice,goods:P,numOfGoods:V})}})()}ngOnChanges(){this.load()}}return(e=u).\u0275fac=function(o){return new(o||e)(t.Y36(Mt))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-goods-payment-report"]],inputs:{isIncludeArchiveItems:"isIncludeArchiveItems"},features:[t.TTD],decls:18,vars:5,consts:[["mat-table","","multiTemplateDataRows","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","yearMonth"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","price"],["matColumnDef","numOfGoods"],["matColumnDef","expand"],["mat-header-cell","","aria-label","row actions",4,"matHeaderCellDef"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","table-element-row",3,"table-expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","table-detail-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["matTooltip","\u3053\u306e\u5e74\u6708\u306f\u30e9\u30f3\u30c0\u30e0\u5546\u54c1\u7b49\u304c\u3042\u308b\u305f\u3081\u3001\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",4,"ngIf"],["matTooltip","\u3053\u306e\u5e74\u6708\u306f\u30e9\u30f3\u30c0\u30e0\u5546\u54c1\u7b49\u304c\u3042\u308b\u305f\u3081\u3001\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059"],["mat-header-cell","","aria-label","row actions"],["mat-icon-button","","aria-label","expand row",3,"click"],[4,"ngIf"],[1,"table-element-detail"],[4,"ngFor","ngForOf"],[1,"price"],["class","quantity",4,"ngIf"],[1,"quantity"],["class","price",4,"ngIf"],["class","price","matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",4,"ngIf"],["matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",1,"price"],["mat-header-row",""],["mat-row","",1,"table-element-row",3,"click"],["mat-row","",1,"table-detail-row"]],template:function(o,i){1&o&&(t.TgZ(0,"table",0),t.ynx(1,1),t.YNc(2,Bt,2,0,"th",2),t.YNc(3,wt,2,1,"td",3),t.BQk(),t.ynx(4,4),t.YNc(5,bt,2,0,"th",2),t.YNc(6,b,4,6,"td",3),t.BQk(),t.ynx(7,5),t.YNc(8,r,2,0,"th",2),t.YNc(9,a,2,1,"td",3),t.BQk(),t.ynx(10,6),t.YNc(11,c,2,0,"th",7),t.YNc(12,A,4,2,"td",3),t.BQk(),t.ynx(13,8),t.YNc(14,G,4,3,"td",3),t.BQk(),t.YNc(15,f,1,0,"tr",9),t.YNc(16,v,1,2,"tr",10),t.YNc(17,B,1,0,"tr",11),t.qZA()),2&o&&(t.Q6J("dataSource",i.paymentReports),t.xp6(15),t.Q6J("matHeaderRowDef",i.displayedColumnsExpand),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumnsExpand),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(4,Y)))},dependencies:[K.sg,K.O5,ut.RK,ft.Hw,X.BZ,X.fO,X.as,X.w1,X.Dz,X.nj,X.ge,X.ev,X.XQ,X.Gk,Ot.gM,K.H9],styles:["table[_ngcontent-%COMP%]{box-shadow:0 0 5px #0000001a}tr.table-detail-row[_ngcontent-%COMP%]{height:0}tr.table-element-row[_ngcontent-%COMP%]:not(.table-expanded-row):hover{background:whitesmoke}tr.table-element-row[_ngcontent-%COMP%]:not(.table-expanded-row):active{background:#efefef}.table-element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.table-element-detail[_ngcontent-%COMP%]{background-color:#fff;overflow:hidden;display:flex}.table-element-detail[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin-bottom:1rem}.table-element-detail[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin-top:.25rem;margin-bottom:.25rem}.table-element-detail[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%], .table-element-detail[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{font-size:.8rem}"],data:{animation:[(0,C.X$)("detailExpand",[(0,C.SB)("collapsed",(0,C.oB)({height:"0px",minHeight:"0"})),(0,C.SB)("expanded",(0,C.oB)({height:"*"})),(0,C.eR)("expanded <=> collapsed",(0,C.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),u})(),z=(()=>{var e;class u{constructor(o){this.dialogRef=o,this.isIncludeArchiveItems=!1}}return(e=u).\u0275fac=function(o){return new(o||e)(t.Y36(q.so))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-goods-payment-report-dialog"]],decls:8,vars:2,consts:[[3,"isIncludeArchiveItems"],["align","end"],[3,"ngModel","ngModelChange"],[2,"flex","1 1 auto"],["mat-dialog-close","","mat-stroked-button","","color","primary"]],template:function(o,i){1&o&&(t.TgZ(0,"mat-dialog-content"),t._UZ(1,"app-goods-payment-report",0),t.qZA(),t.TgZ(2,"mat-dialog-actions",1)(3,"mat-checkbox",2),t.NdJ("ngModelChange",function(l){return i.isIncludeArchiveItems=l}),t._uU(4,"\u30a2\u30fc\u30ab\u30a4\u30d6\u6e08\u307f\u3092\u542b\u3081\u308b"),t.qZA(),t._UZ(5,"span",3),t.TgZ(6,"button",4),t._uU(7,"OK"),t.qZA()()),2&o&&(t.xp6(1),t.Q6J("isIncludeArchiveItems",i.isIncludeArchiveItems),t.xp6(2),t.Q6J("ngModel",i.isIncludeArchiveItems))},dependencies:[ut.lW,At.oG,q.ZT,q.xY,q.H8,ot.JJ,ot.On,D]}),u})();var N=M(2939),F=M(2032),H=M(9157);function tt(e,u){if(1&e&&(t.TgZ(0,"span",14),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" \u6a19\u6e96\u4fa1\u683c: ",t.Dn7(2,1,n.data.item.priceWithTax,"JPY","symbol")," ")}}function rt(e,u){if(1&e&&(t.TgZ(0,"span",15),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,n.data.item.boxPriceWithTax,"JPY","symbol")," ")}}function lt(e,u){if(1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"currency"),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.hij(" ",t.Dn7(2,1,n.data.item.customQuantity*n.data.item.customPriceWithTax,"JPY","symbol")," ")}}function et(e,u){1&e&&(t.ynx(0),t._uU(1," - "),t.BQk())}let w=(()=>{var e;class u{constructor(o,i){this.dialogRef=o,this.data=i}ngOnInit(){}}return(e=u).\u0275fac=function(o){return new(o||e)(t.Y36(q.so),t.Y36(q.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-goods-list-item-edit-dialog"]],decls:29,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["class","default-price",4,"ngIf"],["class","default-price","matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",4,"ngIf"],["floatLabel","always"],["matInput","","type","number","min","1","step","1","max","1000000",3,"ngModel","ngModelChange"],["matSuffix",""],["matInput","","type","number","min","1","step","1","max","100",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],[2,"font-size","0.8rem","margin-left","1rem"],[4,"ngIf"],[2,"flex","1 1 auto"],["mat-button","","mat-dialog-close",""],["mat-button","","color","primary","mat-dialog-close","OK","cdkFocusInitial",""],[1,"default-price"],["matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",1,"default-price"]],template:function(o,i){1&o&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1)(3,"p"),t.YNc(4,tt,3,5,"span",2),t.YNc(5,rt,3,5,"span",3),t.qZA(),t.TgZ(6,"mat-form-field",4)(7,"mat-label"),t._uU(8,"\u8cfc\u5165\u3057\u305f\u91d1\u984d"),t.qZA(),t.TgZ(9,"input",5),t.NdJ("ngModelChange",function(l){return i.data.item.customPriceWithTax=l}),t.qZA(),t.TgZ(10,"span",6),t._uU(11,"\u5186"),t.qZA()(),t.TgZ(12,"mat-form-field",4)(13,"mat-label"),t._uU(14,"\u8cfc\u5165\u3057\u305f\u500b\u6570"),t.qZA(),t.TgZ(15,"input",7),t.NdJ("ngModelChange",function(l){return i.data.item.customQuantity=l}),t.qZA(),t.TgZ(16,"span",6),t._uU(17,"\u500b"),t.qZA()()(),t.TgZ(18,"div",8)(19,"span",9),t._uU(20," \u5c0f\u8a08: \xa0 "),t.YNc(21,lt,3,5,"ng-container",10),t.YNc(22,et,2,0,"ng-container",10),t._uU(23," \xa0 \xa0 "),t.qZA(),t._UZ(24,"span",11),t.TgZ(25,"button",12),t._uU(26,"\u30ad\u30e3\u30f3\u30bb\u30eb"),t.qZA(),t.TgZ(27,"button",13),t._uU(28," \u4fdd\u5b58 "),t.qZA()()),2&o&&(t.xp6(1),t.Oqu(i.data.item.name),t.xp6(3),t.Q6J("ngIf",i.data.item.priceWithTax),t.xp6(1),t.Q6J("ngIf",i.data.item.boxPriceWithTax),t.xp6(4),t.Q6J("ngModel",i.data.item.customPriceWithTax),t.xp6(6),t.Q6J("ngModel",i.data.item.customQuantity),t.xp6(6),t.Q6J("ngIf",i.data.item.customQuantity&&i.data.item.customPriceWithTax),t.xp6(1),t.Q6J("ngIf",!i.data.item.customQuantity||!i.data.item.customPriceWithTax))},dependencies:[K.O5,ut.lW,q.ZT,q.uh,q.xY,q.H8,F.Nt,H.KE,H.hX,H.R9,Ot.gM,ot.Fj,ot.wV,ot.JJ,ot.qQ,ot.Fd,ot.On,K.H9],styles:["div[mat-dialog-content][_ngcontent-%COMP%]{display:flex;flex-direction:column}.default-price[_ngcontent-%COMP%]{font-size:.9rem}"]}),u})();var I=M(6973),T=M(5195),_t=M(7988);function dt(e,u){if(1&e&&(t.TgZ(0,"span",21),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,n.item.reservationStartDate,"yyyy/MM/dd")," \u304b\u3089 ")}}function xt(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",19),t._uU(2," \u4e88\u7d04\u958b\u59cb\u524d "),t.qZA(),t.YNc(3,dt,3,4,"span",20),t.BQk()),2&e){const n=t.oxw();t.xp6(3),t.Q6J("ngIf",n.item.reservationStartDate)}}function pt(e,u){if(1&e&&(t.TgZ(0,"span",24),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,n.item.reservationEndDate,"yyyy/MM/dd")," \u307e\u3067 ")}}function gt(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",22),t._uU(2," \u4e88\u7d04\u53d7\u4ed8\u4e2d "),t.qZA(),t.YNc(3,pt,3,4,"span",23),t.BQk()),2&e){const n=t.oxw();t.xp6(3),t.Q6J("ngIf",n.item.reservationEndDate)}}function ht(e,u){1&e&&(t.ynx(0),t.TgZ(1,"span",25),t._uU(2," \u4e88\u7d04\u7d42\u4e86 "),t.qZA(),t.BQk())}function nt(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",26),t._uU(2," \u767a\u58f2\u524d "),t.qZA(),t.TgZ(3,"span",27),t._uU(4),t.ALo(5,"date"),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(4),t.hij(" ",t.xi3(5,1,n.item.saleDate,"yyyy/MM/dd")," \u304b\u3089 ")}}function vt(e,u){if(1&e&&(t.TgZ(0,"span",30),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,n.item.endOfSaleDate,"yyyy/MM/dd")," \u307e\u3067 ")}}function it(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",28),t._uU(2," \u8ca9\u58f2\u4e2d "),t.qZA(),t.YNc(3,vt,3,4,"span",29),t.BQk()),2&e){const n=t.oxw();t.xp6(3),t.Q6J("ngIf",n.item.endOfSaleDate)}}function Zt(e,u){1&e&&(t.ynx(0),t.TgZ(1,"span",31),t._uU(2," \u7d42\u58f2 "),t.qZA(),t.BQk())}function Dt(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",32),t._uU(2," \u518d\u8ca9\u524d "),t.qZA(),t.TgZ(3,"span",33),t._uU(4),t.ALo(5,"date"),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(4),t.hij(" ",t.xi3(5,1,n.item.resaleDate,"yyyy/MM/dd")," \u304b\u3089 ")}}function Rt(e,u){if(1&e&&(t.TgZ(0,"span",36),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,n.item.endOfResaleDate,"yyyy/MM/dd")," \u307e\u3067 ")}}function Lt(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",34),t._uU(2," \u518d\u8ca9\u4e2d "),t.qZA(),t.YNc(3,Rt,3,4,"span",35),t.BQk()),2&e){const n=t.oxw();t.xp6(3),t.Q6J("ngIf",n.item.endOfResaleDate)}}function Nt(e,u){1&e&&(t.ynx(0),t.TgZ(1,"span",37),t._uU(2," \u518d\u8ca9\u7d42\u4e86 "),t.qZA(),t.BQk())}function It(e,u){1&e&&(t.ynx(0),t.TgZ(1,"span",38),t._uU(2," \u4e0d\u660e "),t.qZA(),t.BQk())}function Yt(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",39),t._uU(2),t.ALo(3,"currency"),t.ALo(4,"currency"),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(2),t.AsE(" ",t.Dn7(3,2,n.subtotalPrice.min,"JPY","symbol")," \u301c ",t.Dn7(4,6,n.subtotalPrice.max,"JPY","symbol")," ")}}function Qt(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",40),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(2),t.hij(" ",t.Dn7(3,1,n.subtotalPrice.min,"JPY","symbol")," ")}}const Gt=function(e){return{"memo-empty":e}};function Ut(e,u){if(1&e){const n=t.EpF();t.TgZ(0,"div",41)(1,"span",42),t._uU(2),t.qZA(),t.TgZ(3,"button",43),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.isMemoEditing=!0)}),t.TgZ(4,"mat-icon"),t._uU(5,"edit_note"),t.qZA()()()}if(2&e){const n=t.oxw();t.Q6J("ngClass",t.VKq(2,Gt,void 0===n.item.customMemo||0===n.item.customMemo.length)),t.xp6(2),t.hij(" ",n.item.customMemo," ")}}function Jt(e,u){if(1&e){const n=t.EpF();t.TgZ(0,"div",44)(1,"mat-form-field",45)(2,"mat-label"),t._uU(3,"\u30e1\u30e2"),t.qZA(),t.TgZ(4,"textarea",46),t.NdJ("ngModelChange",function(i){t.CHM(n);const s=t.oxw();return t.KtG(s.item.customMemo=i)})("ngModelChange",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.onChangeMemo())})("blur",function(){t.CHM(n);const i=t.oxw();return i.onChange(),t.KtG(i.isMemoEditing=!1)}),t.qZA()()()}if(2&e){const n=t.oxw();t.xp6(4),t.Q6J("ngModel",n.item.customMemo)}}function qt(e,u){if(1&e&&(t.TgZ(0,"span",53),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.hij(" x ",n.customQuantity," ")}}function Wt(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",51),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.YNc(4,qt,2,1,"span",52),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.Dn7(3,2,n.customPriceWithTax,"JPY","symbol")," "),t.xp6(2),t.Q6J("ngIf",n.customQuantity&&1!==n.customQuantity)}}function jt(e,u){if(1&e&&(t.TgZ(0,"span",51),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,1,n.priceWithTax,"JPY","symbol")," ")}}function zt(e,u){if(1&e&&(t.TgZ(0,"span",56),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,n.boxPriceWithTax,"JPY","symbol")," ")}}function Kt(e,u){if(1&e&&(t.ynx(0),t.YNc(1,jt,3,5,"span",54),t.YNc(2,zt,3,5,"span",55),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",n.priceWithTax),t.xp6(1),t.Q6J("ngIf",n.boxPriceWithTax)}}function $t(e,u){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",47)(2,"mat-checkbox",48),t.NdJ("ngModelChange",function(i){const l=t.CHM(n).$implicit;return t.KtG(l.isChecked=i)})("ngModelChange",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.onChange())}),t._uU(3),t.qZA(),t._uU(4," \xa0\xa0 "),t.TgZ(5,"div",49),t.YNc(6,Wt,5,6,"ng-container",2),t.YNc(7,Kt,3,2,"ng-container",2),t._uU(8," \xa0 "),t.TgZ(9,"button",50),t.NdJ("click",function(){const s=t.CHM(n).$implicit,l=t.oxw(2);return t.KtG(l.openEditDialog(s,!0))}),t.TgZ(10,"mat-icon"),t._uU(11,"edit"),t.qZA()()()(),t.BQk()}if(2&e){const n=u.$implicit;t.xp6(2),t.Q6J("ngModel",n.isChecked),t.xp6(1),t.hij(" ",n.name," "),t.xp6(3),t.Q6J("ngIf",n.customPriceWithTax),t.xp6(1),t.Q6J("ngIf",!n.customPriceWithTax)}}function Ht(e,u){if(1&e&&(t.ynx(0),t.YNc(1,$t,12,4,"ng-container",16),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.item.children)}}function Vt(e,u){if(1&e&&(t.TgZ(0,"span",53),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.hij(" x ",n.item.customQuantity," ")}}function Xt(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",51),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.YNc(4,Vt,2,1,"span",52),t.BQk()),2&e){const n=t.oxw(2);t.xp6(2),t.hij(" ",t.Dn7(3,2,n.item.customPriceWithTax,"JPY","symbol")," "),t.xp6(2),t.Q6J("ngIf",n.item.customQuantity&&1!==n.item.customQuantity)}}function te(e,u){if(1&e&&(t.TgZ(0,"span",51),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.hij(" ",t.Dn7(2,1,n.item.priceWithTax,"JPY","symbol")," ")}}function ee(e,u){if(1&e&&(t.TgZ(0,"span",56),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,n.item.boxPriceWithTax,"JPY","symbol")," ")}}function ne(e,u){if(1&e&&(t.ynx(0),t.YNc(1,te,3,5,"span",54),t.YNc(2,ee,3,5,"span",55),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",n.item.priceWithTax),t.xp6(1),t.Q6J("ngIf",n.item.boxPriceWithTax)}}function ie(e,u){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",47)(2,"mat-checkbox",48),t.NdJ("ngModelChange",function(i){t.CHM(n);const s=t.oxw();return t.KtG(s.item.isChecked=i)})("ngModelChange",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.onChange())}),t._uU(3),t.qZA(),t._uU(4," \xa0\xa0 "),t.TgZ(5,"div",49),t.YNc(6,Xt,5,6,"ng-container",2),t.YNc(7,ne,3,2,"ng-container",2),t._uU(8," \xa0 "),t.TgZ(9,"button",50),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.openEditDialog(i.item,!1))}),t.TgZ(10,"mat-icon"),t._uU(11,"edit"),t.qZA()()()(),t.BQk()}if(2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngModel",n.item.isChecked),t.xp6(1),t.hij(" ",n.item.name," "),t.xp6(3),t.Q6J("ngIf",n.item.customPriceWithTax),t.xp6(1),t.Q6J("ngIf",!n.item.customPriceWithTax)}}function oe(e,u){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"check_box"),t.qZA())}function ae(e,u){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"check_box_outline_blank"),t.qZA())}function re(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",57),t._uU(2),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(2),t.hij(" ",n.item.selectedPaymentYearMonth," ")}}function ue(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",58),t._uU(2),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(2),t.hij(" ",n.item.estimatedPaymentYearMonth," ")}}function se(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"span",60),t._uU(2),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",n.subLabel," ")}}function ce(e,u){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"button",59),t.NdJ("click",function(){const s=t.CHM(n).$implicit,l=t.oxw();return l.item.selectedPaymentYearMonth=s.yearMonth,t.KtG(l.onChange())}),t._uU(2),t.YNc(3,se,3,1,"ng-container",2),t.qZA(),t.BQk()}if(2&e){const n=u.$implicit,o=t.oxw();t.xp6(1),t.Q6J("disabled",o.item.selectedPaymentYearMonth&&o.item.selectedPaymentYearMonth==n.yearMonth||!o.item.selectedPaymentYearMonth&&o.item.estimatedPaymentYearMonth==n.yearMonth),t.xp6(1),t.hij(" ",n.label," "),t.xp6(1),t.Q6J("ngIf",n.subLabel)}}function le(e,u){if(1&e){const n=t.EpF();t.TgZ(0,"button",61),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return i.item.isArchived=!0,t.KtG(i.onChange())}),t.TgZ(1,"mat-icon"),t._uU(2,"archive"),t.qZA()()}}function de(e,u){if(1&e){const n=t.EpF();t.TgZ(0,"button",62),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return i.item.isArchived=!1,t.KtG(i.onChange())}),t.TgZ(1,"mat-icon"),t._uU(2,"unarchive"),t.qZA()()}}const me=function(e,u,n,o,i,s,l,d,h,E){return{"sales-before-reservation":e,"sales-reservation":u,"sales-end-of-reservation":n,"sales-before-sale":o,"sales-on-sale":i,"sales-end-of-sale":s,"sales-before-resale":l,"sales-on-resale":d,"sales-end-of-resale":h,"sales-unknown":E}};let _e=(()=>{var e;class u{constructor(o){this.matDialog=o,this.itemChange=new t.vpe,this.salesStatus=O,this.subtotalPrice={min:0,max:0},this.paymentYearMonths=[],this.isMemoEditing=!1}ngOnInit(){this.init()}onChange(){this.memoAutoSaveTimer&&clearTimeout(this.memoAutoSaveTimer),this.itemChange.emit(this.item),this.updateSubtotalPrice()}onChangeMemo(){this.memoAutoSaveTimer&&clearTimeout(this.memoAutoSaveTimer),this.memoAutoSaveTimer=setTimeout(()=>{this.onChange()},1e3)}toggleAllChecks(){const o=this.isAllChecked();if(this.item.isChecked=!o,this.item.children)for(const i of this.item.children)i.isChecked=!o}isAllChecked(){return this.item.children?this.item.children.every(o=>o.isChecked):this.item.isChecked}isPastDate(o){return new Date(o).getTime()<Date.now()}openEditDialog(o,i=!1){var s=this;return(0,$.Z)(function*(){const l={...o};void 0===l.customQuantity&&(l.customQuantity=1),void 0===l.customPriceWithTax&&(l.customPriceWithTax=l.priceWithTax);const d=s.matDialog.open(w,{data:{item:l}}),h=yield function Ct(e,u){const n="object"==typeof u;return new Promise((o,i)=>{let l,s=!1;e.subscribe({next:d=>{l=d,s=!0},error:i,complete:()=>{s?o(l):n?o(u.defaultValue):i(new I.K)}})})}(d.afterClosed());h&&"OK"===h&&(i&&s.item.children?(s.item.children=s.item.children.map(E=>E.id===o.id?l:E),s.itemChange.emit(s.item)):(void 0!==l.customQuantity&&(s.item.customQuantity=l.customQuantity),void 0!==l.customPriceWithTax&&(s.item.customPriceWithTax=l.customPriceWithTax),s.itemChange.emit(s.item)))})()}init(){this.paymentYearMonths=[];let o=(new Date).toISOString().slice(0,7);this.item.selectedPaymentYearMonth?o=this.item.selectedPaymentYearMonth:this.item.estimatedPaymentYearMonth&&(o=this.item.estimatedPaymentYearMonth);const i=Number(o.slice(0,4)),s=Number(o.slice(5,7));for(let l=-5;l<=5;l++){const d=i+Math.floor((s+l-1)/12),h=(s+l-1)%12+1;let E;if(this.item.reservationEndDate){const P=new Date(this.item.reservationEndDate),R=P.getFullYear(),V=P.getMonth()+1;d==R&&h==V&&(E=" (\u4e88\u7d04\u7de0\u5207)")}if(this.item.saleDate){const P=new Date(this.item.saleDate),R=P.getFullYear(),V=P.getMonth()+1;d==R&&h==V&&(E=" (\u767a\u58f2)")}this.paymentYearMonths.push({yearMonth:`${d}/${h.toString().padStart(2,"0")}`,label:`${d}/${h.toString().padStart(2,"0")}`,subLabel:E})}this.updateSubtotalPrice()}updateSubtotalPrice(){let o=0,i=0;if(this.item.isChecked&&(this.item.customPriceWithTax&&this.item.customQuantity?(o+=this.item.customPriceWithTax*this.item.customQuantity,i+=this.item.customPriceWithTax*this.item.customQuantity):this.item.priceWithTax&&(this.item.boxPriceWithTax?(o+=this.item.priceWithTax,i+=this.item.boxPriceWithTax):(o+=this.item.priceWithTax,i+=this.item.priceWithTax))),this.item.children)for(const s of this.item.children)s.isChecked&&(s.customPriceWithTax&&s.customQuantity?(o+=s.customPriceWithTax*s.customQuantity,i+=s.customPriceWithTax*s.customQuantity):s.priceWithTax&&(s.boxPriceWithTax?(o+=s.priceWithTax,i+=s.boxPriceWithTax):(o+=s.priceWithTax,i+=s.priceWithTax)));this.subtotalPrice.min=o,this.subtotalPrice.max=i}}return(e=u).\u0275fac=function(o){return new(o||e)(t.Y36(q.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-goods-list-card"]],inputs:{item:"item"},outputs:{itemChange:"itemChange"},decls:46,vars:43,consts:[[3,"ngClass"],[1,"item-summary"],[4,"ngIf"],[1,"maker"],["class","memo",3,"ngClass",4,"ngIf"],["class","memo-editor",4,"ngIf"],[1,"checklist"],[2,"display","flex","justify-content","end","gap","1rem","width","100%","padding-top","0"],["mat-icon-button","","color","primary","matTooltip","\u53c2\u8003\u30da\u30fc\u30b8\u3092\u958b\u304f","target","_blank","rel","noopener",3,"href","disabled"],[2,"margin-bottom","3px"],[2,"flex-grow","1"],["mat-icon-button","",3,"matTooltip","color","click"],["mat-icon-button","","color","primary",1,"payment-timing-button",3,"matMenuTriggerFor","matTooltip"],[1,"main"],[1,"arrow"],["paymentYearMonthMenu","matMenu"],[4,"ngFor","ngForOf"],["mat-icon-button","","color","primary","matTooltip","\u30a2\u30fc\u30ab\u30a4\u30d6\u3059\u308b",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","matTooltip","\u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u89e3\u9664\u3059\u308b",3,"click",4,"ngIf"],[1,"sales-status","before-reservation"],["class","sales-date","matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u4e88\u7d04\u958b\u59cb\u65e5",4,"ngIf"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u4e88\u7d04\u958b\u59cb\u65e5",1,"sales-date"],[1,"sales-status","reservation"],["class","sales-date","matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u4e88\u7d04\u7de0\u5207\u65e5",4,"ngIf"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u4e88\u7d04\u7de0\u5207\u65e5",1,"sales-date"],[1,"sales-status","end-of-reservation"],[1,"sales-status","before-sale"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u767a\u58f2\u65e5",1,"sales-date"],[1,"sales-status","on-sale"],["class","sales-date","matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u7d42\u58f2\u65e5",4,"ngIf"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u7d42\u58f2\u65e5",1,"sales-date"],[1,"sales-status","end-of-sale"],[1,"sales-status","before-resale"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u518d\u8ca9\u65e5",1,"sales-date"],[1,"sales-status","on-resale"],["class","sales-date","matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u518d\u8ca9\u7d42\u4e86\u65e5",4,"ngIf"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u518d\u8ca9\u7d42\u4e86\u65e5",1,"sales-date"],[1,"sales-status","end-of-resale"],[1,"sales-status","unknown"],["matTooltip","\u30e9\u30f3\u30c0\u30e0\u5546\u54c1\u7b49\u304c\u542b\u307e\u308c\u308b\u305f\u3081\u3001\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",1,"subtotal"],[1,"subtotal"],[1,"memo",3,"ngClass"],[1,"memo-content"],["mat-icon-button","","matTooltip","\u30e1\u30e2\u3092\u7de8\u96c6",1,"memo-edit-button",3,"click"],[1,"memo-editor"],["appearance","outline","floatLabel","always",1,"memo-editor"],["matInput","","placeholder","\u8cfc\u5165\u5e97\u8217\u3084\u6ce8\u6587\u756a\u53f7\u306a\u3069\u3001\u3054\u81ea\u7531\u306b\u30e1\u30e2\u3092\u3054\u5165\u529b\u304f\u3060\u3055\u3044\u3002\u7aef\u672b\u5185\u306b\u306e\u307f\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002",3,"ngModel","ngModelChange","blur"],[1,"checklist-item"],[3,"ngModel","ngModelChange"],[1,"price-container"],["mat-icon-button","","matTooltip","\u8cfc\u5165\u4fa1\u683c\u30fb\u500b\u6570\u3092\u5909\u66f4",1,"price-edit-button",3,"click"],[1,"price"],["class","quantity",4,"ngIf"],[1,"quantity"],["class","price",4,"ngIf"],["class","price","matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",4,"ngIf"],["matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",1,"price"],[1,"payment-year-month","selected"],[1,"payment-year-month","estimated"],["mat-menu-item","",3,"disabled","click"],[2,"font-size","0.8rem"],["mat-icon-button","","color","primary","matTooltip","\u30a2\u30fc\u30ab\u30a4\u30d6\u3059\u308b",3,"click"],["mat-icon-button","","color","primary","matTooltip","\u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u89e3\u9664\u3059\u308b",3,"click"]],template:function(o,i){if(1&o&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-subtitle",1),t.YNc(5,xt,4,1,"ng-container",2),t.YNc(6,gt,4,1,"ng-container",2),t.YNc(7,ht,3,0,"ng-container",2),t.YNc(8,nt,6,4,"ng-container",2),t.YNc(9,it,4,1,"ng-container",2),t.YNc(10,Zt,3,0,"ng-container",2),t.YNc(11,Dt,6,4,"ng-container",2),t.YNc(12,Lt,4,1,"ng-container",2),t.YNc(13,Nt,3,0,"ng-container",2),t.YNc(14,It,3,0,"ng-container",2),t.TgZ(15,"span",3),t._uU(16),t.qZA(),t._uU(17," \xa0\xa0\xa0 "),t.YNc(18,Yt,5,10,"ng-container",2),t.YNc(19,Qt,4,5,"ng-container",2),t.YNc(20,Ut,6,4,"div",4),t.YNc(21,Jt,5,1,"div",5),t.qZA()(),t.TgZ(22,"mat-card-content")(23,"div",6),t.YNc(24,Ht,2,1,"ng-container",2),t.YNc(25,ie,12,4,"ng-container",2),t.qZA()(),t.TgZ(26,"mat-card-actions",7)(27,"a",8)(28,"mat-icon",9),t._uU(29,"link"),t.qZA()(),t._UZ(30,"div",10),t.TgZ(31,"button",11),t.NdJ("click",function(){return i.toggleAllChecks(),i.onChange()}),t.YNc(32,oe,2,0,"mat-icon",2),t.YNc(33,ae,2,0,"mat-icon",2),t.qZA(),t.TgZ(34,"button",12)(35,"mat-icon",13),t._uU(36,"currency_yen"),t.qZA(),t.TgZ(37,"mat-icon",14),t._uU(38,"arrow_drop_down"),t.qZA(),t.YNc(39,re,3,1,"ng-container",2),t.YNc(40,ue,3,1,"ng-container",2),t.qZA(),t.TgZ(41,"mat-menu",null,15),t.YNc(43,ce,4,3,"ng-container",16),t.qZA(),t.YNc(44,le,3,0,"button",17),t.YNc(45,de,3,0,"button",18),t.qZA()()),2&o){const s=t.MAs(42);t.Q6J("ngClass",t.rFY(32,me,[i.item.salesStatus===i.salesStatus.BEFORE_RESERVATION,i.item.salesStatus===i.salesStatus.RESERVATION,i.item.salesStatus===i.salesStatus.END_OF_RESERVATION,i.item.salesStatus===i.salesStatus.BEFORE_SALE,i.item.salesStatus===i.salesStatus.ON_SALE,i.item.salesStatus===i.salesStatus.END_OF_SALE,i.item.salesStatus===i.salesStatus.BEFORE_RESALE,i.item.salesStatus===i.salesStatus.ON_RESALE,i.item.salesStatus===i.salesStatus.END_OF_RESALE,i.item.salesStatus===i.salesStatus.UNKNOWN])),t.xp6(3),t.hij(" ",i.item.name,""),t.xp6(2),t.Q6J("ngIf",i.item.salesStatus===i.salesStatus.BEFORE_RESERVATION),t.xp6(1),t.Q6J("ngIf",i.item.salesStatus===i.salesStatus.RESERVATION),t.xp6(1),t.Q6J("ngIf",i.item.salesStatus===i.salesStatus.END_OF_RESERVATION),t.xp6(1),t.Q6J("ngIf",i.item.salesStatus===i.salesStatus.BEFORE_SALE),t.xp6(1),t.Q6J("ngIf",i.item.salesStatus===i.salesStatus.ON_SALE),t.xp6(1),t.Q6J("ngIf",i.item.salesStatus===i.salesStatus.END_OF_SALE),t.xp6(1),t.Q6J("ngIf",i.item.salesStatus===i.salesStatus.BEFORE_RESALE),t.xp6(1),t.Q6J("ngIf",i.item.salesStatus===i.salesStatus.ON_RESALE),t.xp6(1),t.Q6J("ngIf",i.item.salesStatus===i.salesStatus.END_OF_RESALE),t.xp6(1),t.Q6J("ngIf",i.item.salesStatus===i.salesStatus.UNKNOWN),t.xp6(2),t.hij(" ",i.item.maker||"-"," "),t.xp6(2),t.Q6J("ngIf",i.subtotalPrice.min!=i.subtotalPrice.max),t.xp6(1),t.Q6J("ngIf",i.subtotalPrice.min==i.subtotalPrice.max),t.xp6(1),t.Q6J("ngIf",!1===i.isMemoEditing),t.xp6(1),t.Q6J("ngIf",i.isMemoEditing),t.xp6(3),t.Q6J("ngIf",i.item.children&&i.item.children.length>=1),t.xp6(1),t.Q6J("ngIf",!i.item.children||0==i.item.children.length),t.xp6(2),t.Q6J("href",i.item.url,t.LSH)("disabled",!i.item.url),t.xp6(4),t.Q6J("matTooltip",i.isAllChecked()?"\u5168\u3066\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5916\u3059":"\u5168\u3066\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b")("color",i.isAllChecked()?"accent":""),t.xp6(1),t.Q6J("ngIf",i.isAllChecked()),t.xp6(1),t.Q6J("ngIf",!i.isAllChecked()),t.xp6(1),t.Q6J("matMenuTriggerFor",s)("matTooltip",i.item.selectedPaymentYearMonth?"\u6708\u3054\u3068\u306e\u5408\u8a08\u91d1\u984d\u3092\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u30b0\u30c3\u30ba\u306e\u652f\u6255\u3044\u6642\u671f\u306f "+i.item.selectedPaymentYearMonth+" \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5909\u66f4\u3059\u308b\u5834\u5408\u306f\u3001\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002":"\u6708\u3054\u3068\u306e\u5408\u8a08\u91d1\u984d\u3092\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u30b0\u30c3\u30ba\u306e\u63a8\u6e2c\u3055\u308c\u308b\u652f\u6255\u3044\u6642\u671f\u306f"+i.item.estimatedPaymentYearMonth+"\u3067\u3059\u3002\u3000\u3000\u3000\u305f\u3060\u3057\u3001\u4fdd\u8a3c\u3059\u308b\u3082\u306e\u3067\u306f\u306a\u304f\u3001\u652f\u6255\u3044\u65b9\u6cd5\u3001\u5e97\u8217\u3001\u8ca9\u58f2\u306e\u7a2e\u985e\u306b\u3088\u3063\u3066\u3082\u7570\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u5834\u5408\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3001\u5e74\u6708\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044\u3002"),t.xp6(5),t.Q6J("ngIf",i.item.selectedPaymentYearMonth),t.xp6(1),t.Q6J("ngIf",!i.item.selectedPaymentYearMonth&&i.item.estimatedPaymentYearMonth),t.xp6(3),t.Q6J("ngForOf",i.paymentYearMonths),t.xp6(1),t.Q6J("ngIf",!i.item.isArchived),t.xp6(1),t.Q6J("ngIf",i.item.isArchived)}},dependencies:[K.mk,K.sg,K.O5,ut.o6,ut.RK,T.a8,T.hq,T.dn,T.dk,T.$j,T.n5,At.oG,ft.Hw,F.Nt,H.KE,H.hX,_t.VK,_t.OP,_t.p6,Ot.gM,ot.Fj,ot.JJ,ot.On,K.H9,K.uU],styles:["mat-card[_ngcontent-%COMP%]{padding-left:.5rem}mat-card.sales-before-reservation[_ngcontent-%COMP%]{border-left:.5rem solid #1abc9c}mat-card.sales-reservation[_ngcontent-%COMP%]{border-left:.5rem solid #27ae60}mat-card.sales-end-of-reservation[_ngcontent-%COMP%]{border-left:.5rem solid #7f8c8d}mat-card.sales-before-sale[_ngcontent-%COMP%]{border-left:.5rem solid #1abc9c}mat-card.sales-on-sale[_ngcontent-%COMP%]{border-left:.5rem solid #27ae60}mat-card.sales-end-of-sale[_ngcontent-%COMP%]{border-left:.5rem solid #7f8c8d}mat-card.sales-before-resale[_ngcontent-%COMP%]{border-left:.5rem solid #1abc9c}mat-card.sales-on-resale[_ngcontent-%COMP%]{border-left:.5rem solid #27ae60}mat-card.sales-end-of-resale[_ngcontent-%COMP%]{border-left:.5rem solid #7f8c8d}mat-card.sales-unknown[_ngcontent-%COMP%]{border-left:.5rem solid #aaaaaa}  .mat-mdc-card-header-text{width:100%}.item-summary[_ngcontent-%COMP%]   .sales-status.before-reservation[_ngcontent-%COMP%]{color:#1abc9c}.item-summary[_ngcontent-%COMP%]   .sales-status.reservation[_ngcontent-%COMP%]{color:#27ae60}.item-summary[_ngcontent-%COMP%]   .sales-status.end-of-reservation[_ngcontent-%COMP%]{color:#7f8c8d}.item-summary[_ngcontent-%COMP%]   .sales-status.before-sale[_ngcontent-%COMP%]{color:#1abc9c}.item-summary[_ngcontent-%COMP%]   .sales-status.on-sale[_ngcontent-%COMP%]{color:#27ae60}.item-summary[_ngcontent-%COMP%]   .sales-status.end-of-sale[_ngcontent-%COMP%]{color:#7f8c8d}.item-summary[_ngcontent-%COMP%]   .sales-status.before-resale[_ngcontent-%COMP%]{color:#1abc9c}.item-summary[_ngcontent-%COMP%]   .sales-status.on-resale[_ngcontent-%COMP%]{color:#27ae60}.item-summary[_ngcontent-%COMP%]   .sales-status.end-of-resale[_ngcontent-%COMP%]{color:#7f8c8d}.item-summary[_ngcontent-%COMP%]   .sales-status.unknown[_ngcontent-%COMP%]{color:#aaa}.item-summary[_ngcontent-%COMP%]   .sales-date[_ngcontent-%COMP%]{margin-left:1rem;font-weight:bolder}.item-summary[_ngcontent-%COMP%]   .maker[_ngcontent-%COMP%]{margin-left:2rem}.item-summary[_ngcontent-%COMP%]   .subtotal[_ngcontent-%COMP%]{color:#333;white-space:nowrap}.memo[_ngcontent-%COMP%]{border-radius:.5rem;color:#666}.memo[_ngcontent-%COMP%]:not(.memo-empty){margin-top:.25rem;margin-bottom:.1rem;padding:0 .25rem}.memo.memo-empty[_ngcontent-%COMP%]{display:inline-block;margin-left:1rem}.memo[_ngcontent-%COMP%]:not(.memo-empty):hover{background:#f8f8f8;color:#101010}.memo[_ngcontent-%COMP%]   .memo-content[_ngcontent-%COMP%]{font-size:.8rem}.memo[_ngcontent-%COMP%]   .memo-edit-button[_ngcontent-%COMP%]{color:#000;height:1.7rem;width:1.7rem;line-height:1.7rem;padding:0;vertical-align:middle;margin-left:1rem}.memo[_ngcontent-%COMP%]   .memo-edit-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.2rem;height:1.2rem;width:1.2rem;line-height:1rem;vertical-align:middle}.memo-editor[_ngcontent-%COMP%]{font-size:.8rem;width:100%;margin-top:.25rem}.checklist[_ngcontent-%COMP%]{display:flex;flex-direction:column}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]{border-radius:12px;display:flex;justify-content:space-between;align-items:center}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]:hover{background:#f8f8f8}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]{white-space:nowrap}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%], .checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{font-size:.8rem}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .price-edit-button[_ngcontent-%COMP%]{color:#555;height:1.5rem;width:1.5rem;line-height:1.5rem;padding:0;vertical-align:middle}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .price-edit-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;height:1rem;width:1rem;line-height:.9rem;vertical-align:middle}.payment-timing-button[_ngcontent-%COMP%]{position:relative}.payment-timing-button[_ngcontent-%COMP%]   mat-icon.main[_ngcontent-%COMP%]{position:relative;line-height:1rem}.payment-timing-button[_ngcontent-%COMP%]   mat-icon.arrow[_ngcontent-%COMP%]{position:absolute;top:.7rem;right:-.4rem;line-height:1.2rem;opacity:.8}.payment-timing-button[_ngcontent-%COMP%]   .payment-year-month[_ngcontent-%COMP%]{position:absolute;font-size:.8rem;bottom:.2rem;left:0;right:0;text-align:center}@media screen and (max-width: 768px){.maker[_ngcontent-%COMP%]{display:none}mat-card-content[_ngcontent-%COMP%]{padding-top:.25rem;padding-left:0}}"]}),u})();function pe(e,u){1&e&&(t.TgZ(0,"div",9)(1,"p"),t._uU(2,"\u8aad\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059...\u3057\u3070\u3089\u304f\u304a\u5f85\u3061\u304f\u3060\u3055\u3044..."),t.qZA()())}function ge(e,u){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"button",17),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.isShowingTotalPrice=!0)}),t.TgZ(2,"mat-icon"),t._uU(3,"currency_yen"),t.qZA()(),t.BQk()}}function he(e,u){if(1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"currency"),t.ALo(3,"currency"),t.BQk()),2&e){const n=t.oxw(4);t.xp6(1),t.AsE(" ",t.Dn7(2,2,n.totalPrice.minPrice,"JPY","symbol")," \u301c ",t.Dn7(3,6,n.totalPrice.maxPrice,"JPY","symbol")," ")}}function fe(e,u){if(1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"currency"),t.BQk()),2&e){const n=t.oxw(4);t.xp6(1),t.hij(" ",t.Dn7(2,1,n.totalPrice.minPrice,"JPY","symbol")," ")}}function Ce(e,u){if(1&e&&(t.TgZ(0,"span",19),t.YNc(1,he,4,10,"ng-container",2),t.YNc(2,fe,3,5,"ng-container",2),t.qZA()),2&e){const n=t.oxw(3);t.Q6J("matTooltip",(n.isShowingArchivedItems?"\u30a2\u30fc\u30ab\u30a4\u30d6\u3055\u308c\u305f\u30b0\u30c3\u30ba\u3082\u542b\u3081\u3001\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5546\u54c1\u306e\u5408\u8a08\u984d\u3067\u3059\u3002":"\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5546\u54c1\u306e\u5408\u8a08\u984d\u3067\u3059\u3002")+(n.totalPrice.minPrice!==n.totalPrice.maxPrice?"\u30e9\u30f3\u30c0\u30e0\u5546\u54c1\u304c\u3042\u308b\u305f\u3081\u3001\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059":"")),t.xp6(1),t.Q6J("ngIf",n.totalPrice.minPrice!==n.totalPrice.maxPrice),t.xp6(1),t.Q6J("ngIf",n.totalPrice.minPrice===n.totalPrice.maxPrice)}}function xe(e,u){if(1&e&&(t.ynx(0),t.YNc(1,Ce,3,3,"span",18),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",n.isShowingTotalPrice)}}function Ee(e,u){if(1&e){const n=t.EpF();t.TgZ(0,"app-goods-list-card",21),t.NdJ("itemChange",function(){t.CHM(n);const i=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.onItemStatusChange(i))}),t.qZA()}if(2&e){const n=t.oxw().$implicit;t.Q6J("item",n)}}function Ae(e,u){if(1&e&&(t.ynx(0),t.YNc(1,Ee,1,1,"app-goods-list-card",20),t.BQk()),2&e){const n=u.$implicit;t.xp6(1),t.Q6J("ngIf",!1===n.isArchived)}}function ye(e,u){1&e&&t._UZ(0,"div",22)}function Te(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",23),t._uU(2,"expand_less"),t.qZA(),t._uU(3),t.BQk()),2&e){const n=t.oxw(2);t.xp6(3),t.hij(" \u30a2\u30fc\u30ab\u30a4\u30d6\u3057\u305f\u30b0\u30c3\u30ba\u3092\u975e\u8868\u793a (",n.numOfArchivedItems,"\u4ef6)\xa0 ")}}function Pe(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",23),t._uU(2,"expand_more"),t.qZA(),t._uU(3),t.BQk()),2&e){const n=t.oxw(2);t.xp6(3),t.hij(" \u30a2\u30fc\u30ab\u30a4\u30d6\u3057\u305f\u30b0\u30c3\u30ba\u3092\u8868\u793a (",n.numOfArchivedItems,"\u4ef6)\xa0 ")}}function Oe(e,u){if(1&e){const n=t.EpF();t.TgZ(0,"app-goods-list-card",21),t.NdJ("itemChange",function(){t.CHM(n);const i=t.oxw().$implicit,s=t.oxw(3);return t.KtG(s.onItemStatusChange(i))}),t.qZA()}if(2&e){const n=t.oxw().$implicit;t.Q6J("item",n)}}function ve(e,u){if(1&e&&(t.ynx(0),t.YNc(1,Oe,1,1,"app-goods-list-card",20),t.BQk()),2&e){const n=u.$implicit;t.xp6(1),t.Q6J("ngIf",!0===n.isArchived)}}function Me(e,u){if(1&e&&(t.ynx(0),t.TgZ(1,"div",24),t.YNc(2,ve,2,1,"ng-container",14),t.qZA(),t.BQk()),2&e){const n=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",n.items)}}function be(e,u){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",10),t.YNc(2,ge,4,0,"ng-container",2),t.YNc(3,xe,2,1,"ng-container",2),t.qZA(),t.TgZ(4,"div",11)(5,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.openPaymentReportDialog())}),t.TgZ(6,"mat-icon"),t._uU(7,"receipt_long"),t.qZA()()(),t.TgZ(8,"div",13),t.YNc(9,Ae,2,1,"ng-container",14),t.qZA(),t.YNc(10,ye,1,0,"div",15),t.TgZ(11,"button",16),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.toggleShowingArchive())}),t.YNc(12,Te,4,1,"ng-container",2),t.YNc(13,Pe,4,1,"ng-container",2),t.qZA(),t.YNc(14,Me,3,1,"ng-container",2),t.BQk()}if(2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",!n.isShowingTotalPrice),t.xp6(1),t.Q6J("ngIf",n.isShowingTotalPrice),t.xp6(6),t.Q6J("ngForOf",n.items),t.xp6(1),t.Q6J("ngIf",n.isShowingArchivedItems),t.xp6(1),t.Q6J("matTooltip",n.isShowingArchivedItems?"\u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u975e\u8868\u793a":"\u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u8868\u793a")("disabled",0===n.numOfArchivedItems),t.xp6(1),t.Q6J("ngIf",n.isShowingArchivedItems),t.xp6(1),t.Q6J("ngIf",!n.isShowingArchivedItems),t.xp6(1),t.Q6J("ngIf",n.isShowingArchivedItems)}}const De=[{path:"",component:(()=>{var e;class u{constructor(o,i,s){this.goodsListService=o,this.snackBar=i,this.matDialog=s,this.numOfArchivedItems=0,this.isShowingTotalPrice=!1,this.totalPrice={minPrice:0,maxPrice:0},this.isShowingArchivedItems=!1}ngOnInit(){var o=this;return(0,$.Z)(function*(){o.load()})()}load(){var o=this;return(0,$.Z)(function*(){try{o.items=yield o.goodsListService.getGoodsList(),o.calculateStatuses(o.items)}catch(i){o.snackBar.open(`\u30a8\u30e9\u30fc: ${i.message}`,"OK")}})()}onItemStatusChange(o){var i=this;return(0,$.Z)(function*(){let s=o.selectedPaymentYearMonth&&""!=o.selectedPaymentYearMonth?o.selectedPaymentYearMonth:o.estimatedPaymentYearMonth;if(console.log(o.customQuantity,o.customPriceWithTax),yield i.goodsListService.setItemStatus(o.id,o.isChecked,o.isArchived,s,o.customQuantity,o.customPriceWithTax,o.customMemo),o.children)for(const l of o.children)yield i.goodsListService.setItemStatus(l.id,l.isChecked,o.isArchived,s,l.customQuantity,l.customPriceWithTax,l.customMemo);i.snackBar.open("\u5909\u66f4\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f",void 0,{duration:1e3}),i.calculateStatuses()})()}calculateStatuses(o){var i=this;return(0,$.Z)(function*(){o||(o=yield i.goodsListService.getGoodsList()),i.totalPrice=i.goodsListService.getTotalPriceByGoodsList(o,i.isShowingArchivedItems),i.numOfArchivedItems=o.filter(s=>s.isArchived).length})()}toggleShowingArchive(){var o=this;return(0,$.Z)(function*(){o.isShowingArchivedItems=!o.isShowingArchivedItems,o.totalPrice=o.goodsListService.getTotalPriceByGoodsList(yield o.goodsListService.getGoodsList(),o.isShowingArchivedItems)})()}openPaymentReportDialog(){this.matDialog.open(z,{maxWidth:"96vw"})}exportAsCsv(){var o=this;return(0,$.Z)(function*(){const i=yield o.goodsListService.getGoodsListAsCsv(),s=new Date,d=`goods-list-${[s.getFullYear(),(s.getMonth()+1).toString().padStart(2,"0"),s.getDate().toString().padStart(2,"0"),"-",s.getHours().toString().padStart(2,"0"),s.getMinutes().toString().padStart(2,"0"),s.getSeconds().toString().padStart(2,"0")].join("")}.csv`,h=new Blob([i],{type:"text/csv"}),E=window.URL.createObjectURL(h),P=document.createElement("a");P.href=E,P.download=d,P.click(),window.URL.revokeObjectURL(E),o.snackBar.open("\u4e3b\u306a\u60c5\u5831\u3092CSV\u3068\u3057\u3066\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3057\u307e\u3057\u305f",void 0,{duration:2e3})})()}}return(e=u).\u0275fac=function(o){return new(o||e)(t.Y36(Mt),t.Y36(N.ux),t.Y36(q.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-goods-list-page"]],decls:42,vars:2,consts:[[1,"app-page-summary"],["class","app-card bordered",4,"ngIf"],[4,"ngIf"],[1,"app-card","bordered",2,"margin-top","1rem"],["href","https://twitter.com/arisu_newsfeed","target","_blank","rel","noopener"],["routerLink","/arisu-calendar"],["href","javascript:void(0)","matTooltip","CSV\u3068\u3057\u3066\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3092\u5b9f\u884c",3,"click"],[1,"app-bottom-navigation"],["routerLink","/"],[1,"app-card","bordered"],[1,"goods-total-summary"],[1,"goods-payment-report"],["mat-icon-button","","matTooltip","\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u9805\u76ee\u306b\u3064\u3044\u3066\u3001\u5e74\u6708\u3054\u3068\u306e\u652f\u6255\u3044\u984d\u3092\u8868\u793a",3,"click"],[1,"goods-cards"],[4,"ngFor","ngForOf"],["class","divider",4,"ngIf"],["mat-stroked-button","","color","primary",2,"margin","2rem 0 1rem 0",3,"matTooltip","disabled","click"],["mat-icon-button","","matTooltip","\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u9805\u76ee\u306e\u7dcf\u984d\u3092\u8868\u793a",3,"click"],["class","goods-total-price",3,"matTooltip",4,"ngIf"],[1,"goods-total-price",3,"matTooltip"],["class","goods-card",3,"item","itemChange",4,"ngIf"],[1,"goods-card",3,"item","itemChange"],[1,"divider"],[2,"vertical-align","middle"],[1,"goods-cards","archived-goods-cards"]],template:function(o,i){1&o&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"\u3042\u308a\u3059\u30b0\u30c3\u30ba\u30ea\u30b9\u30c8 (\u03b1 ver.)"),t.qZA()(),t.YNc(3,pe,3,0,"div",1),t.YNc(4,be,15,9,"ng-container",2),t.TgZ(5,"div",3)(6,"p")(7,"small"),t._uU(8," \u203b \u901f\u5831\u6027\u30fb\u6b63\u78ba\u6027\u30fb\u7db2\u7f85\u6027\u306a\u3069\u306f\u4fdd\u8a3c\u3067\u304d\u307e\u305b\u3093\u3002"),t._UZ(9,"br"),t._uU(10," \u307e\u305f\u3001\u4e88\u544a\u306a\u304f\u3001\u66f4\u65b0\u3092\u4f11\u6b62\u30fb\u7d42\u4e86\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u81ea\u5df1\u8cac\u4efb\u3067\u3054\u5229\u7528\u4e0b\u3055\u3044\u3002"),t._UZ(11,"br")(12,"br"),t._uU(13," \u203b \u672c\u30ea\u30b9\u30c8\u306f\u3001\u30b0\u30c3\u30ba\u60c5\u5831\u3092\u624b\u52d5\u3067\u6574\u7406\u30fb\u767b\u9332\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u767b\u9332\u307e\u3067\u306b\u6570\u65e5\u8981\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002"),t._UZ(14,"br"),t._uU(15," \u6700\u65b0\u306e\u60c5\u5831\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u306b\u306f\u3001\u4ee3\u308f\u308a\u306b\u3001"),t.TgZ(16,"a",4),t._uU(17,"\u30cb\u30e5\u30fc\u30b9\u30fb\u30bf\u30c1\u30d0\u30ca"),t.qZA(),t._uU(18," \u3084\u3001"),t.TgZ(19,"a",5),t._uU(20,"\u3042\u308a\u3059\u30ab\u30ec\u30f3\u30c0\u30fc"),t.qZA(),t._uU(21," \u3092\u3054\u6d3b\u7528\u304f\u3060\u3055\u3044\u3002"),t._UZ(22,"br")(23,"br"),t._uU(24," \u203b \u672c\u30ea\u30b9\u30c8\u306f\u3001 "),t.TgZ(25,"a",6),t.NdJ("click",function(){return i.exportAsCsv()}),t._uU(26," CSV\u3068\u3057\u3066\u30a8\u30af\u30b9\u30dd\u30fc\u30c8"),t.qZA(),t._uU(27," \u3059\u308b\u3053\u3068\u3067\u3001Excel \u306a\u3069\u3067\u306e\u96c6\u8a08\u306b\u3082\u304a\u4f7f\u3044\u3044\u305f\u3060\u3051\u307e\u3059\u3002"),t._UZ(28,"br")(29,"br"),t._uU(30," \u203b \u5909\u66f4\u3057\u305f\u5185\u5bb9\u306f\u3001\u7aef\u672b\u5185\u306e\u307f\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002"),t._UZ(31,"br"),t._uU(32,"\u30d6\u30e9\u30a6\u30b6\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u6d88\u53bb\u306a\u3069\u3067\u6d88\u3048\u308b\u3053\u3068\u3082\u3042\u308b\u70ba\u3001\u304a\u307e\u3051\u7a0b\u5ea6\u306b\u3054\u6d3b\u7528\u304f\u3060\u3055\u3044\u3002"),t._UZ(33,"br"),t._uU(34," \u306a\u304a\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u6a5f\u80fd\u306f\u3001\u73fe\u5728\u691c\u8a0e\u4e2d\u3067\u3059\u3002"),t._UZ(35,"br")(36,"br"),t.qZA()()(),t.TgZ(37,"div",7)(38,"a",8)(39,"mat-icon"),t._uU(40,"navigate_before"),t.qZA(),t._uU(41," \xa0 \u30db\u30fc\u30e0\u3078"),t.qZA()()),2&o&&(t.xp6(3),t.Q6J("ngIf",void 0===i.items),t.xp6(1),t.Q6J("ngIf",void 0!==i.items))},dependencies:[K.sg,K.O5,Et.rH,ut.lW,ut.RK,ft.Hw,Ot.gM,_e,K.H9],styles:[".wbr[_ngcontent-%COMP%]{word-break:keep-all;overflow-wrap:anywhere}h3[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:.75rem}h4[_ngcontent-%COMP%]{font-size:.9rem;margin:0}a[_ngcontent-%COMP%]:not([mat-stroked-button], [mat-raised-button])[_ngcontent-%COMP%]{word-wrap:break-word;color:#4d75c2;transition:all .2s ease-in-out}a[_ngcontent-%COMP%]:not([mat-stroked-button], [mat-raised-button])[_ngcontent-%COMP%]:hover{opacity:.7}a[_ngcontent-%COMP%]:not([mat-stroked-button], [mat-raised-button])[_ngcontent-%COMP%]   .app-card[_ngcontent-%COMP%]{color:#333}.app-card[_ngcontent-%COMP%]{box-sizing:border-box;width:90vw;max-width:800px;padding:1.2rem 0;position:relative;background-color:#fff;border-radius:10px}.app-card.bordered[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;box-shadow:0 2px 4px #0003}.app-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{font-size:.85rem;padding-left:2rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin:.5rem 0 .8rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:inline-block;margin-top:.2rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:square}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:.25rem 0 .5rem}.app-page-summary[_ngcontent-%COMP%]{width:80vw;text-align:center}.app-page-summary[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#555;font-size:1.5rem;font-weight:lighter;margin:0}.app-bottom-navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#666;font-size:.8rem;text-decoration:none;margin-left:-1.5rem}.app-bottom-navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#bddbfd;margin-bottom:0;vertical-align:middle}","[_nghost-%COMP%]{padding:1.5rem 1rem 3rem;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1.5rem}.app-card[_ngcontent-%COMP%]{padding:1rem 1rem .75rem}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:80vw;max-width:800px}.goods-total-summary[_ngcontent-%COMP%]{background-color:#fffd;border-radius:3rem;box-shadow:inset 0 0 0 1px #0000001a;padding:1rem 1.5rem 1rem 3rem;position:fixed;left:-2rem;bottom:1rem;z-index:10}.goods-total-summary[_ngcontent-%COMP%]   .goods-total-price[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#555;vertical-align:middle;margin-left:.25rem}.goods-payment-report[_ngcontent-%COMP%]{background-color:#fffd;border-radius:3rem;box-shadow:inset 0 0 0 1px #0000001a;padding:1rem 3rem 1rem 1.5rem;position:fixed;right:-2rem;bottom:1rem;z-index:10}.goods-cards[_ngcontent-%COMP%]{box-sizing:border-box;display:flex;flex-direction:column;align-items:center;gap:2rem;width:80vw}.goods-cards[_ngcontent-%COMP%]   .goods-card[_ngcontent-%COMP%]{width:90vw;max-width:800px}small[_ngcontent-%COMP%]{font-size:.8rem}.divider[_ngcontent-%COMP%]{width:100%;height:1px;background-color:#0002;margin:2rem 0}@media screen and (max-width: 768px){[_nghost-%COMP%]{padding-left:0;padding-right:0}.goods-cards[_ngcontent-%COMP%]{padding-left:0;padding-right:0;width:100vw}.goods-cards[_ngcontent-%COMP%]   .goods-card[_ngcontent-%COMP%]{width:95vw}.goods-total-summary[_ngcontent-%COMP%]{padding-left:2.25rem;padding-right:.75rem;bottom:2.5rem}.goods-payment-report[_ngcontent-%COMP%]{padding-left:.75rem;padding-right:2.25rem;bottom:2.5rem}}"]}),u})(),title:"\u3042\u308a\u3059\u30b0\u30c3\u30ba\u30ea\u30b9\u30c8"}];let Fe=(()=>{var e;class u{}return(e=u).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[Et.Bz.forChild(De),Et.Bz]}),u})();var ke=M(7904);let Be=(()=>{var e;class u{}return(e=u).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[K.ez,Fe,ke.m]}),u})()},4316:function(St,kt){var M,Et;M=function $(){"use strict";var t=typeof self<"u"?self:typeof window<"u"?window:void 0!==t?t:{},q=!t.document&&!!t.postMessage,ut=t.IS_PAPA_WORKER||!1,At={},ot=0,C={parse:function(r,a){var c=(a=a||{}).dynamicTyping||!1;if(b(c)&&(a.dynamicTypingFunction=c,c={}),a.dynamicTyping=c,a.transform=!!b(a.transform)&&a.transform,a.worker&&C.WORKERS_SUPPORTED){var m=function(){if(!C.WORKERS_SUPPORTED)return!1;var U,Z,A=(U=t.URL||t.webkitURL||null,Z=$.toString(),C.BLOB_URL||(C.BLOB_URL=U.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Z,")();"],{type:"text/javascript"})))),y=new t.Worker(A);return y.onmessage=Ot,y.id=ot++,At[y.id]=y}();return m.userStep=a.step,m.userChunk=a.chunk,m.userComplete=a.complete,m.userError=a.error,a.step=b(a.step),a.chunk=b(a.chunk),a.complete=b(a.complete),a.error=b(a.error),delete a.worker,void m.postMessage({input:r,config:a,workerId:m.id})}var A,p=null;return"string"==typeof r?(r=65279===(A=r).charCodeAt(0)?A.slice(1):A,p=a.download?new O(a):new Tt(a)):!0===r.readable&&b(r.read)&&b(r.on)?p=new Pt(a):(t.File&&r instanceof File||r instanceof Object)&&(p=new ct(a)),p.stream(r)},unparse:function(r,a){var c=!1,m=!0,p=",",A="\r\n",y='"',U=y+y,Z=!1,g=null,L=!1;!function(){if("object"==typeof a){if("string"!=typeof a.delimiter||C.BAD_DELIMITERS.filter(function(_){return-1!==a.delimiter.indexOf(_)}).length||(p=a.delimiter),("boolean"==typeof a.quotes||"function"==typeof a.quotes||Array.isArray(a.quotes))&&(c=a.quotes),"boolean"!=typeof a.skipEmptyLines&&"string"!=typeof a.skipEmptyLines||(Z=a.skipEmptyLines),"string"==typeof a.newline&&(A=a.newline),"string"==typeof a.quoteChar&&(y=a.quoteChar),"boolean"==typeof a.header&&(m=a.header),Array.isArray(a.columns)){if(0===a.columns.length)throw new Error("Option columns is empty");g=a.columns}void 0!==a.escapeChar&&(U=a.escapeChar+y),("boolean"==typeof a.escapeFormulae||a.escapeFormulae instanceof RegExp)&&(L=a.escapeFormulae instanceof RegExp?a.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var x=new RegExp(ft(y),"g");if("string"==typeof r&&(r=JSON.parse(r)),Array.isArray(r)){if(!r.length||Array.isArray(r[0]))return at(null,r,Z);if("object"==typeof r[0])return at(g||Object.keys(r[0]),r,Z)}else if("object"==typeof r)return"string"==typeof r.data&&(r.data=JSON.parse(r.data)),Array.isArray(r.data)&&(r.fields||(r.fields=r.meta&&r.meta.fields||g),r.fields||(r.fields=Array.isArray(r.data[0])?r.fields:"object"==typeof r.data[0]?Object.keys(r.data[0]):[]),Array.isArray(r.data[0])||"object"==typeof r.data[0]||(r.data=[r.data])),at(r.fields||[],r.data||[],Z);throw new Error("Unable to serialize unrecognized input");function at(_,k,j){var S="";"string"==typeof _&&(_=JSON.parse(_)),"string"==typeof k&&(k=JSON.parse(k));var J=Array.isArray(_)&&0<_.length,Q=!Array.isArray(k[0]);if(J&&m){for(var G=0;G<_.length;G++)0<G&&(S+=p),S+=W(_[G],G);0<k.length&&(S+=A)}for(var f=0;f<k.length;f++){var v=J?_.length:k[f].length,B=!1,Y=J?0===Object.keys(k[f]).length:0===k[f].length;if(j&&!J&&(B="greedy"===j?""===k[f].join("").trim():1===k[f].length&&0===k[f][0].length),"greedy"===j&&J){for(var D=[],z=0;z<v;z++)D.push(k[f][Q?_[z]:z]);B=""===D.join("").trim()}if(!B){for(var F=0;F<v;F++)0<F&&!Y&&(S+=p),S+=W(k[f][J&&Q?_[F]:F],F);f<k.length-1&&(!j||0<v&&!Y)&&(S+=A)}}return S}function W(_,k){if(null==_)return"";if(_.constructor===Date)return JSON.stringify(_).slice(1,25);var j=!1;L&&"string"==typeof _&&L.test(_)&&(_="'"+_,j=!0);var S=_.toString().replace(x,U);return(j=j||!0===c||"function"==typeof c&&c(_,k)||Array.isArray(c)&&c[k]||function(J,Q){for(var G=0;G<Q.length;G++)if(-1<J.indexOf(Q[G]))return!0;return!1}(S,C.BAD_DELIMITERS)||-1<S.indexOf(p)||" "===S.charAt(0)||" "===S.charAt(S.length-1))?y+S+y:S}}};if(C.RECORD_SEP=String.fromCharCode(30),C.UNIT_SEP=String.fromCharCode(31),C.BYTE_ORDER_MARK="\ufeff",C.BAD_DELIMITERS=["\r","\n",'"',C.BYTE_ORDER_MARK],C.WORKERS_SUPPORTED=!q&&!!t.Worker,C.NODE_STREAM_INPUT=1,C.LocalChunkSize=10485760,C.RemoteChunkSize=5242880,C.DefaultDelimiter=",",C.Parser=X,C.ParserHandle=Mt,C.NetworkStreamer=O,C.FileStreamer=ct,C.StringStreamer=Tt,C.ReadableStreamStreamer=Pt,t.jQuery){var yt=t.jQuery;yt.fn.parse=function(r){var a=r.config||{},c=[];return this.each(function(A){if("INPUT"!==yt(this).prop("tagName").toUpperCase()||"file"!==yt(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var y=0;y<this.files.length;y++)c.push({file:this.files[y],inputElem:this,instanceConfig:yt.extend({},a)})}),m(),this;function m(){if(0!==c.length){var y,U,Z,g=c[0];if(b(r.before)){var L=r.before(g.file,g.inputElem);if("object"==typeof L){if("abort"===L.action)return"AbortError",y=g.file,U=g.inputElem,Z=L.reason,void(b(r.error)&&r.error({name:"AbortError"},y,U,Z));if("skip"===L.action)return void p();"object"==typeof L.config&&(g.instanceConfig=yt.extend(g.instanceConfig,L.config))}else if("skip"===L)return void p()}var x=g.instanceConfig.complete;g.instanceConfig.complete=function(at){b(x)&&x(at,g.file,g.inputElem),p()},C.parse(g.file,g.instanceConfig)}else b(r.complete)&&r.complete()}function p(){c.splice(0,1),m()}}}function st(r){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(a){var c=bt(a);c.chunkSize=parseInt(c.chunkSize),a.step||a.chunk||(c.chunkSize=null),this._handle=new Mt(c),(this._handle.streamer=this)._config=c}.call(this,r),this.parseChunk=function(a,c){if(this.isFirstChunk&&b(this._config.beforeFirstChunk)){var m=this._config.beforeFirstChunk(a);void 0!==m&&(a=m)}this.isFirstChunk=!1,this._halted=!1;var p=this._partialLine+a;this._partialLine="";var A=this._handle.parse(p,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var y=A.meta.cursor;this._finished||(this._partialLine=p.substring(y-this._baseIndex),this._baseIndex=y),A&&A.data&&(this._rowCount+=A.data.length);var U=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(ut)t.postMessage({results:A,workerId:C.WORKER_ID,finished:U});else if(b(this._config.chunk)&&!c){if(this._config.chunk(A,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);A=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(A.data),this._completeResults.errors=this._completeResults.errors.concat(A.errors),this._completeResults.meta=A.meta),this._completed||!U||!b(this._config.complete)||A&&A.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),U||A&&A.meta.paused||this._nextChunk(),A}this._halted=!0},this._sendError=function(a){b(this._config.error)?this._config.error(a):ut&&this._config.error&&t.postMessage({workerId:C.WORKER_ID,error:a,finished:!1})}}function O(r){var a;(r=r||{}).chunkSize||(r.chunkSize=C.RemoteChunkSize),st.call(this,r),this._nextChunk=q?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(c){this._input=c,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(a=new XMLHttpRequest,this._config.withCredentials&&(a.withCredentials=this._config.withCredentials),q||(a.onload=mt(this._chunkLoaded,this),a.onerror=mt(this._chunkError,this)),a.open(this._config.downloadRequestBody?"POST":"GET",this._input,!q),this._config.downloadRequestHeaders){var c=this._config.downloadRequestHeaders;for(var m in c)a.setRequestHeader(m,c[m])}this._config.chunkSize&&a.setRequestHeader("Range","bytes="+this._start+"-"+(this._start+this._config.chunkSize-1));try{a.send(this._config.downloadRequestBody)}catch(A){this._chunkError(A.message)}q&&0===a.status&&this._chunkError()}},this._chunkLoaded=function(){var m;4===a.readyState&&(a.status<200||400<=a.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:a.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null===(m=a.getResponseHeader("Content-Range"))?-1:parseInt(m.substring(m.lastIndexOf("/")+1))),this.parseChunk(a.responseText)))},this._chunkError=function(c){this._sendError(new Error(a.statusText||c))}}function ct(r){var a,c;(r=r||{}).chunkSize||(r.chunkSize=C.LocalChunkSize),st.call(this,r);var m=typeof FileReader<"u";this.stream=function(p){this._input=p,c=p.slice||p.webkitSlice||p.mozSlice,m?((a=new FileReader).onload=mt(this._chunkLoaded,this),a.onerror=mt(this._chunkError,this)):a=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var p=this._input;if(this._config.chunkSize){var A=Math.min(this._start+this._config.chunkSize,this._input.size);p=c.call(p,this._start,A)}var y=a.readAsText(p,this._config.encoding);m||this._chunkLoaded({target:{result:y}})},this._chunkLoaded=function(p){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(p.target.result)},this._chunkError=function(){this._sendError(a.error)}}function Tt(r){var a;st.call(this,r=r||{}),this.stream=function(c){return a=c,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var c,m=this._config.chunkSize;return m?(c=a.substring(0,m),a=a.substring(m)):(c=a,a=""),this._finished=!a,this.parseChunk(c)}}}function Pt(r){st.call(this,r=r||{});var a=[],c=!0,m=!1;this.pause=function(){st.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){st.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(p){this._input=p,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){m&&1===a.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),a.length?this.parseChunk(a.shift()):c=!0},this._streamData=mt(function(p){try{a.push("string"==typeof p?p:p.toString(this._config.encoding)),c&&(c=!1,this._checkIsFinished(),this.parseChunk(a.shift()))}catch(A){this._streamError(A)}},this),this._streamError=mt(function(p){this._streamCleanUp(),this._sendError(p)},this),this._streamEnd=mt(function(){this._streamCleanUp(),m=!0,this._streamData("")},this),this._streamCleanUp=mt(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Mt(r){var a,c,m,p=Math.pow(2,53),A=-p,y=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,U=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Z=this,g=0,L=0,x=!1,at=!1,W=[],_={data:[],errors:[],meta:{}};if(b(r.step)){var k=r.step;r.step=function(f){if(_=f,J())S();else{if(S(),0===_.data.length)return;g+=f.data.length,r.preview&&g>r.preview?c.abort():(_.data=_.data[0],k(_,Z))}}}function j(f){return"greedy"===r.skipEmptyLines?""===f.join("").trim():1===f.length&&0===f[0].length}function S(){return _&&m&&(G("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+C.DefaultDelimiter+"'"),m=!1),r.skipEmptyLines&&(_.data=_.data.filter(function(f){return!j(f)})),J()&&function(){if(_)if(Array.isArray(_.data[0])){for(var v=0;J()&&v<_.data.length;v++)_.data[v].forEach(f);_.data.splice(0,1)}else _.data.forEach(f);function f(B,Y){b(r.transformHeader)&&(B=r.transformHeader(B,Y)),W.push(B)}}(),function(){if(!_||!r.header&&!r.dynamicTyping&&!r.transform)return _;function f(B,Y){var D,z=r.header?{}:[];for(D=0;D<B.length;D++){var N=D,F=B[D];r.header&&(N=D>=W.length?"__parsed_extra":W[D]),r.transform&&(F=r.transform(F,N)),F=Q(N,F),"__parsed_extra"===N?(z[N]=z[N]||[],z[N].push(F)):z[N]=F}return r.header&&(D>W.length?G("FieldMismatch","TooManyFields","Too many fields: expected "+W.length+" fields but parsed "+D,L+Y):D<W.length&&G("FieldMismatch","TooFewFields","Too few fields: expected "+W.length+" fields but parsed "+D,L+Y)),z}var v=1;return!_.data.length||Array.isArray(_.data[0])?(_.data=_.data.map(f),v=_.data.length):_.data=f(_.data,0),r.header&&_.meta&&(_.meta.fields=W),L+=v,_}()}function J(){return r.header&&0===W.length}function Q(f,v){return B=f,r.dynamicTypingFunction&&void 0===r.dynamicTyping[B]&&(r.dynamicTyping[B]=r.dynamicTypingFunction(B)),!0===(r.dynamicTyping[B]||r.dynamicTyping)?"true"===v||"TRUE"===v||"false"!==v&&"FALSE"!==v&&(function(Y){if(y.test(Y)){var D=parseFloat(Y);if(A<D&&D<p)return!0}return!1}(v)?parseFloat(v):U.test(v)?new Date(v):""===v?null:v):v;var B}function G(f,v,B,Y){var D={type:f,code:v,message:B};void 0!==Y&&(D.row=Y),_.errors.push(D)}this.parse=function(f,v,B){if(r.newline||(r.newline=function(N,F){N=N.substring(0,1048576);var H=new RegExp(ft(F)+"([^]*?)"+ft(F),"gm"),tt=(N=N.replace(H,"")).split("\r"),rt=N.split("\n");if(1===tt.length||1<rt.length&&rt[0].length<tt[0].length)return"\n";for(var et=0,w=0;w<tt.length;w++)"\n"===tt[w][0]&&et++;return et>=tt.length/2?"\r\n":"\r"}(f,r.quoteChar||'"')),m=!1,r.delimiter)b(r.delimiter)&&(r.delimiter=r.delimiter(f),_.meta.delimiter=r.delimiter);else{var D=function(N,F,H,tt,rt){var lt,et,w,I;rt=rt||[",","\t","|",";",C.RECORD_SEP,C.UNIT_SEP];for(var Ct=0;Ct<rt.length;Ct++){var T=rt[Ct],_t=0,dt=0,xt=0;w=void 0;for(var pt=new X({comments:tt,delimiter:T,newline:F,preview:10}).parse(N),gt=0;gt<pt.data.length;gt++)if(H&&j(pt.data[gt]))xt++;else{var ht=pt.data[gt].length;dt+=ht,void 0!==w?0<ht&&(_t+=Math.abs(ht-w),w=ht):w=ht}0<pt.data.length&&(dt/=pt.data.length-xt),(void 0===et||_t<=et)&&(void 0===I||I<dt)&&1.99<dt&&(et=_t,lt=T,I=dt)}return{successful:!!(r.delimiter=lt),bestDelimiter:lt}}(f,r.newline,r.skipEmptyLines,r.comments,r.delimitersToGuess);D.successful?r.delimiter=D.bestDelimiter:(m=!0,r.delimiter=C.DefaultDelimiter),_.meta.delimiter=r.delimiter}var z=bt(r);return r.preview&&r.header&&z.preview++,a=f,c=new X(z),_=c.parse(a,v,B),S(),x?{meta:{paused:!0}}:_||{meta:{paused:!1}}},this.paused=function(){return x},this.pause=function(){x=!0,c.abort(),a=b(r.chunk)?"":a.substring(c.getCharIndex())},this.resume=function(){Z.streamer._halted?(x=!1,Z.streamer.parseChunk(a,!0)):setTimeout(Z.resume,3)},this.aborted=function(){return at},this.abort=function(){at=!0,c.abort(),_.meta.aborted=!0,b(r.complete)&&r.complete(_),a=""}}function ft(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function X(r){var a,c=(r=r||{}).delimiter,m=r.newline,p=r.comments,A=r.step,y=r.preview,U=r.fastMode,Z=a=null==r.quoteChar?'"':r.quoteChar;if(void 0!==r.escapeChar&&(Z=r.escapeChar),("string"!=typeof c||-1<C.BAD_DELIMITERS.indexOf(c))&&(c=","),p===c)throw new Error("Comment character same as delimiter");!0===p?p="#":("string"!=typeof p||-1<C.BAD_DELIMITERS.indexOf(p))&&(p=!1),"\n"!==m&&"\r"!==m&&"\r\n"!==m&&(m="\n");var g=0,L=!1;this.parse=function(x,at,W){if("string"!=typeof x)throw new Error("Input must be a string");var _=x.length,k=c.length,j=m.length,S=p.length,J=b(A),Q=[],G=[],f=[],v=g=0;if(!x)return nt();if(r.header&&!at){var B=x.split(m)[0].split(c),Y=[],D={},z=!1;for(var N in B){var F=B[N];b(r.transformHeader)&&(F=r.transformHeader(F,N));var H=F,tt=D[F]||0;for(0<tt&&(z=!0,H=F+"_"+tt),D[F]=tt+1;Y.includes(H);)H=H+"_"+tt;Y.push(H)}if(z){var rt=x.split(m);rt[0]=Y.join(c),x=rt.join(m)}}if(U||!1!==U&&-1===x.indexOf(a)){for(var lt=x.split(m),et=0;et<lt.length;et++){if(g+=(f=lt[et]).length,et!==lt.length-1)g+=m.length;else if(W)return nt();if(!p||f.substring(0,S)!==p){if(J){if(Q=[],xt(f.split(c)),vt(),L)return nt()}else xt(f.split(c));if(y&&y<=et)return Q=Q.slice(0,y),nt(!0)}}return nt()}for(var w=x.indexOf(c,g),I=x.indexOf(m,g),Ct=new RegExp(ft(Z)+ft(a),"g"),T=x.indexOf(a,g);;)if(x[g]!==a)if(p&&0===f.length&&x.substring(g,g+S)===p){if(-1===I)return nt();I=x.indexOf(m,g=I+j),w=x.indexOf(c,g)}else if(-1!==w&&(w<I||-1===I))f.push(x.substring(g,w)),w=x.indexOf(c,g=w+k);else{if(-1===I)break;if(f.push(x.substring(g,I)),ht(I+j),J&&(vt(),L))return nt();if(y&&Q.length>=y)return nt(!0)}else for(T=g,g++;;){if(-1===(T=x.indexOf(a,T+1)))return W||G.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Q.length,index:g}),gt();if(T===_-1)return gt(x.substring(g,T).replace(Ct,a));if(a!==Z||x[T+1]!==Z){if(a===Z||0===T||x[T-1]!==Z){-1!==w&&w<T+1&&(w=x.indexOf(c,T+1)),-1!==I&&I<T+1&&(I=x.indexOf(m,T+1));var _t=pt(-1===I?w:Math.min(w,I));if(x.substr(T+1+_t,k)===c){f.push(x.substring(g,T).replace(Ct,a)),x[g=T+1+_t+k]!==a&&(T=x.indexOf(a,g)),w=x.indexOf(c,g),I=x.indexOf(m,g);break}var dt=pt(I);if(x.substring(T+1+dt,T+1+dt+j)===m){if(f.push(x.substring(g,T).replace(Ct,a)),ht(T+1+dt+j),w=x.indexOf(c,g),T=x.indexOf(a,g),J&&(vt(),L))return nt();if(y&&Q.length>=y)return nt(!0);break}G.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Q.length,index:g}),T++}}else T++}return gt();function xt(it){Q.push(it),v=g}function pt(it){var Zt=0;if(-1!==it){var Dt=x.substring(T+1,it);Dt&&""===Dt.trim()&&(Zt=Dt.length)}return Zt}function gt(it){return W||(void 0===it&&(it=x.substring(g)),f.push(it),g=_,xt(f),J&&vt()),nt()}function ht(it){g=it,xt(f),f=[],I=x.indexOf(m,g)}function nt(it){return{data:Q,errors:G,meta:{delimiter:c,linebreak:m,aborted:L,truncated:!!it,cursor:v+(at||0)}}}function vt(){A(nt()),Q=[],G=[]}},this.abort=function(){L=!0},this.getCharIndex=function(){return g}}function Ot(r){var a=r.data,c=At[a.workerId],m=!1;if(a.error)c.userError(a.error,a.file);else if(a.results&&a.results.data){var p={abort:function(){m=!0,Bt(a.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:wt,resume:wt};if(b(c.userStep)){for(var A=0;A<a.results.data.length&&(c.userStep({data:a.results.data[A],errors:a.results.errors,meta:a.results.meta},p),!m);A++);delete a.results}else b(c.userChunk)&&(c.userChunk(a.results,p,a.file),delete a.results)}a.finished&&!m&&Bt(a.workerId,a.results)}function Bt(r,a){var c=At[r];b(c.userComplete)&&c.userComplete(a),c.terminate(),delete At[r]}function wt(){throw new Error("Not implemented.")}function bt(r){if("object"!=typeof r||null===r)return r;var a=Array.isArray(r)?[]:{};for(var c in r)a[c]=bt(r[c]);return a}function mt(r,a){return function(){r.apply(a,arguments)}}function b(r){return"function"==typeof r}return ut&&(t.onmessage=function(r){var a=r.data;if(void 0===C.WORKER_ID&&a&&(C.WORKER_ID=a.workerId),"string"==typeof a.input)t.postMessage({workerId:C.WORKER_ID,results:C.parse(a.input,a.config),finished:!0});else if(t.File&&a.input instanceof File||a.input instanceof Object){var c=C.parse(a.input,a.config);c&&t.postMessage({workerId:C.WORKER_ID,results:c,finished:!0})}}),(O.prototype=Object.create(st.prototype)).constructor=O,(ct.prototype=Object.create(st.prototype)).constructor=ct,(Tt.prototype=Object.create(Tt.prototype)).constructor=Tt,(Pt.prototype=Object.create(st.prototype)).constructor=Pt,C},void 0!==(Et=M.apply(kt,[]))&&(St.exports=Et)}}]);