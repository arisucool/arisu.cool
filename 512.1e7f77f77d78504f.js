(self.webpackChunkarisucool=self.webpackChunkarisucool||[]).push([[512],{2512:(It,Rt,b)=>{"use strict";b.r(Rt),b.d(Rt,{GoodsListModule:()=>Be});var X=b(6814),Pt=b(8109),tt=b(5861),t=b(5879),z=b(9347),dt=b(2296),Ot=b(5986),ct=b(6223),y=b(6825),Dt=b(7044),_t=b(553),T=function(e){return e[e.BEFORE_RESERVATION=0]="BEFORE_RESERVATION",e[e.RESERVATION=1]="RESERVATION",e[e.END_OF_RESERVATION=2]="END_OF_RESERVATION",e[e.BEFORE_SALE=3]="BEFORE_SALE",e[e.ON_SALE=4]="ON_SALE",e[e.END_OF_SALE=5]="END_OF_SALE",e[e.BEFORE_RESALE=6]="BEFORE_RESALE",e[e.ON_RESALE=7]="ON_RESALE",e[e.END_OF_RESALE=8]="END_OF_RESALE",e[e.UNKNOWN=9]="UNKNOWN",e}(T||{}),G=function(e){return e[e.A=0]="A",e[e.B=1]="B",e[e.A_B=2]="A_B",e[e.C=3]="C",e}(G||{}),vt=b(4316),bt=b(2779);let wt=(()=>{var e;class r{constructor(o){this.appCacheService=o,this.GOODS_LIST_STORAGE_VERSION=1}init(){var o=this;return(0,tt.Z)(function*(){o.storage||(o.storage=yield(0,Dt.H)({name:"arisucoolGoodsListItemStatus",version:o.GOODS_LIST_STORAGE_VERSION}))})()}getGoodsList(o=!0){var n=this;return(0,tt.Z)(function*(){yield n.init();const u=yield n.appCacheService.getCachedJson("arisuGoodsList",r.GOODS_LIST_JSON_CACHE_EXPIRES);if(u){let g=yield n.injectStatuses(u);return o&&(g=n.sortItems(g)),g}const l=yield fetch(_t.N.SHOPPING_LIST_JSON_API_URL);if(!l.ok)throw new Error("Failed to fetch goods list");const d=yield l.json();n.appCacheService.setCachedJson("arisuGoodsList",d);let C=yield n.injectStatuses(d);return o&&(C=n.sortItems(C)),C})()}getGoodsListAsCsv(){var o=this;return(0,tt.Z)(function*(){const n=yield o.getGoodsList(!1);n.sort((d,C)=>d.id<C.id?-1:d.id===C.id?0:1);const u=n.map(d=>({...d,salesStatus:T[d.salesStatus],paymentYearMonth:d.selectedPaymentYearMonth&&""!==d.selectedPaymentYearMonth?d.selectedPaymentYearMonth:d.estimatedPaymentYearMonth,parentId:void 0}));for(const d of u)if(d.children){for(const C of d.children){const g={...C,salesStatus:T[C.salesStatus],paymentYearMonth:d.paymentYearMonth,parentId:d.id},O=u.findIndex(R=>R.id===d.id);u.splice(O+1,0,g)}delete d.children}return vt.unparse({fields:["id","category","maker","name","priceWithTax","boxPriceWithTax","customPriceWithTax","customQuantity","paymentYearMonth","salesStatus","isChecked","isArchived","parentId"],data:u},{header:!0,delimiter:","})})()}getTotalPriceByGoodsList(o,n=!1){let u=0,l=0;for(const d of o)if(n||!d.isArchived)if(d.children){let C=this.getTotalPriceByGoodsList(d.children,n);u+=C.minPrice,l+=C.maxPrice}else{if(!d.isChecked)continue;void 0!==d.customPriceWithTax?(u+=d.customPriceWithTax*(d.customQuantity??1),l+=d.customPriceWithTax*(d.customQuantity??1)):(u+=d.priceWithTax??0,l+=d.boxPriceWithTax??d.priceWithTax??0)}return{minPrice:u,maxPrice:l}}isItemEndOfSale(o){if(!o.endOfSaleDate&&!o.confirmedEndOfSaleDate)return!1;const n=new Date,u=o.endOfResaleDate?new Date(o.endOfResaleDate):void 0,l=o.confirmedEndOfResaleDate?new Date(o.confirmedEndOfResaleDate):void 0;if(u){if(u<n)return!0;if(n<u)return!1}if(l&&l<n)return!0;const d=o.endOfSaleDate?new Date(o.endOfSaleDate):void 0,C=o.confirmedEndOfSaleDate?new Date(o.confirmedEndOfSaleDate):void 0;return!!(d&&d<n||C&&C<n)}setItemStatus(o,n,u,l,d=1,C){var g=this;return(0,tt.Z)(function*(){if(yield g.init(),!g.storage)throw new Error("Failed to init storage");const O=yield g.storage.get(o.toString()),R=O?O.firstCheckedAt:(new Date).toISOString(),_={note:void 0,isChecked:n,isArchived:u,paymentYearMonth:l,savedAt:(new Date).toISOString(),firstCheckedAt:R,customPriceWithTax:C,customQuantity:d};g.storage.set(o.toString(),_)})()}injectStatuses(o,n){var u=this;return(0,tt.Z)(function*(){let l=[];for(const d of o){if(!d||isNaN(d.id))continue;const C=u.getItemSalesStatus(d);d.salesStatus=C===T.UNKNOWN&&n?n.salesStatus:C;let g=G.C;switch(d.salesType){case"A":g=G.A;break;case"A/B":g=G.A_B;break;case"B":g=G.B;break;case"C":g=G.C}let O=u.getEstimatedPaymentYearMonth(d);d.children&&(d.children=yield u.injectStatuses(d.children,d)),l.push({...d,salesStatus:C,salesType:g,estimatedPaymentYearMonth:O,isChecked:!1,isArchived:!1})}for(const d of l){const C=yield u.storage?.get(d.id.toString());d.customPriceWithTax=C?C.customPriceWithTax:void 0,d.customQuantity=C?C.customQuantity:void 0,d.isChecked=!!C&&C.isChecked,d.isArchived=!!C&&C.isArchived,d.selectedPaymentYearMonth=C?C.paymentYearMonth:""}return l})()}sortItems(o){const n=new Date,u=[],l=[],d=[],C=[],g=[],O=[];o.forEach(_=>{switch(_.salesStatus){case T.BEFORE_RESERVATION:if(_.salesType===G.A)Math.ceil((new Date(_.reservationEndDate).getTime()-n.getTime())/864e5)<0?g.push(_):u.push(_);else if(_.salesType===G.B)Math.ceil((new Date(_.saleDate).getTime()-n.getTime())/864e5)<0?g.push(_):l.push(_);else if(_.salesType===G.A_B){const N=Math.ceil((new Date(_.reservationEndDate).getTime()-n.getTime())/864e5),Tt=Math.ceil((new Date(_.saleDate).getTime()-n.getTime())/864e5);N<0&&Tt<0?g.push(_):d.push(_)}break;case T.RESERVATION:const et=Math.ceil((new Date(_.reservationEndDate).getTime()-n.getTime())/864e5);Math.ceil((new Date(_.saleDate).getTime()-n.getTime())/864e5),_.salesType===G.A||_.salesType===G.A_B?d.push(_):_.salesType===G.B&&(et<0?g.push(_):l.push(_));break;case T.ON_SALE:_.salesType===G.C&&Math.ceil((new Date(_.saleDate).getTime()-n.getTime())/864e5)<0?C.push(_):u.push(_);break;case T.END_OF_SALE:g.push(_);break;case T.END_OF_RESALE:case T.UNKNOWN:O.push(_)}}),u.sort((_,et)=>{const W=Math.ceil((new Date(_.reservationEndDate).getTime()-n.getTime())/864e5),N=Math.ceil((new Date(et.reservationEndDate).getTime()-n.getTime())/864e5),Tt=Math.ceil((new Date(_.endOfSaleDate).getTime()-n.getTime())/864e5),kt=Math.ceil((new Date(et.endOfSaleDate).getTime()-n.getTime())/864e5);return _.salesType===G.A?W<0&&N<0?kt-Tt:W-N:_.salesType===G.A_B?W<0&&N<0?kt-Tt:W>=0&&N>=0?W-N:W<0&&N>=0?1:-1:-1}),l.sort((_,et)=>{const W=Math.ceil((new Date(_.reservationStartDate).getTime()-n.getTime())/864e5),N=Math.ceil((new Date(et.reservationStartDate).getTime()-n.getTime())/864e5),Tt=Math.ceil((new Date(_.saleDate).getTime()-n.getTime())/864e5),kt=Math.ceil((new Date(et.saleDate).getTime()-n.getTime())/864e5);return W>=0&&N>=0?W-N:W<0&&N<0?kt-Tt:W<0&&N>=0?1:-1}),d.sort((_,et)=>{const W=Math.ceil((new Date(_.reservationEndDate).getTime()-n.getTime())/864e5),N=Math.ceil((new Date(et.reservationEndDate).getTime()-n.getTime())/864e5),Tt=Math.ceil((new Date(_.endOfSaleDate).getTime()-n.getTime())/864e5),kt=Math.ceil((new Date(et.endOfSaleDate).getTime()-n.getTime())/864e5);return W>=0&&N>=0?W-N:W<0&&N<0?kt-Tt:W<0&&N>=0?1:-1}),C.sort((_,et)=>{const W=Math.ceil((new Date(_.saleDate).getTime()-n.getTime())/864e5),N=Math.ceil((new Date(et.saleDate).getTime()-n.getTime())/864e5);return W<0&&N<0?N-W:-1});let R=[];return u.forEach(_=>R.push(_)),l.forEach(_=>R.push(_)),d.forEach(_=>R.push(_)),C.forEach(_=>R.push(_)),g.forEach(_=>R.push(_)),O.forEach(_=>R.push(_)),R}getItemSalesStatus(o,n=new Date){let u=this.isItemEndOfSale(o),l=T.UNKNOWN;if(u)l=T.END_OF_SALE;else{const d=o.reservationStartDate;if(d){if(new Date(d)>n)return l=T.BEFORE_RESERVATION,l;l=T.RESERVATION}const C=o.reservationEndDate;if(C){const _=new Date(C);if(l===T.RESERVATION&&_>n)return l;_<n&&(l=T.END_OF_RESERVATION)}const g=o.saleDate;if(g)if(new Date(g)>n){if(l===T.RESERVATION)return l;l=T.BEFORE_SALE}else l=T.ON_SALE;const O=o.endOfSaleDate;O&&new Date(O)<n&&(l=T.END_OF_SALE);const R=o.resaleDate;R&&(l=new Date(R)>n?T.BEFORE_RESALE:T.ON_RESALE)}return l}getEstimatedPaymentYearMonth(o){let n=o.estimatedPaymentYearMonth;return n||(void 0===o.salesStatus&&console.warn("[GoodsListService] getEstimatedPaymentYearMonth - salesStatus is undefined",o),o.salesStatus===T.BEFORE_RESERVATION&&o.reservationEndDate?n=this.dateToYearMonth(o.reservationEndDate):o.salesStatus===T.BEFORE_RESERVATION&&o.saleDate?n=this.dateToYearMonth(o.saleDate):o.salesStatus===T.BEFORE_RESERVATION&&o.reservationStartDate?n=this.dateToYearMonth(o.reservationStartDate):o.salesStatus===T.RESERVATION&&o.reservationEndDate?n=this.dateToYearMonth(o.reservationEndDate):o.salesStatus===T.RESERVATION&&o.saleDate?n=this.dateToYearMonth(o.saleDate):o.salesStatus===T.END_OF_RESERVATION&&o.reservationEndDate?n=this.dateToYearMonth(o.reservationEndDate):o.salesStatus===T.END_OF_RESERVATION&&o.saleDate||o.salesStatus===T.BEFORE_SALE&&o.saleDate?n=this.dateToYearMonth(o.saleDate):o.salesStatus===T.END_OF_SALE&&o.endOfSaleDate?n=this.dateToYearMonth(o.endOfSaleDate):o.salesStatus===T.END_OF_SALE&&o.confirmedEndOfSaleDate&&(n=this.dateToYearMonth(o.confirmedEndOfSaleDate))),n||(n=this.dateToYearMonth(new Date)),n}dateToYearMonth(o){let n;if(o instanceof Date){if(isNaN(o.getTime()))return;n=o}else if(n=new Date(o),isNaN(n.getTime()))return;const u=n.getMonth()+1;return`${n.getFullYear()}/${u.toString().padStart(2,"0")}`}}return(e=r).GOODS_LIST_JSON_CACHE_EXPIRES=18e5,e.\u0275fac=function(o){return new(o||e)(t.LFG(bt.g))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),r})();var yt=b(1175),it=b(5313),Mt=b(2596);function Zt(e,r){1&e&&(t.TgZ(0,"th",12),t._uU(1,"\u5e74\u6708"),t.qZA())}function Lt(e,r){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(i.yearMonth)}}function Bt(e,r){1&e&&(t.TgZ(0,"th",12),t._uU(1,"\u5408\u8a08\u91d1\u984d"),t.qZA())}function gt(e,r){if(1&e&&(t.TgZ(0,"span",15),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw().$implicit;t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,i.maxPrice,"JPY","symbol")," ")}}function M(e,r){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.ALo(2,"currency"),t.YNc(3,gt,3,5,"span",14),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,2,i.minPrice,"JPY","symbol")," "),t.xp6(2),t.Q6J("ngIf",i.maxPrice&&i.maxPrice!=i.minPrice)}}function s(e,r){1&e&&(t.TgZ(0,"th",12),t._uU(1,"\u8cfc\u5165\u6570"),t.qZA())}function a(e,r){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(i.numOfGoods)}}function c(e,r){1&e&&(t.TgZ(0,"th",16),t._uU(1,"\xa0"),t.qZA())}function m(e,r){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"keyboard_arrow_down"),t.qZA())}function h(e,r){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"keyboard_arrow_up"),t.qZA())}function A(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"td",13)(1,"button",17),t.NdJ("click",function(n){const l=t.CHM(i).$implicit,d=t.oxw();return d.expandedElement=d.expandedElement===l?null:l,t.KtG(n.stopPropagation())}),t.YNc(2,m,2,0,"mat-icon",18),t.YNc(3,h,2,0,"mat-icon",18),t.qZA()()}if(2&e){const i=r.$implicit,o=t.oxw();t.xp6(2),t.Q6J("ngIf",o.expandedElement!==i),t.xp6(1),t.Q6J("ngIf",o.expandedElement===i)}}function P(e,r){if(1&e&&(t.TgZ(0,"span",23),t._uU(1),t.qZA()),2&e){const i=t.oxw(3).$implicit;t.xp6(1),t.hij(" x ",i.customQuantity," ")}}function j(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",21),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.YNc(4,P,2,1,"span",22),t.BQk()),2&e){const i=t.oxw(2).$implicit;t.xp6(2),t.hij(" ",t.Dn7(3,2,i.customPriceWithTax,"JPY","symbol")," "),t.xp6(2),t.Q6J("ngIf",i.customQuantity&&1!==i.customQuantity)}}function Z(e,r){if(1&e&&(t.TgZ(0,"span",21),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw(3).$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,1,i.priceWithTax,"JPY","symbol")," ")}}function f(e,r){if(1&e&&(t.TgZ(0,"span",26),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw(3).$implicit;t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,i.boxPriceWithTax,"JPY","symbol")," ")}}function I(e,r){if(1&e&&(t.ynx(0),t.YNc(1,Z,3,5,"span",24),t.YNc(2,f,3,5,"span",25),t.BQk()),2&e){const i=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",i.priceWithTax),t.xp6(1),t.Q6J("ngIf",i.boxPriceWithTax)}}function E(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"li"),t._uU(2),t._uU(3," \xa0\xa0 "),t.YNc(4,j,5,6,"ng-container",18),t.YNc(5,I,3,2,"ng-container",18),t.qZA(),t.BQk()),2&e){const i=t.oxw().$implicit;t.xp6(2),t.hij(" ",i.name," "),t.xp6(2),t.Q6J("ngIf",i.customPriceWithTax),t.xp6(1),t.Q6J("ngIf",!i.customPriceWithTax)}}function ut(e,r){if(1&e&&(t.TgZ(0,"span",23),t._uU(1),t.qZA()),2&e){const i=t.oxw(2).$implicit;t.xp6(1),t.hij(" x ",i.customQuantity," ")}}function K(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",21),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.YNc(4,ut,2,1,"span",22),t.BQk()),2&e){const i=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.Dn7(3,2,i.customPriceWithTax,"JPY","symbol")," "),t.xp6(2),t.Q6J("ngIf",i.customQuantity&&1!==i.customQuantity)}}function p(e,r){if(1&e&&(t.TgZ(0,"span",21),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,1,i.priceWithTax,"JPY","symbol")," ")}}function w(e,r){if(1&e&&(t.TgZ(0,"span",26),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw(2).$implicit;t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,i.boxPriceWithTax,"JPY","symbol")," ")}}function H(e,r){if(1&e&&(t.ynx(0),t.YNc(1,p,3,5,"span",24),t.YNc(2,w,3,5,"span",25),t.BQk()),2&e){const i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",i.priceWithTax),t.xp6(1),t.Q6J("ngIf",i.boxPriceWithTax)}}function L(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"li"),t._uU(2),t._uU(3," \xa0\xa0 "),t.YNc(4,K,5,6,"ng-container",18),t.YNc(5,H,3,2,"ng-container",18),t.qZA(),t.BQk()),2&e){const i=r.$implicit;t.xp6(2),t.hij(" ",i.name," "),t.xp6(2),t.Q6J("ngIf",i.customPriceWithTax),t.xp6(1),t.Q6J("ngIf",!i.customPriceWithTax)}}function $(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"li"),t._uU(2),t.TgZ(3,"ul"),t.YNc(4,L,6,3,"ng-container",20),t.qZA()(),t.BQk()),2&e){const i=t.oxw().$implicit;t.xp6(2),t.hij(" ",i.name," "),t.xp6(2),t.Q6J("ngForOf",i.children)}}function J(e,r){if(1&e&&(t.ynx(0),t.YNc(1,E,6,3,"ng-container",18),t.YNc(2,$,5,2,"ng-container",18),t.BQk()),2&e){const i=r.$implicit;t.xp6(1),t.Q6J("ngIf",!i.children),t.xp6(1),t.Q6J("ngIf",i.children)}}function q(e,r){if(1&e&&(t.TgZ(0,"td",13)(1,"div",19)(2,"ul"),t.YNc(3,J,3,2,"ng-container",20),t.qZA()()()),2&e){const i=r.$implicit,o=t.oxw();t.uIk("colspan",o.displayedColumnsExpand.length),t.xp6(1),t.Q6J("@detailExpand",i==o.expandedElement?"expanded":"collapsed"),t.xp6(2),t.Q6J("ngForOf",i.goods)}}function x(e,r){1&e&&t._UZ(0,"tr",27)}function v(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"tr",28),t.NdJ("click",function(){const u=t.CHM(i).$implicit,l=t.oxw();return t.KtG(l.expandedElement=l.expandedElement===u?null:u)}),t.qZA()}if(2&e){const i=r.$implicit,o=t.oxw();t.ekj("table-expanded-row",o.expandedElement===i)}}function B(e,r){1&e&&t._UZ(0,"tr",29)}const U=function(){return["expandedDetail"]};let F=(()=>{var e;class r{constructor(o){this.goodsListService=o,this.paymentReports=[],this.isIncludeArchiveItems=!1,this.displayedColumns=["yearMonth","price","numOfGoods"],this.displayedColumnsExpand=[...this.displayedColumns,"expand"],this.expandedElement=null}ngOnInit(){var o=this;return(0,tt.Z)(function*(){yield o.load()})()}load(){var o=this;return(0,tt.Z)(function*(){let l=(yield o.goodsListService.getGoodsList()).map(g=>{if(g.isChecked)return g;if(g.children){const O=g.children.filter(R=>R.isChecked);if(O.length>0)return g.children=O,g}}).filter(g=>void 0!==g);o.isIncludeArchiveItems||(l=l.filter(g=>!g.isArchived));const d={};for(const g of l){const O=g.selectedPaymentYearMonth?g.selectedPaymentYearMonth:g.estimatedPaymentYearMonth;d[O]||(d[O]=[]),d[O].push(g)}let C=Object.keys(d).sort().reverse();o.paymentReports=[];for(const g of C){const O=d[g],R=o.goodsListService.getTotalPriceByGoodsList(O,o.isIncludeArchiveItems);let _=0;for(const et of O)_+=et.customQuantity??1;o.paymentReports.push({yearMonth:g,minPrice:R.minPrice,maxPrice:R.maxPrice,goods:O,numOfGoods:_})}})()}ngOnChanges(){this.load()}}return(e=r).\u0275fac=function(o){return new(o||e)(t.Y36(wt))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-goods-payment-report"]],inputs:{isIncludeArchiveItems:"isIncludeArchiveItems"},features:[t.TTD],decls:18,vars:5,consts:[["mat-table","","multiTemplateDataRows","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","yearMonth"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","price"],["matColumnDef","numOfGoods"],["matColumnDef","expand"],["mat-header-cell","","aria-label","row actions",4,"matHeaderCellDef"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","table-element-row",3,"table-expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","table-detail-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["matTooltip","\u3053\u306e\u5e74\u6708\u306f\u30e9\u30f3\u30c0\u30e0\u5546\u54c1\u7b49\u304c\u3042\u308b\u305f\u3081\u3001\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",4,"ngIf"],["matTooltip","\u3053\u306e\u5e74\u6708\u306f\u30e9\u30f3\u30c0\u30e0\u5546\u54c1\u7b49\u304c\u3042\u308b\u305f\u3081\u3001\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059"],["mat-header-cell","","aria-label","row actions"],["mat-icon-button","","aria-label","expand row",3,"click"],[4,"ngIf"],[1,"table-element-detail"],[4,"ngFor","ngForOf"],[1,"price"],["class","quantity",4,"ngIf"],[1,"quantity"],["class","price",4,"ngIf"],["class","price","matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",4,"ngIf"],["matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",1,"price"],["mat-header-row",""],["mat-row","",1,"table-element-row",3,"click"],["mat-row","",1,"table-detail-row"]],template:function(o,n){1&o&&(t.TgZ(0,"table",0),t.ynx(1,1),t.YNc(2,Zt,2,0,"th",2),t.YNc(3,Lt,2,1,"td",3),t.BQk(),t.ynx(4,4),t.YNc(5,Bt,2,0,"th",2),t.YNc(6,M,4,6,"td",3),t.BQk(),t.ynx(7,5),t.YNc(8,s,2,0,"th",2),t.YNc(9,a,2,1,"td",3),t.BQk(),t.ynx(10,6),t.YNc(11,c,2,0,"th",7),t.YNc(12,A,4,2,"td",3),t.BQk(),t.ynx(13,8),t.YNc(14,q,4,3,"td",3),t.BQk(),t.YNc(15,x,1,0,"tr",9),t.YNc(16,v,1,2,"tr",10),t.YNc(17,B,1,0,"tr",11),t.qZA()),2&o&&(t.Q6J("dataSource",n.paymentReports),t.xp6(15),t.Q6J("matHeaderRowDef",n.displayedColumnsExpand),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumnsExpand),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(4,U)))},dependencies:[X.sg,X.O5,dt.RK,yt.Hw,it.BZ,it.fO,it.as,it.w1,it.Dz,it.nj,it.ge,it.ev,it.XQ,it.Gk,Mt.gM,X.H9],styles:["table[_ngcontent-%COMP%]{box-shadow:0 0 5px #0000001a}tr.table-detail-row[_ngcontent-%COMP%]{height:0}tr.table-element-row[_ngcontent-%COMP%]:not(.table-expanded-row):hover{background:whitesmoke}tr.table-element-row[_ngcontent-%COMP%]:not(.table-expanded-row):active{background:#efefef}.table-element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.table-element-detail[_ngcontent-%COMP%]{background-color:#fff;overflow:hidden;display:flex}.table-element-detail[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin-bottom:1rem}.table-element-detail[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin-top:.25rem;margin-bottom:.25rem}.table-element-detail[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%], .table-element-detail[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{font-size:.8rem}"],data:{animation:[(0,y.X$)("detailExpand",[(0,y.SB)("collapsed",(0,y.oB)({height:"0px",minHeight:"0"})),(0,y.SB)("expanded",(0,y.oB)({height:"*"})),(0,y.eR)("expanded <=> collapsed",(0,y.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),r})(),V=(()=>{var e;class r{constructor(o){this.dialogRef=o,this.isIncludeArchiveItems=!1}}return(e=r).\u0275fac=function(o){return new(o||e)(t.Y36(z.so))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-goods-payment-report-dialog"]],decls:8,vars:2,consts:[[3,"isIncludeArchiveItems"],["align","end"],[3,"ngModel","ngModelChange"],[2,"flex","1 1 auto"],["mat-dialog-close","","mat-stroked-button","","color","primary"]],template:function(o,n){1&o&&(t.TgZ(0,"mat-dialog-content"),t._UZ(1,"app-goods-payment-report",0),t.qZA(),t.TgZ(2,"mat-dialog-actions",1)(3,"mat-checkbox",2),t.NdJ("ngModelChange",function(l){return n.isIncludeArchiveItems=l}),t._uU(4,"\u30a2\u30fc\u30ab\u30a4\u30d6\u6e08\u307f\u3092\u542b\u3081\u308b"),t.qZA(),t._UZ(5,"span",3),t.TgZ(6,"button",4),t._uU(7,"OK"),t.qZA()()),2&o&&(t.xp6(1),t.Q6J("isIncludeArchiveItems",n.isIncludeArchiveItems),t.xp6(2),t.Q6J("ngModel",n.isIncludeArchiveItems))},dependencies:[dt.lW,Ot.oG,z.ZT,z.xY,z.H8,ct.JJ,ct.On,F]}),r})();var Y=b(2939),k=b(2032),nt=b(9157);function ot(e,r){if(1&e&&(t.TgZ(0,"span",14),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw();t.xp6(1),t.hij(" \u6a19\u6e96\u4fa1\u683c: ",t.Dn7(2,1,i.data.item.priceWithTax,"JPY","symbol")," ")}}function lt(e,r){if(1&e&&(t.TgZ(0,"span",15),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw();t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,i.data.item.boxPriceWithTax,"JPY","symbol")," ")}}function mt(e,r){if(1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"currency"),t.BQk()),2&e){const i=t.oxw();t.xp6(1),t.hij(" ",t.Dn7(2,1,i.data.item.customQuantity*i.data.item.customPriceWithTax,"JPY","symbol")," ")}}function at(e,r){1&e&&(t.ynx(0),t._uU(1," - "),t.BQk())}let S=(()=>{var e;class r{constructor(o,n){this.dialogRef=o,this.data=n}ngOnInit(){}}return(e=r).\u0275fac=function(o){return new(o||e)(t.Y36(z.so),t.Y36(z.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-goods-list-item-edit-dialog"]],decls:29,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["class","default-price",4,"ngIf"],["class","default-price","matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",4,"ngIf"],["floatLabel","always"],["matInput","","type","number","min","1","step","1","max","1000000",3,"ngModel","ngModelChange"],["matSuffix",""],["matInput","","type","number","min","1","step","1","max","100",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],[2,"font-size","0.8rem","margin-left","1rem"],[4,"ngIf"],[2,"flex","1 1 auto"],["mat-button","","mat-dialog-close",""],["mat-button","","color","primary","mat-dialog-close","OK","cdkFocusInitial",""],[1,"default-price"],["matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",1,"default-price"]],template:function(o,n){1&o&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1)(3,"p"),t.YNc(4,ot,3,5,"span",2),t.YNc(5,lt,3,5,"span",3),t.qZA(),t.TgZ(6,"mat-form-field",4)(7,"mat-label"),t._uU(8,"\u8cfc\u5165\u3057\u305f\u91d1\u984d"),t.qZA(),t.TgZ(9,"input",5),t.NdJ("ngModelChange",function(l){return n.data.item.customPriceWithTax=l}),t.qZA(),t.TgZ(10,"span",6),t._uU(11,"\u5186"),t.qZA()(),t.TgZ(12,"mat-form-field",4)(13,"mat-label"),t._uU(14,"\u8cfc\u5165\u3057\u305f\u500b\u6570"),t.qZA(),t.TgZ(15,"input",7),t.NdJ("ngModelChange",function(l){return n.data.item.customQuantity=l}),t.qZA(),t.TgZ(16,"span",6),t._uU(17,"\u500b"),t.qZA()()(),t.TgZ(18,"div",8)(19,"span",9),t._uU(20," \u5c0f\u8a08: \xa0 "),t.YNc(21,mt,3,5,"ng-container",10),t.YNc(22,at,2,0,"ng-container",10),t._uU(23," \xa0 \xa0 "),t.qZA(),t._UZ(24,"span",11),t.TgZ(25,"button",12),t._uU(26,"\u30ad\u30e3\u30f3\u30bb\u30eb"),t.qZA(),t.TgZ(27,"button",13),t._uU(28," \u4fdd\u5b58 "),t.qZA()()),2&o&&(t.xp6(1),t.Oqu(n.data.item.name),t.xp6(3),t.Q6J("ngIf",n.data.item.priceWithTax),t.xp6(1),t.Q6J("ngIf",n.data.item.boxPriceWithTax),t.xp6(4),t.Q6J("ngModel",n.data.item.customPriceWithTax),t.xp6(6),t.Q6J("ngModel",n.data.item.customQuantity),t.xp6(6),t.Q6J("ngIf",n.data.item.customQuantity&&n.data.item.customPriceWithTax),t.xp6(1),t.Q6J("ngIf",!n.data.item.customQuantity||!n.data.item.customPriceWithTax))},dependencies:[X.O5,dt.lW,z.ZT,z.uh,z.xY,z.H8,k.Nt,nt.KE,nt.hX,nt.R9,Mt.gM,ct.Fj,ct.wV,ct.JJ,ct.qQ,ct.Fd,ct.On,X.H9],styles:["div[mat-dialog-content][_ngcontent-%COMP%]{display:flex;flex-direction:column}.default-price[_ngcontent-%COMP%]{font-size:.9rem}"]}),r})();var Q=b(6973),D=b(5195),ht=b(7988);function pt(e,r){if(1&e&&(t.TgZ(0,"span",19),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,i.item.reservationStartDate,"yyyy/MM/dd")," \u304b\u3089 ")}}function At(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",17),t._uU(2," \u4e88\u7d04\u958b\u59cb\u524d "),t.qZA(),t.YNc(3,pt,3,4,"span",18),t.BQk()),2&e){const i=t.oxw();t.xp6(3),t.Q6J("ngIf",i.item.reservationStartDate)}}function ft(e,r){if(1&e&&(t.TgZ(0,"span",22),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,i.item.reservationEndDate,"yyyy/MM/dd")," \u307e\u3067 ")}}function Ct(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",20),t._uU(2," \u4e88\u7d04\u53d7\u4ed8\u4e2d "),t.qZA(),t.YNc(3,ft,3,4,"span",21),t.BQk()),2&e){const i=t.oxw();t.xp6(3),t.Q6J("ngIf",i.item.reservationEndDate)}}function xt(e,r){1&e&&(t.ynx(0),t.TgZ(1,"span",23),t._uU(2," \u4e88\u7d04\u7d42\u4e86 "),t.qZA(),t.BQk())}function st(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",24),t._uU(2," \u767a\u58f2\u524d "),t.qZA(),t.TgZ(3,"span",25),t._uU(4),t.ALo(5,"date"),t.qZA(),t.BQk()),2&e){const i=t.oxw();t.xp6(4),t.hij(" ",t.xi3(5,1,i.item.saleDate,"yyyy/MM/dd")," \u304b\u3089 ")}}function Ft(e,r){if(1&e&&(t.TgZ(0,"span",28),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,i.item.endOfSaleDate,"yyyy/MM/dd")," \u307e\u3067 ")}}function rt(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",26),t._uU(2," \u8ca9\u58f2\u4e2d "),t.qZA(),t.YNc(3,Ft,3,4,"span",27),t.BQk()),2&e){const i=t.oxw();t.xp6(3),t.Q6J("ngIf",i.item.endOfSaleDate)}}function Nt(e,r){1&e&&(t.ynx(0),t.TgZ(1,"span",29),t._uU(2," \u7d42\u58f2 "),t.qZA(),t.BQk())}function St(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",30),t._uU(2," \u518d\u8ca9\u524d "),t.qZA(),t.TgZ(3,"span",31),t._uU(4),t.ALo(5,"date"),t.qZA(),t.BQk()),2&e){const i=t.oxw();t.xp6(4),t.hij(" ",t.xi3(5,1,i.item.resaleDate,"yyyy/MM/dd")," \u304b\u3089 ")}}function Yt(e,r){if(1&e&&(t.TgZ(0,"span",34),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,i.item.endOfResaleDate,"yyyy/MM/dd")," \u307e\u3067 ")}}function Qt(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",32),t._uU(2," \u518d\u8ca9\u4e2d "),t.qZA(),t.YNc(3,Yt,3,4,"span",33),t.BQk()),2&e){const i=t.oxw();t.xp6(3),t.Q6J("ngIf",i.item.endOfResaleDate)}}function Ut(e,r){1&e&&(t.ynx(0),t.TgZ(1,"span",35),t._uU(2," \u518d\u8ca9\u7d42\u4e86 "),t.qZA(),t.BQk())}function Gt(e,r){1&e&&(t.ynx(0),t.TgZ(1,"span",36),t._uU(2," \u4e0d\u660e "),t.qZA(),t.BQk())}function Jt(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",37),t._uU(2),t.ALo(3,"currency"),t.ALo(4,"currency"),t.qZA(),t.BQk()),2&e){const i=t.oxw();t.xp6(2),t.AsE(" ",t.Dn7(3,2,i.subtotalPrice.min,"JPY","symbol")," \u301c ",t.Dn7(4,6,i.subtotalPrice.max,"JPY","symbol")," ")}}function qt(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",38),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.BQk()),2&e){const i=t.oxw();t.xp6(2),t.hij(" ",t.Dn7(3,1,i.subtotalPrice.min,"JPY","symbol")," ")}}function Wt(e,r){if(1&e&&(t.TgZ(0,"span",45),t._uU(1),t.qZA()),2&e){const i=t.oxw(2).$implicit;t.xp6(1),t.hij(" x ",i.customQuantity," ")}}function jt(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",43),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.YNc(4,Wt,2,1,"span",44),t.BQk()),2&e){const i=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.Dn7(3,2,i.customPriceWithTax,"JPY","symbol")," "),t.xp6(2),t.Q6J("ngIf",i.customQuantity&&1!==i.customQuantity)}}function $t(e,r){if(1&e&&(t.TgZ(0,"span",43),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,1,i.priceWithTax,"JPY","symbol")," ")}}function zt(e,r){if(1&e&&(t.TgZ(0,"span",48),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw(2).$implicit;t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,i.boxPriceWithTax,"JPY","symbol")," ")}}function Kt(e,r){if(1&e&&(t.ynx(0),t.YNc(1,$t,3,5,"span",46),t.YNc(2,zt,3,5,"span",47),t.BQk()),2&e){const i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",i.priceWithTax),t.xp6(1),t.Q6J("ngIf",i.boxPriceWithTax)}}function Ht(e,r){if(1&e){const i=t.EpF();t.ynx(0),t.TgZ(1,"div",39)(2,"mat-checkbox",40),t.NdJ("ngModelChange",function(n){const l=t.CHM(i).$implicit;return t.KtG(l.isChecked=n)})("ngModelChange",function(){t.CHM(i);const n=t.oxw(2);return t.KtG(n.onChange())}),t._uU(3),t.qZA(),t._uU(4," \xa0\xa0 "),t.TgZ(5,"div",41),t.YNc(6,jt,5,6,"ng-container",2),t.YNc(7,Kt,3,2,"ng-container",2),t._uU(8," \xa0 "),t.TgZ(9,"button",42),t.NdJ("click",function(){const u=t.CHM(i).$implicit,l=t.oxw(2);return t.KtG(l.openEditDialog(u,!0))}),t.TgZ(10,"mat-icon"),t._uU(11,"edit"),t.qZA()()()(),t.BQk()}if(2&e){const i=r.$implicit;t.xp6(2),t.Q6J("ngModel",i.isChecked),t.xp6(1),t.hij(" ",i.name," "),t.xp6(3),t.Q6J("ngIf",i.customPriceWithTax),t.xp6(1),t.Q6J("ngIf",!i.customPriceWithTax)}}function Vt(e,r){if(1&e&&(t.ynx(0),t.YNc(1,Ht,12,4,"ng-container",14),t.BQk()),2&e){const i=t.oxw();t.xp6(1),t.Q6J("ngForOf",i.item.children)}}function Xt(e,r){if(1&e&&(t.TgZ(0,"span",45),t._uU(1),t.qZA()),2&e){const i=t.oxw(3);t.xp6(1),t.hij(" x ",i.item.customQuantity," ")}}function te(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",43),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.YNc(4,Xt,2,1,"span",44),t.BQk()),2&e){const i=t.oxw(2);t.xp6(2),t.hij(" ",t.Dn7(3,2,i.item.customPriceWithTax,"JPY","symbol")," "),t.xp6(2),t.Q6J("ngIf",i.item.customQuantity&&1!==i.item.customQuantity)}}function ee(e,r){if(1&e&&(t.TgZ(0,"span",43),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw(3);t.xp6(1),t.hij(" ",t.Dn7(2,1,i.item.priceWithTax,"JPY","symbol")," ")}}function ne(e,r){if(1&e&&(t.TgZ(0,"span",48),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const i=t.oxw(3);t.xp6(1),t.hij(" \u301c ",t.Dn7(2,1,i.item.boxPriceWithTax,"JPY","symbol")," ")}}function ie(e,r){if(1&e&&(t.ynx(0),t.YNc(1,ee,3,5,"span",46),t.YNc(2,ne,3,5,"span",47),t.BQk()),2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",i.item.priceWithTax),t.xp6(1),t.Q6J("ngIf",i.item.boxPriceWithTax)}}function oe(e,r){if(1&e){const i=t.EpF();t.ynx(0),t.TgZ(1,"div",39)(2,"mat-checkbox",40),t.NdJ("ngModelChange",function(n){t.CHM(i);const u=t.oxw();return t.KtG(u.item.isChecked=n)})("ngModelChange",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.onChange())}),t._uU(3),t.qZA(),t._uU(4," \xa0\xa0 "),t.TgZ(5,"div",41),t.YNc(6,te,5,6,"ng-container",2),t.YNc(7,ie,3,2,"ng-container",2),t._uU(8," \xa0 "),t.TgZ(9,"button",42),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.openEditDialog(n.item,!1))}),t.TgZ(10,"mat-icon"),t._uU(11,"edit"),t.qZA()()()(),t.BQk()}if(2&e){const i=t.oxw();t.xp6(2),t.Q6J("ngModel",i.item.isChecked),t.xp6(1),t.hij(" ",i.item.name," "),t.xp6(3),t.Q6J("ngIf",i.item.customPriceWithTax),t.xp6(1),t.Q6J("ngIf",!i.item.customPriceWithTax)}}function ae(e,r){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"check_box"),t.qZA())}function se(e,r){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"check_box_outline_blank"),t.qZA())}function re(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",49),t._uU(2),t.qZA(),t.BQk()),2&e){const i=t.oxw();t.xp6(2),t.hij(" ",i.item.selectedPaymentYearMonth," ")}}function ue(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",50),t._uU(2),t.qZA(),t.BQk()),2&e){const i=t.oxw();t.xp6(2),t.hij(" ",i.item.estimatedPaymentYearMonth," ")}}function ce(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"span",52),t._uU(2),t.qZA(),t.BQk()),2&e){const i=t.oxw().$implicit;t.xp6(2),t.hij(" ",i.subLabel," ")}}function le(e,r){if(1&e){const i=t.EpF();t.ynx(0),t.TgZ(1,"button",51),t.NdJ("click",function(){const u=t.CHM(i).$implicit,l=t.oxw();return l.item.selectedPaymentYearMonth=u.yearMonth,t.KtG(l.onChange())}),t._uU(2),t.YNc(3,ce,3,1,"ng-container",2),t.qZA(),t.BQk()}if(2&e){const i=r.$implicit,o=t.oxw();t.xp6(1),t.Q6J("disabled",o.item.selectedPaymentYearMonth&&o.item.selectedPaymentYearMonth==i.yearMonth||!o.item.selectedPaymentYearMonth&&o.item.estimatedPaymentYearMonth==i.yearMonth),t.xp6(1),t.hij(" ",i.label," "),t.xp6(1),t.Q6J("ngIf",i.subLabel)}}function de(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return n.item.isArchived=!0,t.KtG(n.onChange())}),t.TgZ(1,"mat-icon"),t._uU(2,"archive"),t.qZA()()}}function _e(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",54),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return n.item.isArchived=!1,t.KtG(n.onChange())}),t.TgZ(1,"mat-icon"),t._uU(2,"unarchive"),t.qZA()()}}const me=function(e,r,i,o,n,u,l,d,C,g){return{"sales-before-reservation":e,"sales-reservation":r,"sales-end-of-reservation":i,"sales-before-sale":o,"sales-on-sale":n,"sales-end-of-sale":u,"sales-before-resale":l,"sales-on-resale":d,"sales-end-of-resale":C,"sales-unknown":g}};let pe=(()=>{var e;class r{constructor(o){this.matDialog=o,this.itemChange=new t.vpe,this.salesStatus=T,this.subtotalPrice={min:0,max:0},this.paymentYearMonths=[]}ngOnInit(){this.init()}onChange(){this.itemChange.emit(this.item),this.updateSubtotalPrice()}toggleAllChecks(){const o=this.isAllChecked();if(this.item.isChecked=!o,this.item.children)for(const n of this.item.children)n.isChecked=!o}isAllChecked(){return this.item.children?this.item.children.every(o=>o.isChecked):this.item.isChecked}isPastDate(o){return new Date(o).getTime()<Date.now()}openEditDialog(o,n=!1){var u=this;return(0,tt.Z)(function*(){const l={...o};void 0===l.customQuantity&&(l.customQuantity=1),void 0===l.customPriceWithTax&&(l.customPriceWithTax=l.priceWithTax);const d=u.matDialog.open(S,{data:{item:l}}),C=yield function Et(e,r){const i="object"==typeof r;return new Promise((o,n)=>{let l,u=!1;e.subscribe({next:d=>{l=d,u=!0},error:n,complete:()=>{u?o(l):i?o(r.defaultValue):n(new Q.K)}})})}(d.afterClosed());C&&"OK"===C&&(n&&u.item.children?(u.item.children=u.item.children.map(g=>g.id===o.id?l:g),u.itemChange.emit(u.item)):(void 0!==l.customQuantity&&(u.item.customQuantity=l.customQuantity),void 0!==l.customPriceWithTax&&(u.item.customPriceWithTax=l.customPriceWithTax),u.itemChange.emit(u.item)))})()}init(){this.paymentYearMonths=[];let o=(new Date).toISOString().slice(0,7);this.item.selectedPaymentYearMonth?o=this.item.selectedPaymentYearMonth:this.item.estimatedPaymentYearMonth&&(o=this.item.estimatedPaymentYearMonth);const n=Number(o.slice(0,4)),u=Number(o.slice(5,7));for(let l=-5;l<=5;l++){const d=n+Math.floor((u+l-1)/12),C=(u+l-1)%12+1;let g;if(this.item.reservationEndDate){const O=new Date(this.item.reservationEndDate),R=O.getFullYear(),_=O.getMonth()+1;d==R&&C==_&&(g=" (\u4e88\u7d04\u7de0\u5207)")}if(this.item.saleDate){const O=new Date(this.item.saleDate),R=O.getFullYear(),_=O.getMonth()+1;d==R&&C==_&&(g=" (\u767a\u58f2)")}this.paymentYearMonths.push({yearMonth:`${d}/${C.toString().padStart(2,"0")}`,label:`${d}/${C.toString().padStart(2,"0")}`,subLabel:g})}this.updateSubtotalPrice()}updateSubtotalPrice(){let o=0,n=0;if(this.item.isChecked&&(this.item.customPriceWithTax&&this.item.customQuantity?(o+=this.item.customPriceWithTax*this.item.customQuantity,n+=this.item.customPriceWithTax*this.item.customQuantity):this.item.priceWithTax&&(this.item.boxPriceWithTax?(o+=this.item.priceWithTax,n+=this.item.boxPriceWithTax):(o+=this.item.priceWithTax,n+=this.item.priceWithTax))),this.item.children)for(const u of this.item.children)u.isChecked&&(u.customPriceWithTax&&u.customQuantity?(o+=u.customPriceWithTax*u.customQuantity,n+=u.customPriceWithTax*u.customQuantity):u.priceWithTax&&(u.boxPriceWithTax?(o+=u.priceWithTax,n+=u.boxPriceWithTax):(o+=u.priceWithTax,n+=u.priceWithTax)));this.subtotalPrice.min=o,this.subtotalPrice.max=n}}return(e=r).\u0275fac=function(o){return new(o||e)(t.Y36(z.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-goods-list-card"]],inputs:{item:"item"},outputs:{itemChange:"itemChange"},decls:44,vars:41,consts:[[3,"ngClass"],[1,"item-summary"],[4,"ngIf"],[1,"maker"],[1,"checklist"],[2,"display","flex","justify-content","end","gap","1rem","width","100%","padding-top","0"],["mat-icon-button","","color","primary","matTooltip","\u53c2\u8003\u30da\u30fc\u30b8\u3092\u958b\u304f","target","_blank","rel","noopener",3,"href","disabled"],[2,"margin-bottom","3px"],[2,"flex-grow","1"],["mat-icon-button","",3,"matTooltip","color","click"],["mat-icon-button","","color","primary",1,"payment-timing-button",3,"matMenuTriggerFor","matTooltip"],[1,"main"],[1,"arrow"],["paymentYearMonthMenu","matMenu"],[4,"ngFor","ngForOf"],["mat-icon-button","","color","primary","matTooltip","\u30a2\u30fc\u30ab\u30a4\u30d6\u3059\u308b",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","matTooltip","\u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u89e3\u9664\u3059\u308b",3,"click",4,"ngIf"],[1,"sales-status","before-reservation"],["class","sales-date","matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u4e88\u7d04\u958b\u59cb\u65e5",4,"ngIf"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u4e88\u7d04\u958b\u59cb\u65e5",1,"sales-date"],[1,"sales-status","reservation"],["class","sales-date","matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u4e88\u7d04\u7de0\u5207\u65e5",4,"ngIf"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u4e88\u7d04\u7de0\u5207\u65e5",1,"sales-date"],[1,"sales-status","end-of-reservation"],[1,"sales-status","before-sale"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u767a\u58f2\u65e5",1,"sales-date"],[1,"sales-status","on-sale"],["class","sales-date","matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u7d42\u58f2\u65e5",4,"ngIf"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u7d42\u58f2\u65e5",1,"sales-date"],[1,"sales-status","end-of-sale"],[1,"sales-status","before-resale"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u518d\u8ca9\u65e5",1,"sales-date"],[1,"sales-status","on-resale"],["class","sales-date","matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u518d\u8ca9\u7d42\u4e86\u65e5",4,"ngIf"],["matTooltip","\u3053\u306e\u30b0\u30c3\u30ba\u306e\u518d\u8ca9\u7d42\u4e86\u65e5",1,"sales-date"],[1,"sales-status","end-of-resale"],[1,"sales-status","unknown"],["matTooltip","\u30e9\u30f3\u30c0\u30e0\u5546\u54c1\u7b49\u304c\u542b\u307e\u308c\u308b\u305f\u3081\u3001\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",1,"subtotal"],[1,"subtotal"],[1,"checklist-item"],[3,"ngModel","ngModelChange"],[1,"price-container"],["mat-icon-button","","matTooltip","\u8cfc\u5165\u4fa1\u683c\u30fb\u500b\u6570\u3092\u5909\u66f4",1,"price-edit-button",3,"click"],[1,"price"],["class","quantity",4,"ngIf"],[1,"quantity"],["class","price",4,"ngIf"],["class","price","matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",4,"ngIf"],["matTooltip","\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059",1,"price"],[1,"payment-year-month","selected"],[1,"payment-year-month","estimated"],["mat-menu-item","",3,"disabled","click"],[2,"font-size","0.8rem"],["mat-icon-button","","color","primary","matTooltip","\u30a2\u30fc\u30ab\u30a4\u30d6\u3059\u308b",3,"click"],["mat-icon-button","","color","primary","matTooltip","\u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u89e3\u9664\u3059\u308b",3,"click"]],template:function(o,n){if(1&o&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-subtitle",1),t.YNc(5,At,4,1,"ng-container",2),t.YNc(6,Ct,4,1,"ng-container",2),t.YNc(7,xt,3,0,"ng-container",2),t.YNc(8,st,6,4,"ng-container",2),t.YNc(9,rt,4,1,"ng-container",2),t.YNc(10,Nt,3,0,"ng-container",2),t.YNc(11,St,6,4,"ng-container",2),t.YNc(12,Qt,4,1,"ng-container",2),t.YNc(13,Ut,3,0,"ng-container",2),t.YNc(14,Gt,3,0,"ng-container",2),t.TgZ(15,"span",3),t._uU(16),t.qZA(),t._uU(17," \xa0\xa0\xa0 "),t.YNc(18,Jt,5,10,"ng-container",2),t.YNc(19,qt,4,5,"ng-container",2),t.qZA()(),t.TgZ(20,"mat-card-content")(21,"div",4),t.YNc(22,Vt,2,1,"ng-container",2),t.YNc(23,oe,12,4,"ng-container",2),t.qZA()(),t.TgZ(24,"mat-card-actions",5)(25,"a",6)(26,"mat-icon",7),t._uU(27,"link"),t.qZA()(),t._UZ(28,"div",8),t.TgZ(29,"button",9),t.NdJ("click",function(){return n.toggleAllChecks(),n.onChange()}),t.YNc(30,ae,2,0,"mat-icon",2),t.YNc(31,se,2,0,"mat-icon",2),t.qZA(),t.TgZ(32,"button",10)(33,"mat-icon",11),t._uU(34,"currency_yen"),t.qZA(),t.TgZ(35,"mat-icon",12),t._uU(36,"arrow_drop_down"),t.qZA(),t.YNc(37,re,3,1,"ng-container",2),t.YNc(38,ue,3,1,"ng-container",2),t.qZA(),t.TgZ(39,"mat-menu",null,13),t.YNc(41,le,4,3,"ng-container",14),t.qZA(),t.YNc(42,de,3,0,"button",15),t.YNc(43,_e,3,0,"button",16),t.qZA()()),2&o){const u=t.MAs(40);t.Q6J("ngClass",t.rFY(30,me,[n.item.salesStatus===n.salesStatus.BEFORE_RESERVATION,n.item.salesStatus===n.salesStatus.RESERVATION,n.item.salesStatus===n.salesStatus.END_OF_RESERVATION,n.item.salesStatus===n.salesStatus.BEFORE_SALE,n.item.salesStatus===n.salesStatus.ON_SALE,n.item.salesStatus===n.salesStatus.END_OF_SALE,n.item.salesStatus===n.salesStatus.BEFORE_RESALE,n.item.salesStatus===n.salesStatus.ON_RESALE,n.item.salesStatus===n.salesStatus.END_OF_RESALE,n.item.salesStatus===n.salesStatus.UNKNOWN])),t.xp6(3),t.hij(" ",n.item.name,""),t.xp6(2),t.Q6J("ngIf",n.item.salesStatus===n.salesStatus.BEFORE_RESERVATION),t.xp6(1),t.Q6J("ngIf",n.item.salesStatus===n.salesStatus.RESERVATION),t.xp6(1),t.Q6J("ngIf",n.item.salesStatus===n.salesStatus.END_OF_RESERVATION),t.xp6(1),t.Q6J("ngIf",n.item.salesStatus===n.salesStatus.BEFORE_SALE),t.xp6(1),t.Q6J("ngIf",n.item.salesStatus===n.salesStatus.ON_SALE),t.xp6(1),t.Q6J("ngIf",n.item.salesStatus===n.salesStatus.END_OF_SALE),t.xp6(1),t.Q6J("ngIf",n.item.salesStatus===n.salesStatus.BEFORE_RESALE),t.xp6(1),t.Q6J("ngIf",n.item.salesStatus===n.salesStatus.ON_RESALE),t.xp6(1),t.Q6J("ngIf",n.item.salesStatus===n.salesStatus.END_OF_RESALE),t.xp6(1),t.Q6J("ngIf",n.item.salesStatus===n.salesStatus.UNKNOWN),t.xp6(2),t.hij(" ",n.item.maker||"-"," "),t.xp6(2),t.Q6J("ngIf",n.subtotalPrice.min!=n.subtotalPrice.max),t.xp6(1),t.Q6J("ngIf",n.subtotalPrice.min==n.subtotalPrice.max),t.xp6(3),t.Q6J("ngIf",n.item.children&&n.item.children.length>=1),t.xp6(1),t.Q6J("ngIf",!n.item.children||1==n.item.children.length),t.xp6(2),t.Q6J("href",n.item.url,t.LSH)("disabled",!n.item.url),t.xp6(4),t.Q6J("matTooltip",n.isAllChecked()?"\u5168\u3066\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5916\u3059":"\u5168\u3066\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b")("color",n.isAllChecked()?"accent":""),t.xp6(1),t.Q6J("ngIf",n.isAllChecked()),t.xp6(1),t.Q6J("ngIf",!n.isAllChecked()),t.xp6(1),t.Q6J("matMenuTriggerFor",u)("matTooltip",n.item.selectedPaymentYearMonth?"\u6708\u3054\u3068\u306e\u5408\u8a08\u91d1\u984d\u3092\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u30b0\u30c3\u30ba\u306e\u652f\u6255\u3044\u6642\u671f\u306f "+n.item.selectedPaymentYearMonth+" \u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5909\u66f4\u3059\u308b\u5834\u5408\u306f\u3001\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002":"\u6708\u3054\u3068\u306e\u5408\u8a08\u91d1\u984d\u3092\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u30b0\u30c3\u30ba\u306e\u63a8\u6e2c\u3055\u308c\u308b\u652f\u6255\u3044\u6642\u671f\u306f"+n.item.estimatedPaymentYearMonth+"\u3067\u3059\u3002\u3000\u3000\u3000\u305f\u3060\u3057\u3001\u4fdd\u8a3c\u3059\u308b\u3082\u306e\u3067\u306f\u306a\u304f\u3001\u652f\u6255\u3044\u65b9\u6cd5\u3001\u5e97\u8217\u3001\u8ca9\u58f2\u306e\u7a2e\u985e\u306b\u3088\u3063\u3066\u3082\u7570\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u5834\u5408\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3001\u5e74\u6708\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044\u3002"),t.xp6(5),t.Q6J("ngIf",n.item.selectedPaymentYearMonth),t.xp6(1),t.Q6J("ngIf",!n.item.selectedPaymentYearMonth&&n.item.estimatedPaymentYearMonth),t.xp6(3),t.Q6J("ngForOf",n.paymentYearMonths),t.xp6(1),t.Q6J("ngIf",!n.item.isArchived),t.xp6(1),t.Q6J("ngIf",n.item.isArchived)}},dependencies:[X.mk,X.sg,X.O5,dt.o6,dt.RK,D.a8,D.hq,D.dn,D.dk,D.$j,D.n5,Ot.oG,yt.Hw,ht.VK,ht.OP,ht.p6,Mt.gM,ct.JJ,ct.On,X.H9,X.uU],styles:["mat-card[_ngcontent-%COMP%]{padding-left:.5rem}mat-card.sales-before-reservation[_ngcontent-%COMP%]{border-left:.5rem solid #1abc9c}mat-card.sales-reservation[_ngcontent-%COMP%]{border-left:.5rem solid #27ae60}mat-card.sales-end-of-reservation[_ngcontent-%COMP%]{border-left:.5rem solid #7f8c8d}mat-card.sales-before-sale[_ngcontent-%COMP%]{border-left:.5rem solid #1abc9c}mat-card.sales-on-sale[_ngcontent-%COMP%]{border-left:.5rem solid #27ae60}mat-card.sales-end-of-sale[_ngcontent-%COMP%]{border-left:.5rem solid #7f8c8d}mat-card.sales-before-resale[_ngcontent-%COMP%]{border-left:.5rem solid #1abc9c}mat-card.sales-on-resale[_ngcontent-%COMP%]{border-left:.5rem solid #27ae60}mat-card.sales-end-of-resale[_ngcontent-%COMP%]{border-left:.5rem solid #7f8c8d}mat-card.sales-unknown[_ngcontent-%COMP%]{border-left:.5rem solid #aaaaaa}.item-summary[_ngcontent-%COMP%]   .sales-status.before-reservation[_ngcontent-%COMP%]{color:#1abc9c}.item-summary[_ngcontent-%COMP%]   .sales-status.reservation[_ngcontent-%COMP%]{color:#27ae60}.item-summary[_ngcontent-%COMP%]   .sales-status.end-of-reservation[_ngcontent-%COMP%]{color:#7f8c8d}.item-summary[_ngcontent-%COMP%]   .sales-status.before-sale[_ngcontent-%COMP%]{color:#1abc9c}.item-summary[_ngcontent-%COMP%]   .sales-status.on-sale[_ngcontent-%COMP%]{color:#27ae60}.item-summary[_ngcontent-%COMP%]   .sales-status.end-of-sale[_ngcontent-%COMP%]{color:#7f8c8d}.item-summary[_ngcontent-%COMP%]   .sales-status.before-resale[_ngcontent-%COMP%]{color:#1abc9c}.item-summary[_ngcontent-%COMP%]   .sales-status.on-resale[_ngcontent-%COMP%]{color:#27ae60}.item-summary[_ngcontent-%COMP%]   .sales-status.end-of-resale[_ngcontent-%COMP%]{color:#7f8c8d}.item-summary[_ngcontent-%COMP%]   .sales-status.unknown[_ngcontent-%COMP%]{color:#aaa}.item-summary[_ngcontent-%COMP%]   .sales-date[_ngcontent-%COMP%]{margin-left:1rem;font-weight:bolder}.item-summary[_ngcontent-%COMP%]   .maker[_ngcontent-%COMP%]{margin-left:2rem}.item-summary[_ngcontent-%COMP%]   .subtotal[_ngcontent-%COMP%]{color:#333;white-space:nowrap}.checklist[_ngcontent-%COMP%]{display:flex;flex-direction:column}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]:hover{background:#f8f8f8}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]{white-space:nowrap}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%], .checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{font-size:.8rem}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .price-edit-button[_ngcontent-%COMP%]{color:#555;height:1.5rem;width:1.5rem;line-height:1.5rem;padding:0;vertical-align:middle}.checklist[_ngcontent-%COMP%]   .checklist-item[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .price-edit-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;height:1rem;width:1rem;line-height:1rem;vertical-align:middle}.payment-timing-button[_ngcontent-%COMP%]{position:relative}.payment-timing-button[_ngcontent-%COMP%]   mat-icon.main[_ngcontent-%COMP%]{position:relative;line-height:1rem}.payment-timing-button[_ngcontent-%COMP%]   mat-icon.arrow[_ngcontent-%COMP%]{position:absolute;top:.7rem;right:-.4rem;line-height:1.2rem;opacity:.8}.payment-timing-button[_ngcontent-%COMP%]   .payment-year-month[_ngcontent-%COMP%]{position:absolute;font-size:.8rem;bottom:.2rem;left:0;right:0;text-align:center}@media screen and (max-width: 768px){.maker[_ngcontent-%COMP%]{display:none}mat-card-content[_ngcontent-%COMP%]{padding-top:.25rem;padding-left:0}}"]}),r})();function ge(e,r){1&e&&(t.TgZ(0,"div",9)(1,"p"),t._uU(2,"\u8aad\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059...\u3057\u3070\u3089\u304f\u304a\u5f85\u3061\u304f\u3060\u3055\u3044..."),t.qZA()())}function he(e,r){if(1&e){const i=t.EpF();t.ynx(0),t.TgZ(1,"button",17),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(2);return t.KtG(n.isShowingTotalPrice=!0)}),t.TgZ(2,"mat-icon"),t._uU(3,"currency_yen"),t.qZA()(),t.BQk()}}function fe(e,r){if(1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"currency"),t.ALo(3,"currency"),t.BQk()),2&e){const i=t.oxw(4);t.xp6(1),t.AsE(" ",t.Dn7(2,2,i.totalPrice.minPrice,"JPY","symbol")," \u301c ",t.Dn7(3,6,i.totalPrice.maxPrice,"JPY","symbol")," ")}}function Ce(e,r){if(1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"currency"),t.BQk()),2&e){const i=t.oxw(4);t.xp6(1),t.hij(" ",t.Dn7(2,1,i.totalPrice.minPrice,"JPY","symbol")," ")}}function xe(e,r){if(1&e&&(t.TgZ(0,"span",19),t.YNc(1,fe,4,10,"ng-container",2),t.YNc(2,Ce,3,5,"ng-container",2),t.qZA()),2&e){const i=t.oxw(3);t.Q6J("matTooltip",(i.isShowingArchivedItems?"\u30a2\u30fc\u30ab\u30a4\u30d6\u3055\u308c\u305f\u30b0\u30c3\u30ba\u3082\u542b\u3081\u3001\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5546\u54c1\u306e\u5408\u8a08\u984d\u3067\u3059\u3002":"\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5546\u54c1\u306e\u5408\u8a08\u984d\u3067\u3059\u3002")+(i.totalPrice.minPrice!==i.totalPrice.maxPrice?"\u30e9\u30f3\u30c0\u30e0\u5546\u54c1\u304c\u3042\u308b\u305f\u3081\u3001\u5358\u4f53\u8cfc\u5165\u6642\u3068BOX\u8cfc\u5165\u6642\u76f8\u5f53\u306e\u4fa1\u683c\u5dee\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059":"")),t.xp6(1),t.Q6J("ngIf",i.totalPrice.minPrice!==i.totalPrice.maxPrice),t.xp6(1),t.Q6J("ngIf",i.totalPrice.minPrice===i.totalPrice.maxPrice)}}function ye(e,r){if(1&e&&(t.ynx(0),t.YNc(1,xe,3,3,"span",18),t.BQk()),2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",i.isShowingTotalPrice)}}function Ee(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"app-goods-list-card",21),t.NdJ("itemChange",function(){t.CHM(i);const n=t.oxw().$implicit,u=t.oxw(2);return t.KtG(u.onItemStatusChange(n))}),t.qZA()}if(2&e){const i=t.oxw().$implicit;t.Q6J("item",i)}}function Ae(e,r){if(1&e&&(t.ynx(0),t.YNc(1,Ee,1,1,"app-goods-list-card",20),t.BQk()),2&e){const i=r.$implicit;t.xp6(1),t.Q6J("ngIf",!1===i.isArchived)}}function Te(e,r){1&e&&t._UZ(0,"div",22)}function Pe(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",23),t._uU(2,"expand_less"),t.qZA(),t._uU(3),t.BQk()),2&e){const i=t.oxw(2);t.xp6(3),t.hij(" \u30a2\u30fc\u30ab\u30a4\u30d6\u3057\u305f\u30b0\u30c3\u30ba\u3092\u975e\u8868\u793a (",i.numOfArchivedItems,"\u4ef6)\xa0 ")}}function Oe(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",23),t._uU(2,"expand_more"),t.qZA(),t._uU(3),t.BQk()),2&e){const i=t.oxw(2);t.xp6(3),t.hij(" \u30a2\u30fc\u30ab\u30a4\u30d6\u3057\u305f\u30b0\u30c3\u30ba\u3092\u8868\u793a (",i.numOfArchivedItems,"\u4ef6)\xa0 ")}}function De(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"app-goods-list-card",21),t.NdJ("itemChange",function(){t.CHM(i);const n=t.oxw().$implicit,u=t.oxw(3);return t.KtG(u.onItemStatusChange(n))}),t.qZA()}if(2&e){const i=t.oxw().$implicit;t.Q6J("item",i)}}function ve(e,r){if(1&e&&(t.ynx(0),t.YNc(1,De,1,1,"app-goods-list-card",20),t.BQk()),2&e){const i=r.$implicit;t.xp6(1),t.Q6J("ngIf",!0===i.isArchived)}}function be(e,r){if(1&e&&(t.ynx(0),t.TgZ(1,"div",24),t.YNc(2,ve,2,1,"ng-container",14),t.qZA(),t.BQk()),2&e){const i=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",i.items)}}function Me(e,r){if(1&e){const i=t.EpF();t.ynx(0),t.TgZ(1,"div",10),t.YNc(2,he,4,0,"ng-container",2),t.YNc(3,ye,2,1,"ng-container",2),t.qZA(),t.TgZ(4,"div",11)(5,"button",12),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.openPaymentReportDialog())}),t.TgZ(6,"mat-icon"),t._uU(7,"receipt_long"),t.qZA()()(),t.TgZ(8,"div",13),t.YNc(9,Ae,2,1,"ng-container",14),t.qZA(),t.YNc(10,Te,1,0,"div",15),t.TgZ(11,"button",16),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.toggleShowingArchive())}),t.YNc(12,Pe,4,1,"ng-container",2),t.YNc(13,Oe,4,1,"ng-container",2),t.qZA(),t.YNc(14,be,3,1,"ng-container",2),t.BQk()}if(2&e){const i=t.oxw();t.xp6(2),t.Q6J("ngIf",!i.isShowingTotalPrice),t.xp6(1),t.Q6J("ngIf",i.isShowingTotalPrice),t.xp6(6),t.Q6J("ngForOf",i.items),t.xp6(1),t.Q6J("ngIf",i.isShowingArchivedItems),t.xp6(1),t.Q6J("matTooltip",i.isShowingArchivedItems?"\u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u975e\u8868\u793a":"\u30a2\u30fc\u30ab\u30a4\u30d6\u3092\u8868\u793a")("disabled",0===i.numOfArchivedItems),t.xp6(1),t.Q6J("ngIf",i.isShowingArchivedItems),t.xp6(1),t.Q6J("ngIf",!i.isShowingArchivedItems),t.xp6(1),t.Q6J("ngIf",i.isShowingArchivedItems)}}const Fe=[{path:"",component:(()=>{var e;class r{constructor(o,n,u){this.goodsListService=o,this.snackBar=n,this.matDialog=u,this.numOfArchivedItems=0,this.isShowingTotalPrice=!1,this.totalPrice={minPrice:0,maxPrice:0},this.isShowingArchivedItems=!1}ngOnInit(){var o=this;return(0,tt.Z)(function*(){o.load()})()}load(){var o=this;return(0,tt.Z)(function*(){try{o.items=yield o.goodsListService.getGoodsList(),o.calculateStatuses(o.items)}catch(n){o.snackBar.open(`\u30a8\u30e9\u30fc: ${n.message}`,"OK")}})()}onItemStatusChange(o){var n=this;return(0,tt.Z)(function*(){let u=o.selectedPaymentYearMonth&&""!=o.selectedPaymentYearMonth?o.selectedPaymentYearMonth:o.estimatedPaymentYearMonth;if(console.log(o.customQuantity,o.customPriceWithTax),yield n.goodsListService.setItemStatus(o.id,o.isChecked,o.isArchived,u,o.customQuantity,o.customPriceWithTax),o.children)for(const l of o.children)yield n.goodsListService.setItemStatus(l.id,l.isChecked,o.isArchived,u,l.customQuantity,l.customPriceWithTax);n.snackBar.open("\u5909\u66f4\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f",void 0,{duration:1e3}),n.calculateStatuses()})()}calculateStatuses(o){var n=this;return(0,tt.Z)(function*(){o||(o=yield n.goodsListService.getGoodsList()),n.totalPrice=n.goodsListService.getTotalPriceByGoodsList(o,n.isShowingArchivedItems),n.numOfArchivedItems=o.filter(u=>u.isArchived).length})()}toggleShowingArchive(){var o=this;return(0,tt.Z)(function*(){o.isShowingArchivedItems=!o.isShowingArchivedItems,o.totalPrice=o.goodsListService.getTotalPriceByGoodsList(yield o.goodsListService.getGoodsList(),o.isShowingArchivedItems)})()}openPaymentReportDialog(){this.matDialog.open(V,{maxWidth:"96vw"})}exportAsCsv(){var o=this;return(0,tt.Z)(function*(){const n=yield o.goodsListService.getGoodsListAsCsv(),u=new Date,d=`goods-list-${[u.getFullYear(),(u.getMonth()+1).toString().padStart(2,"0"),u.getDate().toString().padStart(2,"0"),"-",u.getHours().toString().padStart(2,"0"),u.getMinutes().toString().padStart(2,"0"),u.getSeconds().toString().padStart(2,"0")].join("")}.csv`,C=new Blob([n],{type:"text/csv"}),g=window.URL.createObjectURL(C),O=document.createElement("a");O.href=g,O.download=d,O.click(),window.URL.revokeObjectURL(g),o.snackBar.open("\u4e3b\u306a\u60c5\u5831\u3092CSV\u3068\u3057\u3066\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3057\u307e\u3057\u305f",void 0,{duration:2e3})})()}}return(e=r).\u0275fac=function(o){return new(o||e)(t.Y36(wt),t.Y36(Y.ux),t.Y36(z.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-goods-list-page"]],decls:42,vars:2,consts:[[1,"app-page-summary"],["class","app-card bordered",4,"ngIf"],[4,"ngIf"],[1,"app-card","bordered",2,"margin-top","1rem"],["href","https://twitter.com/arisu_newsfeed","target","_blank","rel","noopener"],["routerLink","/arisu-calendar"],["href","javascript:void(0)","matTooltip","CSV\u3068\u3057\u3066\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3092\u5b9f\u884c",3,"click"],[1,"app-bottom-navigation"],["routerLink","/"],[1,"app-card","bordered"],[1,"goods-total-summary"],[1,"goods-payment-report"],["mat-icon-button","","matTooltip","\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u9805\u76ee\u306b\u3064\u3044\u3066\u3001\u5e74\u6708\u3054\u3068\u306e\u652f\u6255\u3044\u984d\u3092\u8868\u793a",3,"click"],[1,"goods-cards"],[4,"ngFor","ngForOf"],["class","divider",4,"ngIf"],["mat-stroked-button","","color","primary",2,"margin","2rem 0 1rem 0",3,"matTooltip","disabled","click"],["mat-icon-button","","matTooltip","\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u9805\u76ee\u306e\u7dcf\u984d\u3092\u8868\u793a",3,"click"],["class","goods-total-price",3,"matTooltip",4,"ngIf"],[1,"goods-total-price",3,"matTooltip"],["class","goods-card",3,"item","itemChange",4,"ngIf"],[1,"goods-card",3,"item","itemChange"],[1,"divider"],[2,"vertical-align","middle"],[1,"goods-cards","archived-goods-cards"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"\u3042\u308a\u3059\u30b0\u30c3\u30ba\u30ea\u30b9\u30c8 (\u03b1 ver.)"),t.qZA()(),t.YNc(3,ge,3,0,"div",1),t.YNc(4,Me,15,9,"ng-container",2),t.TgZ(5,"div",3)(6,"p")(7,"small"),t._uU(8," \u203b \u901f\u5831\u6027\u30fb\u6b63\u78ba\u6027\u30fb\u7db2\u7f85\u6027\u306a\u3069\u306f\u4fdd\u8a3c\u3067\u304d\u307e\u305b\u3093\u3002"),t._UZ(9,"br"),t._uU(10," \u307e\u305f\u3001\u4e88\u544a\u306a\u304f\u3001\u66f4\u65b0\u3092\u4f11\u6b62\u30fb\u7d42\u4e86\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u81ea\u5df1\u8cac\u4efb\u3067\u3054\u5229\u7528\u4e0b\u3055\u3044\u3002"),t._UZ(11,"br")(12,"br"),t._uU(13," \u203b \u672c\u30ea\u30b9\u30c8\u306f\u3001\u30b0\u30c3\u30ba\u60c5\u5831\u3092\u624b\u52d5\u3067\u6574\u7406\u30fb\u767b\u9332\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u767b\u9332\u307e\u3067\u306b\u6570\u65e5\u8981\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002"),t._UZ(14,"br"),t._uU(15," \u6700\u65b0\u306e\u60c5\u5831\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u306b\u306f\u3001\u4ee3\u308f\u308a\u306b\u3001"),t.TgZ(16,"a",4),t._uU(17,"\u30cb\u30e5\u30fc\u30b9\u30fb\u30bf\u30c1\u30d0\u30ca"),t.qZA(),t._uU(18," \u3084\u3001"),t.TgZ(19,"a",5),t._uU(20,"\u3042\u308a\u3059\u30ab\u30ec\u30f3\u30c0\u30fc"),t.qZA(),t._uU(21," \u3092\u3054\u6d3b\u7528\u304f\u3060\u3055\u3044\u3002"),t._UZ(22,"br")(23,"br"),t._uU(24," \u203b \u672c\u30ea\u30b9\u30c8\u306f\u3001 "),t.TgZ(25,"a",6),t.NdJ("click",function(){return n.exportAsCsv()}),t._uU(26," CSV\u3068\u3057\u3066\u30a8\u30af\u30b9\u30dd\u30fc\u30c8"),t.qZA(),t._uU(27," \u3059\u308b\u3053\u3068\u3067\u3001Excel \u306a\u3069\u3067\u306e\u96c6\u8a08\u306b\u3082\u304a\u4f7f\u3044\u3044\u305f\u3060\u3051\u307e\u3059\u3002"),t._UZ(28,"br")(29,"br"),t._uU(30," \u203b \u5909\u66f4\u3057\u305f\u5185\u5bb9\u306f\u3001\u7aef\u672b\u5185\u306e\u307f\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002"),t._UZ(31,"br"),t._uU(32,"\u30d6\u30e9\u30a6\u30b6\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u6d88\u53bb\u306a\u3069\u3067\u6d88\u3048\u308b\u3053\u3068\u3082\u3042\u308b\u70ba\u3001\u304a\u307e\u3051\u7a0b\u5ea6\u306b\u3054\u6d3b\u7528\u304f\u3060\u3055\u3044\u3002"),t._UZ(33,"br"),t._uU(34," \u306a\u304a\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u6a5f\u80fd\u306f\u3001\u73fe\u5728\u691c\u8a0e\u4e2d\u3067\u3059\u3002"),t._UZ(35,"br")(36,"br"),t.qZA()()(),t.TgZ(37,"div",7)(38,"a",8)(39,"mat-icon"),t._uU(40,"navigate_before"),t.qZA(),t._uU(41," \xa0 \u30db\u30fc\u30e0\u3078"),t.qZA()()),2&o&&(t.xp6(3),t.Q6J("ngIf",void 0===n.items),t.xp6(1),t.Q6J("ngIf",void 0!==n.items))},dependencies:[X.sg,X.O5,Pt.rH,dt.lW,dt.RK,yt.Hw,Mt.gM,pe,X.H9],styles:[".wbr[_ngcontent-%COMP%]{word-break:keep-all;overflow-wrap:anywhere}h3[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:.75rem}h4[_ngcontent-%COMP%]{font-size:.9rem;margin:0}a[_ngcontent-%COMP%]:not([mat-stroked-button], [mat-raised-button])[_ngcontent-%COMP%]{word-wrap:break-word;color:#4d75c2;transition:all .2s ease-in-out}a[_ngcontent-%COMP%]:not([mat-stroked-button], [mat-raised-button])[_ngcontent-%COMP%]:hover{opacity:.7}a[_ngcontent-%COMP%]:not([mat-stroked-button], [mat-raised-button])[_ngcontent-%COMP%]   .app-card[_ngcontent-%COMP%]{color:#333}.app-card[_ngcontent-%COMP%]{box-sizing:border-box;width:90vw;max-width:800px;padding:1.2rem 0;position:relative;background-color:#fff;border-radius:10px}.app-card.bordered[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;box-shadow:0 2px 4px #0003}.app-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{font-size:.85rem;padding-left:2rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin:.5rem 0 .8rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:inline-block;margin-top:.2rem}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:square}.app-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:.25rem 0 .5rem}.app-page-summary[_ngcontent-%COMP%]{width:80vw;text-align:center}.app-page-summary[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#555;font-size:1.5rem;font-weight:lighter;margin:0}.app-bottom-navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#666;font-size:.8rem;text-decoration:none;margin-left:-1.5rem}.app-bottom-navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#bddbfd;margin-bottom:0;vertical-align:middle}","[_nghost-%COMP%]{padding:1.5rem 1rem 3rem;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1.5rem}.app-card[_ngcontent-%COMP%]{padding:1rem 1rem .75rem}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:80vw;max-width:800px}.goods-total-summary[_ngcontent-%COMP%]{background-color:#fffd;border-radius:3rem;box-shadow:inset 0 0 0 1px #0000001a;padding:1rem 1.5rem 1rem 3rem;position:fixed;left:-2rem;bottom:1rem;z-index:10}.goods-total-summary[_ngcontent-%COMP%]   .goods-total-price[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#555;vertical-align:middle;margin-left:.25rem}.goods-payment-report[_ngcontent-%COMP%]{background-color:#fffd;border-radius:3rem;box-shadow:inset 0 0 0 1px #0000001a;padding:1rem 3rem 1rem 1.5rem;position:fixed;right:-2rem;bottom:1rem;z-index:10}.goods-cards[_ngcontent-%COMP%]{box-sizing:border-box;display:flex;flex-direction:column;align-items:center;gap:2rem;width:80vw}.goods-cards[_ngcontent-%COMP%]   .goods-card[_ngcontent-%COMP%]{width:90vw;max-width:800px}small[_ngcontent-%COMP%]{font-size:.8rem}.divider[_ngcontent-%COMP%]{width:100%;height:1px;background-color:#0002;margin:2rem 0}@media screen and (max-width: 768px){[_nghost-%COMP%]{padding-left:0;padding-right:0}.goods-cards[_ngcontent-%COMP%]{padding-left:0;padding-right:0;width:100vw}.goods-cards[_ngcontent-%COMP%]   .goods-card[_ngcontent-%COMP%]{width:95vw}.goods-total-summary[_ngcontent-%COMP%]{padding-left:2.25rem;padding-right:.75rem;bottom:2.5rem}.goods-payment-report[_ngcontent-%COMP%]{padding-left:.75rem;padding-right:2.25rem;bottom:2.5rem}}"]}),r})(),title:"\u3042\u308a\u3059\u30b0\u30c3\u30ba\u30ea\u30b9\u30c8"}];let ke=(()=>{var e;class r{}return(e=r).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[Pt.Bz.forChild(Fe),Pt.Bz]}),r})();var we=b(7904);let Be=(()=>{var e;class r{}return(e=r).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[X.ez,ke,we.m]}),r})()},4316:function(It,Rt){var b,Pt;b=function tt(){"use strict";var t=typeof self<"u"?self:typeof window<"u"?window:void 0!==t?t:{},z=!t.document&&!!t.postMessage,dt=t.IS_PAPA_WORKER||!1,Ot={},ct=0,y={parse:function(s,a){var c=(a=a||{}).dynamicTyping||!1;if(M(c)&&(a.dynamicTypingFunction=c,c={}),a.dynamicTyping=c,a.transform=!!M(a.transform)&&a.transform,a.worker&&y.WORKERS_SUPPORTED){var m=function(){if(!y.WORKERS_SUPPORTED)return!1;var j,Z,A=(j=t.URL||t.webkitURL||null,Z=tt.toString(),y.BLOB_URL||(y.BLOB_URL=j.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Z,")();"],{type:"text/javascript"})))),P=new t.Worker(A);return P.onmessage=Mt,P.id=ct++,Ot[P.id]=P}();return m.userStep=a.step,m.userChunk=a.chunk,m.userComplete=a.complete,m.userError=a.error,a.step=M(a.step),a.chunk=M(a.chunk),a.complete=M(a.complete),a.error=M(a.error),delete a.worker,void m.postMessage({input:s,config:a,workerId:m.id})}var A,h=null;return"string"==typeof s?(s=65279===(A=s).charCodeAt(0)?A.slice(1):A,h=a.download?new T(a):new vt(a)):!0===s.readable&&M(s.read)&&M(s.on)?h=new bt(a):(t.File&&s instanceof File||s instanceof Object)&&(h=new G(a)),h.stream(s)},unparse:function(s,a){var c=!1,m=!0,h=",",A="\r\n",P='"',j=P+P,Z=!1,f=null,I=!1;!function(){if("object"==typeof a){if("string"!=typeof a.delimiter||y.BAD_DELIMITERS.filter(function(p){return-1!==a.delimiter.indexOf(p)}).length||(h=a.delimiter),("boolean"==typeof a.quotes||"function"==typeof a.quotes||Array.isArray(a.quotes))&&(c=a.quotes),"boolean"!=typeof a.skipEmptyLines&&"string"!=typeof a.skipEmptyLines||(Z=a.skipEmptyLines),"string"==typeof a.newline&&(A=a.newline),"string"==typeof a.quoteChar&&(P=a.quoteChar),"boolean"==typeof a.header&&(m=a.header),Array.isArray(a.columns)){if(0===a.columns.length)throw new Error("Option columns is empty");f=a.columns}void 0!==a.escapeChar&&(j=a.escapeChar+P),("boolean"==typeof a.escapeFormulae||a.escapeFormulae instanceof RegExp)&&(I=a.escapeFormulae instanceof RegExp?a.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var E=new RegExp(yt(P),"g");if("string"==typeof s&&(s=JSON.parse(s)),Array.isArray(s)){if(!s.length||Array.isArray(s[0]))return ut(null,s,Z);if("object"==typeof s[0])return ut(f||Object.keys(s[0]),s,Z)}else if("object"==typeof s)return"string"==typeof s.data&&(s.data=JSON.parse(s.data)),Array.isArray(s.data)&&(s.fields||(s.fields=s.meta&&s.meta.fields||f),s.fields||(s.fields=Array.isArray(s.data[0])?s.fields:"object"==typeof s.data[0]?Object.keys(s.data[0]):[]),Array.isArray(s.data[0])||"object"==typeof s.data[0]||(s.data=[s.data])),ut(s.fields||[],s.data||[],Z);throw new Error("Unable to serialize unrecognized input");function ut(p,w,H){var L="";"string"==typeof p&&(p=JSON.parse(p)),"string"==typeof w&&(w=JSON.parse(w));var $=Array.isArray(p)&&0<p.length,J=!Array.isArray(w[0]);if($&&m){for(var q=0;q<p.length;q++)0<q&&(L+=h),L+=K(p[q],q);0<w.length&&(L+=A)}for(var x=0;x<w.length;x++){var v=$?p.length:w[x].length,B=!1,U=$?0===Object.keys(w[x]).length:0===w[x].length;if(H&&!$&&(B="greedy"===H?""===w[x].join("").trim():1===w[x].length&&0===w[x][0].length),"greedy"===H&&$){for(var F=[],V=0;V<v;V++)F.push(w[x][J?p[V]:V]);B=""===F.join("").trim()}if(!B){for(var k=0;k<v;k++)0<k&&!U&&(L+=h),L+=K(w[x][$&&J?p[k]:k],k);x<w.length-1&&(!H||0<v&&!U)&&(L+=A)}}return L}function K(p,w){if(null==p)return"";if(p.constructor===Date)return JSON.stringify(p).slice(1,25);var H=!1;I&&"string"==typeof p&&I.test(p)&&(p="'"+p,H=!0);var L=p.toString().replace(E,j);return(H=H||!0===c||"function"==typeof c&&c(p,w)||Array.isArray(c)&&c[w]||function($,J){for(var q=0;q<J.length;q++)if(-1<$.indexOf(J[q]))return!0;return!1}(L,y.BAD_DELIMITERS)||-1<L.indexOf(h)||" "===L.charAt(0)||" "===L.charAt(L.length-1))?P+L+P:L}}};if(y.RECORD_SEP=String.fromCharCode(30),y.UNIT_SEP=String.fromCharCode(31),y.BYTE_ORDER_MARK="\ufeff",y.BAD_DELIMITERS=["\r","\n",'"',y.BYTE_ORDER_MARK],y.WORKERS_SUPPORTED=!z&&!!t.Worker,y.NODE_STREAM_INPUT=1,y.LocalChunkSize=10485760,y.RemoteChunkSize=5242880,y.DefaultDelimiter=",",y.Parser=it,y.ParserHandle=wt,y.NetworkStreamer=T,y.FileStreamer=G,y.StringStreamer=vt,y.ReadableStreamStreamer=bt,t.jQuery){var Dt=t.jQuery;Dt.fn.parse=function(s){var a=s.config||{},c=[];return this.each(function(A){if("INPUT"!==Dt(this).prop("tagName").toUpperCase()||"file"!==Dt(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var P=0;P<this.files.length;P++)c.push({file:this.files[P],inputElem:this,instanceConfig:Dt.extend({},a)})}),m(),this;function m(){if(0!==c.length){var P,j,Z,f=c[0];if(M(s.before)){var I=s.before(f.file,f.inputElem);if("object"==typeof I){if("abort"===I.action)return"AbortError",P=f.file,j=f.inputElem,Z=I.reason,void(M(s.error)&&s.error({name:"AbortError"},P,j,Z));if("skip"===I.action)return void h();"object"==typeof I.config&&(f.instanceConfig=Dt.extend(f.instanceConfig,I.config))}else if("skip"===I)return void h()}var E=f.instanceConfig.complete;f.instanceConfig.complete=function(ut){M(E)&&E(ut,f.file,f.inputElem),h()},y.parse(f.file,f.instanceConfig)}else M(s.complete)&&s.complete()}function h(){c.splice(0,1),m()}}}function _t(s){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(a){var c=Bt(a);c.chunkSize=parseInt(c.chunkSize),a.step||a.chunk||(c.chunkSize=null),this._handle=new wt(c),(this._handle.streamer=this)._config=c}.call(this,s),this.parseChunk=function(a,c){if(this.isFirstChunk&&M(this._config.beforeFirstChunk)){var m=this._config.beforeFirstChunk(a);void 0!==m&&(a=m)}this.isFirstChunk=!1,this._halted=!1;var h=this._partialLine+a;this._partialLine="";var A=this._handle.parse(h,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var P=A.meta.cursor;this._finished||(this._partialLine=h.substring(P-this._baseIndex),this._baseIndex=P),A&&A.data&&(this._rowCount+=A.data.length);var j=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(dt)t.postMessage({results:A,workerId:y.WORKER_ID,finished:j});else if(M(this._config.chunk)&&!c){if(this._config.chunk(A,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);A=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(A.data),this._completeResults.errors=this._completeResults.errors.concat(A.errors),this._completeResults.meta=A.meta),this._completed||!j||!M(this._config.complete)||A&&A.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),j||A&&A.meta.paused||this._nextChunk(),A}this._halted=!0},this._sendError=function(a){M(this._config.error)?this._config.error(a):dt&&this._config.error&&t.postMessage({workerId:y.WORKER_ID,error:a,finished:!1})}}function T(s){var a;(s=s||{}).chunkSize||(s.chunkSize=y.RemoteChunkSize),_t.call(this,s),this._nextChunk=z?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(c){this._input=c,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(a=new XMLHttpRequest,this._config.withCredentials&&(a.withCredentials=this._config.withCredentials),z||(a.onload=gt(this._chunkLoaded,this),a.onerror=gt(this._chunkError,this)),a.open(this._config.downloadRequestBody?"POST":"GET",this._input,!z),this._config.downloadRequestHeaders){var c=this._config.downloadRequestHeaders;for(var m in c)a.setRequestHeader(m,c[m])}this._config.chunkSize&&a.setRequestHeader("Range","bytes="+this._start+"-"+(this._start+this._config.chunkSize-1));try{a.send(this._config.downloadRequestBody)}catch(A){this._chunkError(A.message)}z&&0===a.status&&this._chunkError()}},this._chunkLoaded=function(){var m;4===a.readyState&&(a.status<200||400<=a.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:a.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null===(m=a.getResponseHeader("Content-Range"))?-1:parseInt(m.substring(m.lastIndexOf("/")+1))),this.parseChunk(a.responseText)))},this._chunkError=function(c){this._sendError(new Error(a.statusText||c))}}function G(s){var a,c;(s=s||{}).chunkSize||(s.chunkSize=y.LocalChunkSize),_t.call(this,s);var m=typeof FileReader<"u";this.stream=function(h){this._input=h,c=h.slice||h.webkitSlice||h.mozSlice,m?((a=new FileReader).onload=gt(this._chunkLoaded,this),a.onerror=gt(this._chunkError,this)):a=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var h=this._input;if(this._config.chunkSize){var A=Math.min(this._start+this._config.chunkSize,this._input.size);h=c.call(h,this._start,A)}var P=a.readAsText(h,this._config.encoding);m||this._chunkLoaded({target:{result:P}})},this._chunkLoaded=function(h){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(h.target.result)},this._chunkError=function(){this._sendError(a.error)}}function vt(s){var a;_t.call(this,s=s||{}),this.stream=function(c){return a=c,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var c,m=this._config.chunkSize;return m?(c=a.substring(0,m),a=a.substring(m)):(c=a,a=""),this._finished=!a,this.parseChunk(c)}}}function bt(s){_t.call(this,s=s||{});var a=[],c=!0,m=!1;this.pause=function(){_t.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){_t.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(h){this._input=h,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){m&&1===a.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),a.length?this.parseChunk(a.shift()):c=!0},this._streamData=gt(function(h){try{a.push("string"==typeof h?h:h.toString(this._config.encoding)),c&&(c=!1,this._checkIsFinished(),this.parseChunk(a.shift()))}catch(A){this._streamError(A)}},this),this._streamError=gt(function(h){this._streamCleanUp(),this._sendError(h)},this),this._streamEnd=gt(function(){this._streamCleanUp(),m=!0,this._streamData("")},this),this._streamCleanUp=gt(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function wt(s){var a,c,m,h=Math.pow(2,53),A=-h,P=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,j=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Z=this,f=0,I=0,E=!1,ut=!1,K=[],p={data:[],errors:[],meta:{}};if(M(s.step)){var w=s.step;s.step=function(x){if(p=x,$())L();else{if(L(),0===p.data.length)return;f+=x.data.length,s.preview&&f>s.preview?c.abort():(p.data=p.data[0],w(p,Z))}}}function H(x){return"greedy"===s.skipEmptyLines?""===x.join("").trim():1===x.length&&0===x[0].length}function L(){return p&&m&&(q("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+y.DefaultDelimiter+"'"),m=!1),s.skipEmptyLines&&(p.data=p.data.filter(function(x){return!H(x)})),$()&&function(){if(p)if(Array.isArray(p.data[0])){for(var v=0;$()&&v<p.data.length;v++)p.data[v].forEach(x);p.data.splice(0,1)}else p.data.forEach(x);function x(B,U){M(s.transformHeader)&&(B=s.transformHeader(B,U)),K.push(B)}}(),function(){if(!p||!s.header&&!s.dynamicTyping&&!s.transform)return p;function x(B,U){var F,V=s.header?{}:[];for(F=0;F<B.length;F++){var Y=F,k=B[F];s.header&&(Y=F>=K.length?"__parsed_extra":K[F]),s.transform&&(k=s.transform(k,Y)),k=J(Y,k),"__parsed_extra"===Y?(V[Y]=V[Y]||[],V[Y].push(k)):V[Y]=k}return s.header&&(F>K.length?q("FieldMismatch","TooManyFields","Too many fields: expected "+K.length+" fields but parsed "+F,I+U):F<K.length&&q("FieldMismatch","TooFewFields","Too few fields: expected "+K.length+" fields but parsed "+F,I+U)),V}var v=1;return!p.data.length||Array.isArray(p.data[0])?(p.data=p.data.map(x),v=p.data.length):p.data=x(p.data,0),s.header&&p.meta&&(p.meta.fields=K),I+=v,p}()}function $(){return s.header&&0===K.length}function J(x,v){return B=x,s.dynamicTypingFunction&&void 0===s.dynamicTyping[B]&&(s.dynamicTyping[B]=s.dynamicTypingFunction(B)),!0===(s.dynamicTyping[B]||s.dynamicTyping)?"true"===v||"TRUE"===v||"false"!==v&&"FALSE"!==v&&(function(U){if(P.test(U)){var F=parseFloat(U);if(A<F&&F<h)return!0}return!1}(v)?parseFloat(v):j.test(v)?new Date(v):""===v?null:v):v;var B}function q(x,v,B,U){var F={type:x,code:v,message:B};void 0!==U&&(F.row=U),p.errors.push(F)}this.parse=function(x,v,B){if(s.newline||(s.newline=function(Y,k){Y=Y.substring(0,1048576);var nt=new RegExp(yt(k)+"([^]*?)"+yt(k),"gm"),ot=(Y=Y.replace(nt,"")).split("\r"),lt=Y.split("\n");if(1===ot.length||1<lt.length&&lt[0].length<ot[0].length)return"\n";for(var at=0,S=0;S<ot.length;S++)"\n"===ot[S][0]&&at++;return at>=ot.length/2?"\r\n":"\r"}(x,s.quoteChar||'"')),m=!1,s.delimiter)M(s.delimiter)&&(s.delimiter=s.delimiter(x),p.meta.delimiter=s.delimiter);else{var F=function(Y,k,nt,ot,lt){var mt,at,S,Q;lt=lt||[",","\t","|",";",y.RECORD_SEP,y.UNIT_SEP];for(var Et=0;Et<lt.length;Et++){var D=lt[Et],ht=0,pt=0,At=0;S=void 0;for(var ft=new it({comments:ot,delimiter:D,newline:k,preview:10}).parse(Y),Ct=0;Ct<ft.data.length;Ct++)if(nt&&H(ft.data[Ct]))At++;else{var xt=ft.data[Ct].length;pt+=xt,void 0!==S?0<xt&&(ht+=Math.abs(xt-S),S=xt):S=xt}0<ft.data.length&&(pt/=ft.data.length-At),(void 0===at||ht<=at)&&(void 0===Q||Q<pt)&&1.99<pt&&(at=ht,mt=D,Q=pt)}return{successful:!!(s.delimiter=mt),bestDelimiter:mt}}(x,s.newline,s.skipEmptyLines,s.comments,s.delimitersToGuess);F.successful?s.delimiter=F.bestDelimiter:(m=!0,s.delimiter=y.DefaultDelimiter),p.meta.delimiter=s.delimiter}var V=Bt(s);return s.preview&&s.header&&V.preview++,a=x,c=new it(V),p=c.parse(a,v,B),L(),E?{meta:{paused:!0}}:p||{meta:{paused:!1}}},this.paused=function(){return E},this.pause=function(){E=!0,c.abort(),a=M(s.chunk)?"":a.substring(c.getCharIndex())},this.resume=function(){Z.streamer._halted?(E=!1,Z.streamer.parseChunk(a,!0)):setTimeout(Z.resume,3)},this.aborted=function(){return ut},this.abort=function(){ut=!0,c.abort(),p.meta.aborted=!0,M(s.complete)&&s.complete(p),a=""}}function yt(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function it(s){var a,c=(s=s||{}).delimiter,m=s.newline,h=s.comments,A=s.step,P=s.preview,j=s.fastMode,Z=a=null==s.quoteChar?'"':s.quoteChar;if(void 0!==s.escapeChar&&(Z=s.escapeChar),("string"!=typeof c||-1<y.BAD_DELIMITERS.indexOf(c))&&(c=","),h===c)throw new Error("Comment character same as delimiter");!0===h?h="#":("string"!=typeof h||-1<y.BAD_DELIMITERS.indexOf(h))&&(h=!1),"\n"!==m&&"\r"!==m&&"\r\n"!==m&&(m="\n");var f=0,I=!1;this.parse=function(E,ut,K){if("string"!=typeof E)throw new Error("Input must be a string");var p=E.length,w=c.length,H=m.length,L=h.length,$=M(A),J=[],q=[],x=[],v=f=0;if(!E)return st();if(s.header&&!ut){var B=E.split(m)[0].split(c),U=[],F={},V=!1;for(var Y in B){var k=B[Y];M(s.transformHeader)&&(k=s.transformHeader(k,Y));var nt=k,ot=F[k]||0;for(0<ot&&(V=!0,nt=k+"_"+ot),F[k]=ot+1;U.includes(nt);)nt=nt+"_"+ot;U.push(nt)}if(V){var lt=E.split(m);lt[0]=U.join(c),E=lt.join(m)}}if(j||!1!==j&&-1===E.indexOf(a)){for(var mt=E.split(m),at=0;at<mt.length;at++){if(f+=(x=mt[at]).length,at!==mt.length-1)f+=m.length;else if(K)return st();if(!h||x.substring(0,L)!==h){if($){if(J=[],At(x.split(c)),Ft(),I)return st()}else At(x.split(c));if(P&&P<=at)return J=J.slice(0,P),st(!0)}}return st()}for(var S=E.indexOf(c,f),Q=E.indexOf(m,f),Et=new RegExp(yt(Z)+yt(a),"g"),D=E.indexOf(a,f);;)if(E[f]!==a)if(h&&0===x.length&&E.substring(f,f+L)===h){if(-1===Q)return st();Q=E.indexOf(m,f=Q+H),S=E.indexOf(c,f)}else if(-1!==S&&(S<Q||-1===Q))x.push(E.substring(f,S)),S=E.indexOf(c,f=S+w);else{if(-1===Q)break;if(x.push(E.substring(f,Q)),xt(Q+H),$&&(Ft(),I))return st();if(P&&J.length>=P)return st(!0)}else for(D=f,f++;;){if(-1===(D=E.indexOf(a,D+1)))return K||q.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:J.length,index:f}),Ct();if(D===p-1)return Ct(E.substring(f,D).replace(Et,a));if(a!==Z||E[D+1]!==Z){if(a===Z||0===D||E[D-1]!==Z){-1!==S&&S<D+1&&(S=E.indexOf(c,D+1)),-1!==Q&&Q<D+1&&(Q=E.indexOf(m,D+1));var ht=ft(-1===Q?S:Math.min(S,Q));if(E.substr(D+1+ht,w)===c){x.push(E.substring(f,D).replace(Et,a)),E[f=D+1+ht+w]!==a&&(D=E.indexOf(a,f)),S=E.indexOf(c,f),Q=E.indexOf(m,f);break}var pt=ft(Q);if(E.substring(D+1+pt,D+1+pt+H)===m){if(x.push(E.substring(f,D).replace(Et,a)),xt(D+1+pt+H),S=E.indexOf(c,f),D=E.indexOf(a,f),$&&(Ft(),I))return st();if(P&&J.length>=P)return st(!0);break}q.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:J.length,index:f}),D++}}else D++}return Ct();function At(rt){J.push(rt),v=f}function ft(rt){var Nt=0;if(-1!==rt){var St=E.substring(D+1,rt);St&&""===St.trim()&&(Nt=St.length)}return Nt}function Ct(rt){return K||(void 0===rt&&(rt=E.substring(f)),x.push(rt),f=p,At(x),$&&Ft()),st()}function xt(rt){f=rt,At(x),x=[],Q=E.indexOf(m,f)}function st(rt){return{data:J,errors:q,meta:{delimiter:c,linebreak:m,aborted:I,truncated:!!rt,cursor:v+(ut||0)}}}function Ft(){A(st()),J=[],q=[]}},this.abort=function(){I=!0},this.getCharIndex=function(){return f}}function Mt(s){var a=s.data,c=Ot[a.workerId],m=!1;if(a.error)c.userError(a.error,a.file);else if(a.results&&a.results.data){var h={abort:function(){m=!0,Zt(a.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Lt,resume:Lt};if(M(c.userStep)){for(var A=0;A<a.results.data.length&&(c.userStep({data:a.results.data[A],errors:a.results.errors,meta:a.results.meta},h),!m);A++);delete a.results}else M(c.userChunk)&&(c.userChunk(a.results,h,a.file),delete a.results)}a.finished&&!m&&Zt(a.workerId,a.results)}function Zt(s,a){var c=Ot[s];M(c.userComplete)&&c.userComplete(a),c.terminate(),delete Ot[s]}function Lt(){throw new Error("Not implemented.")}function Bt(s){if("object"!=typeof s||null===s)return s;var a=Array.isArray(s)?[]:{};for(var c in s)a[c]=Bt(s[c]);return a}function gt(s,a){return function(){s.apply(a,arguments)}}function M(s){return"function"==typeof s}return dt&&(t.onmessage=function(s){var a=s.data;if(void 0===y.WORKER_ID&&a&&(y.WORKER_ID=a.workerId),"string"==typeof a.input)t.postMessage({workerId:y.WORKER_ID,results:y.parse(a.input,a.config),finished:!0});else if(t.File&&a.input instanceof File||a.input instanceof Object){var c=y.parse(a.input,a.config);c&&t.postMessage({workerId:y.WORKER_ID,results:c,finished:!0})}}),(T.prototype=Object.create(_t.prototype)).constructor=T,(G.prototype=Object.create(_t.prototype)).constructor=G,(vt.prototype=Object.create(vt.prototype)).constructor=vt,(bt.prototype=Object.create(_t.prototype)).constructor=bt,y},void 0!==(Pt=b.apply(Rt,[]))&&(It.exports=Pt)}}]);